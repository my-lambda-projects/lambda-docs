<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Intended as a home for Lambda School curriculum.">
  <meta name="author" content="">
  <meta name="generator" content="Jekyll v3.8.0">
  <title>Express Middleware · Lambda School</title>

  <link rel='stylesheet' integrity crossorigin='anonymous'
    href='https://d33wubrfki0l68.cloudfront.net/css/0f99ed215b3d52fa1bee44dc614ea3fa1d1bebc0/dist/css/bootstrap.min.css' />

  <link href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" rel="stylesheet">
  <link rel='stylesheet'
    href='https://d33wubrfki0l68.cloudfront.net/css/1bf8317b3d6d0c9d813c92505f052bf79ffdcdfe/assets/css/docs.min.css' />

  <link rel='stylesheet'
    href='https://d33wubrfki0l68.cloudfront.net/css/f3626ab7ab84821f8b60ea92b4a5c6acf59991af/assets/css/main.css' />

  <script>
    ( function ( i, s, o, g, r, a, m ) {
      i[ 'GoogleAnalyticsObject' ] = r;
      i[ r ] = i[ r ] || function () {
        ( i[ r ].q = i[ r ].q || [] ).push( arguments )
      }, i[ r ].l = 1 * new Date();
      a = s.createElement( o ),
        m = s.getElementsByTagName( o )[ 0 ];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore( a, m )
    } )( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' );
    ga( 'create', 'UA-122016605-1', 'learn.lambdaschool.com' );
    ga( 'send', 'pageview' );
  </script>

  <script>
    ! function () {
      var analytics = window.analytics = window.analytics || [];
      if ( !analytics.initialize )
        if ( analytics.invoked ) window.console && console.error && console.error( "Segment snippet included twice." );
        else {
          analytics.invoked = !0;
          analytics.methods = [ "trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset",
            "group", "track", "ready", "alias", "debug", "page", "once", "off", "on"
          ];
          analytics.factory = function ( t ) {
            return function () {
              var e = Array.prototype.slice.call( arguments );
              e.unshift( t );
              analytics.push( e );
              return analytics
            }
          };
          for ( var t = 0; t < analytics.methods.length; t++ ) {
            var e = analytics.methods[ t ];
            analytics[ e ] = analytics.factory( e )
          }
          analytics.load = function ( t, e ) {
            var n = document.createElement( "script" );
            n.type = "text/javascript";
            n.async = !0;
            n.src = "https://cdn.segment.com/analytics.js/v1/" + t + "/analytics.min.js";
            var a = document.getElementsByTagName( "script" )[ 0 ];
            a.parentNode.insertBefore( n, a );
            analytics._loadOptions = e
          };
          analytics.SNIPPET_VERSION = "4.1.0";
          analytics.load( "BjKorwKrSvMamfNoGkBq9rISk7wF6QQX" );
          analytics.page();
        }
    }();
  </script>

  <link rel="apple-touch-icon" href="/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" href="/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
  <link rel="icon" href="/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
  <link rel="manifest" href="/assets/img/favicons/manifest.json">
  <link rel="mask-icon" href="/assets/img/favicons/safari-pinned-tab.svg" color="#a0001e">
  <link rel="icon" href="/favicon.ico">
  <meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
  <meta name="theme-color" content="#a0001e">
</head>

<body>
  <noscript>Please enable JavaScript to view this page.</noscript>
  <div id="redirect-message" style="display: none;">
    You must be logged in to view this page.
  </div>
  <div id="unauthorized-message" style="display: none;">
    You must be a Lambda School student to view this page.
  </div>
  <div id="content-wrapper">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <div class="mobile-menu">
      <div class="m-drop">
        <div class="mobile-row">
          <div class="header-row" style="padding: 3px 7px">
            <a class="navbar-brand" href="/" aria-label="Lambda School"><svg xmlns="http://www.w3.org/2000/svg"
                width="33" height="35" viewBox="0 0 33 35" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M0 0V16.0609C0 27.7335 9.08929 31.7843 15.7321 34.7513H15.75L16.2857 35C16.4107 34.9289 16.5357 34.8756 16.6786 34.8223C16.75 34.7868 16.8393 34.7513 16.9107 34.7157C23.5714 31.7665 32.6964 27.698 32.6964 16.0609V0H0ZM20.7071 23.4536L20.3571 22.5102L15.6071 10.0736C15.3214 10.802 14.6607 12.5609 13.9464 14.4442L11.2143 21.7817C11.0893 22.1371 11.1607 22.3147 11.25 22.4391C11.4464 22.6701 11.8768 22.6701 12.5554 22.6701H12.6786L12.6768 23.4518H7.56964V22.6701H7.9625C8.65893 22.6701 9.23036 22.368 9.65893 21.5152L10.1768 20.3426L14.9089 8.29696L14.0696 6.07614H18.4804L24.5696 22.0127L25.125 23.4536H20.7071Z"
                  fill="#EC3944" />
              </svg></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mobile-course-menu"
              aria-controls="mobile-course-menu" aria-expanded="false" aria-label="Toggle navigation">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false">
                <title>Menu</title>
                <path stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10"
                  d="M4 7h22M4 15h22M4 23h22"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="nav-row">
          <div class="results-container">
            <ul id="results-container" class="dropdown list-group"></ul>
          </div>
          <div id="mobile-course-menu" class="collapse nav-row">
            <div class="docs-mobile-sidebar" id="bd-docs-nav-mobile">
              <nav class="bd-links">
                <div class="bd-toc-item">
                  <h4 class="bd-toc-link">Web API: Node</h4>
                </div>

                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web4node/sprint/reckzQd7ZgiFY5ok5">
                    1.&nbsp;&nbsp;Build a Web API
                  </a>
                  <ul class="nav bd-sidenav">

                    <li>
                      <a href="/web4node/module/recZiPP8Oyg1WlHxT/">
                        Introduction to Node.js and Express
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/recBjiSulq0PYLCIj/">
                        Server-Side Routing with Express
                      </a>
                    </li>
                    <li class="active bd-sidenav-active">
                      <a href="/web4node/module/recCJjYFEz0i5O5p5/">
                        Express Middleware
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/recs9QOkOAtZhsjc4/">
                        Web Deployment and Best Practices
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web4node/sprint/receFLR7MpwQXesIN">
                    2.&nbsp;&nbsp;Adding Data Persistence
                  </a>
                  <ul class="nav bd-sidenav">

                    <li>
                      <a href="/web4node/module/recFG7SqlSCAB8iU7/">
                        Introduction to Relational Databases
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/recIbfNn9xRhLTOv4/">
                        Database Schema Design
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/recw2ezN22yjehidj/">
                        Multi-Table Queries
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/rec5J23yAIdjmFbgP/">
                        Data Modeling
                      </a>
                    </li>

                  </ul>
                </div>
                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web4node/sprint/recGqGeZ7n75vZivn">
                    3.&nbsp;&nbsp;Authentication and Testing
                  </a>
                  <ul class="nav bd-sidenav">

                    <li>
                      <a href="/web4node/module/recQD9lnhqWEFh6g4/">
                        Introduction to Authentication
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/reciCHdNjavSKaaLt/">
                        Using JSON Web Tokens (JWT)
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/recd26oZ3GBNHh3Na/">
                        WEB Unit Testing
                      </a>
                    </li>
                    <li>
                      <a href="/web4node/module/reciXdxRA8zXJXDID/">
                        Testing the Back End
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web4node/sprint/recWkcWui91eG1s8q">
                    4.&nbsp;&nbsp;WEB Unit 4 Node Build
                  </a>
                  <ul class="nav bd-sidenav">

                  </ul>
                </div>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="main-container">
      <div class="sidebar-container bd-sidebar">
        <div class="docs-sidebar">
          <a class="navbar-brand" href="/" aria-label="Lambda School"><svg width="135" height="35" viewBox="0 0 756 197"
              fill="#ec3944">
              <g>
                <path
                  d="M292.9,126.6h-6.7c-9,0-12.6-1.9-12.6-9.5V48.5c0-7.7,1.6-8.6,11.4-9.7v-4.5h-41.3v4.5 c9.8,1.1,11.4,1.9,11.4,9.7v69.3c0,7.7-1.6,8.6-11.4,9.7v4.5h73.7l4.9-29.4h-4.4C308.5,119.6,303.9,126.6,292.9,126.6z">
                </path>
                <path
                  d="M385.5,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1l0.1-0.1l0,0V132h26v-4.4C387.7,127.1,385.5,126.2,385.5,121.1z M368,117.8 c-4.4,3.3-7.6,5.3-12,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4V117.8L368,117.8z">
                </path>
                <path
                  d="M514.4,121V79.5c0-14.8-6-22.4-18.7-22.4c-11.5,0-19.4,6.6-25.5,13.9c-1.8-9.6-7.7-13.9-17.8-13.9 c-11.4,0-18.7,6.2-24.8,13.6V57h-2.3l-23.8,7.4v2.4l8.6,5v49.4c0,5-2.1,6.1-8.9,6.4v4.4h35.1v-4.4c-6.7-0.3-8.7-1.3-8.7-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7v40.8c0,5-1.9,6.1-8.7,6.4v4.4l34.8,0v-4.4c-6.7-0.3-8.6-1.3-8.6-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7l-0.1,40.5c0,5-1.8,6.4-8.6,6.7l0,4.4h35.1v-4.4 C516.7,127.4,514.4,126.1,514.4,121z">
                </path>
                <path
                  d="M573.2,57.3c-11,0-18.5,5.7-23.4,12.8V22.9h-2.7l-23.4,6.8v2.5l8.6,4.5V132h2.9l8-3.5c5.8,3.3,12.3,5,20.2,5 c20.8,0,37.4-15.8,37.4-42.6C600.9,69.9,590.4,57.3,573.2,57.3z M563.4,128.7c-5.4,0-10.3-2.4-13.7-7.9V73.6 c3.4-3.4,8.5-5.7,13.5-5.7c13.9,0,20,12.8,20,29.5C583.3,114.7,575.8,128.5,563.4,128.7z">
                </path>
                <path
                  d="M677,121.2V22.8h-2.6L651,29.6V32l8.6,4.5v25.7c-3.4-3.2-8.8-5.1-15.5-5.1c-19.9,0-35.2,15.3-35.2,41.3 c0,20.7,11.2,34.6,28.1,34.6c9.8,0,17-5.3,22.6-13.1v0.9V132h26.3l0-4.4C679.1,127.3,677,126.3,677,121.2z M659.6,117.1 L659.6,117.1c-3.4,3.4-8,5.1-13.2,5.1c-13.2,0-20.4-12.8-20.4-29.8c0-17.8,7.3-29.2,19.5-29.2c8.7,0,14.1,6.9,14.1,18.3 L659.6,117.1z">
                </path>
                <path
                  d="M747.1,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1v-0.1h0.1l0,11.1l26,0.1v-4.5C749.3,127.1,747.1,126.2,747.1,121.1z M729.6,117.8c-4.4,3.3-7.6,5.3-12.1,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4L729.6,117.8L729.6,117.8z">
                </path>
              </g>
              <path
                d="M0,0v90.4c0,65.7,50.9,88.5,88.1,105.2h0.1l3,1.4c0.7-0.4,1.4-0.7,2.2-1c0.4-0.2,0.9-0.4,1.3-0.6 c37.3-16.6,88.4-39.5,88.4-105V0H0z M116,132l-2-5.3l-26.6-70c-1.6,4.1-5.3,14-9.3,24.6l-15.3,41.3c-0.7,2-0.3,3,0.2,3.7 c1.1,1.3,3.5,1.3,7.3,1.3H71l0,4.4H42.4l0-4.4h2.2c3.9,0,7.1-1.7,9.5-6.5l2.9-6.6l26.5-67.8l-4.7-12.5h24.7l34.1,89.7l3.1,8.1H116z">
              </path>
            </svg></a>
          <ul id="results-container" class="dropdown list-group"></ul>
          <nav class="bd-links collapse" id="bd-docs-nav">
            <div class="bd-toc-item">
              <h4 class="bd-toc-link">Web API: Node</h4>
            </div>

            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web4node/sprint/reckzQd7ZgiFY5ok5">
                1.&nbsp;&nbsp;Build a Web API
              </a>
              <ul class="nav bd-sidenav">

                <li>
                  <a href="/web4node/module/recZiPP8Oyg1WlHxT/">
                    Introduction to Node.js and Express
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/recBjiSulq0PYLCIj/">
                    Server-Side Routing with Express
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a href="/web4node/module/recCJjYFEz0i5O5p5/">
                    Express Middleware
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/recs9QOkOAtZhsjc4/">
                    Web Deployment and Best Practices
                  </a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web4node/sprint/receFLR7MpwQXesIN">
                2.&nbsp;&nbsp;Adding Data Persistence
              </a>
              <ul class="nav bd-sidenav">

                <li>
                  <a href="/web4node/module/recFG7SqlSCAB8iU7/">
                    Introduction to Relational Databases
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/recIbfNn9xRhLTOv4/">
                    Database Schema Design
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/recw2ezN22yjehidj/">
                    Multi-Table Queries
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/rec5J23yAIdjmFbgP/">
                    Data Modeling
                  </a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web4node/sprint/recGqGeZ7n75vZivn">
                3.&nbsp;&nbsp;Authentication and Testing
              </a>
              <ul class="nav bd-sidenav">

                <li>
                  <a href="/web4node/module/recQD9lnhqWEFh6g4/">
                    Introduction to Authentication
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/reciCHdNjavSKaaLt/">
                    Using JSON Web Tokens (JWT)
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/recd26oZ3GBNHh3Na/">
                    WEB Unit Testing
                  </a>
                </li>
                <li>
                  <a href="/web4node/module/reciXdxRA8zXJXDID/">
                    Testing the Back End
                  </a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web4node/sprint/recWkcWui91eG1s8q">
                4.&nbsp;&nbsp;WEB Unit 4 Node Build
              </a>
              <ul class="nav bd-sidenav">

              </ul>
            </div>
          </nav>
        </div>
      </div>
      <main class="content-container flex-wrapper" role="main">
        <div class="sticky-nav">
          <div class="sprint-nav">
            <ul class="section-nav">
              <li class="toc-entry toc-h2"><a href="#prepare">Prepare</a></li>
              <li class="toc-entry toc-h2"><a href="#learn">Learn</a></li>
              <li class="toc-entry toc-h2"><a href="#guided-project">Guided Project</a></li>
              <li class="toc-entry toc-h2"><a href="#project">Project</a></li>
              <li class="toc-entry toc-h2"><a href="#review">Review</a></li>
            </ul>
          </div>

        </div>
        <div class="wrapper limit-width">
          <div class="flex-wrapper">
            <div class="limit-width">
              <div class="jumbotron">
                <h1 class="bd-title" id="content">Express Middleware</h1>
                <span class="lead">
                  <p class="bd-lead"></p>
                  <p>Express is a minimalist framework. It doesn’t provide everything out of the box, but using
                    middleware we can add extra functionality to our application. Middleware provide a way to extend the
                    features provided by the Express framework.</p>
                  <p>They are implemented as small functions that handle one aspect of our application. Tasks like
                    <strong>authentication</strong> and <strong>logging</strong> are commonly handled by middleware.
                    Another benefit of Middleware is that it provides an easy way to add modularity to our code.</p>
                  <p>On this module we’ll cover:</p>
                  <ul>
                    <li>the what, why and how of Middleware.</li>
                    <li>different types of Express Middleware.</li>
                    <li>how to create Custom Middleware.</li>
                    <li>error handling middleware.</li>
                  </ul>
                </span>
                <strong>At the end of this module, you should be able to:</strong>
                <ul>
                  <li>explain what middleware is and the different types</li>
                  <li>write custom middleware</li>
                  <li>write error handling middleware</li>
                </ul>
              </div>
              <div class="alert alert-warning" role="alert">
                <h4>Pro Tip</h4>
                <p>Treat everyone with as much respect and integrity as you wish to be treated with.</p>
              </div>
              <h2 class="display-4">
                <a id="prepare" class="anchor" href="#prepare" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Prepare</h2>
              <p class="lead">Review each preclass resource before class.</p>
              <div class="preclass">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">
                    <div class="embed-responsive embed-responsive-16by9">
                      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/EE8CId1FK_Q"
                        frameborder="0" allowfullscreen></iframe>
                    </div>
                  </li>
                  <li class="list-group-item">
                    <div class="embed-responsive embed-responsive-16by9">
                      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/7aHJz4SJT4Y"
                        frameborder="0" allowfullscreen></iframe>
                    </div>
                  </li>
                  <li class="list-group-item">
                    <div class="embed-responsive embed-responsive-16by9">
                      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/ItY7Ddzr8jA"
                        frameborder="0" allowfullscreen></iframe>
                    </div>
                  </li>
                  <li class="list-group-item">
                    <a target="_blank" href="https://expressjs.com/en/guide/writing-middleware.html">Middleware
                      explained</a>
                    <p>straight from the Expressjs.com docs</p>
                  </li>
                </ul>
              </div>
              <h2 class="display-4">
                <a id="learn" class="anchor" href="#learn" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Learn</h2>
              <h4 class="mark mb-3 p-2">Learn to explain what middleware is and the different types</h4>
              <p>We can use Express Middleware to add features to Express. It is the biggest part of Express,
                <strong>most of the code we write, including route handlers, is middleware under the hood</strong>.</p>
              <p>We can think of middleware as array of functions that get executed in the order they are introduced
                into the server code.</p>
              <p>Express middleware is compatible with <em>connect middleware</em>. Connect is a web application
                framework for Node.js that only provides the middleware layer.</p>
              <p>Since <code class="highlighter-rouge">Connect</code> has been around for longer, it has a rich
                ecosystem of modules and we can take advantage of that. If you can’t find an Express Middleware package
                with the functionality you want, try searching for a Connect Middleware module instead.</p>
              <h5>Overview</h5>
              <p>There are different types of middleware; for our purposes, we’ll group them into:</p>
              <ul>
                <li>Built-in middleware.</li>
                <li>Third-party middleware.</li>
                <li>Custom middleware.</li>
              </ul>
              <p><strong>Built-in middleware</strong> is included with Express, but not added to the application
                automatically. Like the other types, we need to opt-in to using it in our application.</p>
              <p>We saw an example of built-in middleware when we added support for parsing JSON content out of the
                request body using <code class="highlighter-rouge">server.use(express.json());</code>.</p>
              <p>All types of middleware work in the same way. We tell Express about the middleware we want to <em>turn
                  on</em> for our application by making a call to <code class="highlighter-rouge">.use()</code> on our
                server and passing <code class="highlighter-rouge">.use()</code> the piece of middleware we want to
                apply. This line must come after the server has been created by calling <code
                  class="highlighter-rouge">express()</code>.</p>
              <p><strong>Third-party middleware</strong> are npm modules that we can install and then import into our
                applications using <code class="highlighter-rouge">require()</code>. There are thousands of middleware
                modules we can use, no need to write our own in most cases.</p>
              <p>Some popular middleware modules are:</p>
              <ul>
                <li>
                  <a href="https://www.npmjs.com/package/morgan">morgan</a>.</li>
                <li>
                  <a href="https://www.npmjs.com/package/cors">cors</a>.</li>
                <li>
                  <p><a href="https://www.npmjs.com/package/helmet">helmet</a>.</p>
                </li>
                <li>add morgan to solution, <em>require</em> it <code class="highlighter-rouge">const logger =
                    require('morgan');</code>
                </li>
                <li>add a new <code class="highlighter-rouge">server.use(logger('short))</code> before our other use.
                  Show console.</li>
              </ul>
              <p><strong>Custom middleware</strong> are functions we write to perform certain tasks. We’ll learn more
                about how to write and use them in the next section.</p>
              <h5>Follow Along</h5>
              <p>One thing that is not immediately obvious is that <strong>route handlers are middleware</strong>. Let’s
                see this in action.</p>
              <p>In our current implementation, if a client visits a non-existent endpoint, they will get a default
                message when a resource is not found on the server. In the case of a browser, its <em>Cannot Get
                  /urlWeTriedToAccess</em>. This is a poor user experience. <strong>Please code along</strong> as we
                write a request handler that responds with a custom message for invalid URLs.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="dl">"</span><span class="s2">Ain't nobody got time for that!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">};</span>
</code></pre>
                </div>
              </div>
              <p>This code is not complete yet, but you can see that it is, in fact, a request handler function, we know
                because <em>the homies</em> (req and res) are there.</p>
              <p>Now let’s just <em>use</em> it as if it was middleware:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nx">send</span><span class="p">(</span><span class="dl">"</span><span class="s2">Ain't nobody got time for that!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>Almost there, the last step is adding this status <strong>after each route handler</strong>, so that if
                the preceding middleware or route handlers (which happen to be middleware also) do not respond to the
                request, then this will become our <em>catch-all</em> and respond with the correct HTTP status code and
                a helpful message.</p>
              <p>Now, requests to a non-existent endpoints will result in better experience for our clients.</p>
              <h5>Challenge</h5>
              <p>Write a paragraph (or two) explaining what Express middleware is and what you’d use it for when writing
                Web APIs.</p>
              <p>When done send your explanation to your PM on Slack.</p>
              <h5>Dig Deeper</h5>
              <ul>
                <li>
                  <a href="https://www.npmjs.com/package/cors" target="blank_">cors middleware</a><br> Third party
                  middleware to make it easy to configure CORS in a Node.js application</li>
                <li>
                  <a href="https://www.npmjs.com/package/helmet" target="blank_">helmet middleware</a><br> Third party
                  middleware for configuring security headers in a Node.js application</li>
                <li>
                  <a href="https://www.npmjs.com/package/morgan" target="blank_">morgan middleware</a><br> Third party
                  middleware for logging in Node.js applications</li>
              </ul>
              <hr>
              <h4 class="mark mb-3 p-2">Learn to write custom middleware</h4>
              <p>We can write our own <code class="highlighter-rouge">Custom Middleware</code> to add functionality
                needed by our applications that is not included by Express.</p>
              <p>This is a powerful feature that makes it really easy to extend the Express framework without the need
                to modify it’s source code.</p>
              <p>We’ll see some examples of the two types of custom middleware that we’ll call <em>regular</em>
                middleware and <em>error handling</em> middleware.</p>
              <h5>Overview</h5>
              <p>Writing <code class="highlighter-rouge">custom middleware</code> is a two-step process:</p>
              <p>Write a function that will receive three or four arguments.
                Add it to the <code class="highlighter-rouge">middleware queue</code>.</p>
              <p>Let’s tackle the first part with an example. We’ll write middleware that logs information about every
                request that comes into our server. We’ll be displaying the information in the console window to keep
                things simple.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s2">`[</span><span class="p">${</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">()}</span><span class="s2">] </span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">}</span><span class="s2"> to </span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="s2"> from </span><span class="p">${</span><span class="nx">req</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
      <span class="dl">'</span><span class="s1">Origin</span><span class="dl">'</span>
    <span class="p">)}</span><span class="s2">`</span>
  <span class="p">);</span>

  <span class="nx">next</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>We can see that a middleware function takes <strong>three parameters</strong>, the <code
                  class="highlighter-rouge">request</code> and <code class="highlighter-rouge">response</code> objects,
                and a third parameter that is a <code class="highlighter-rouge">function that points to the next
                  middleware</code> in the queue. By convention, we name the third parameter <code
                  class="highlighter-rouge">next</code>. Please stick to that convention in your code.</p>
              <p>Any middleware in the queue CAN modify both the request and response objects, but it’s NOT required. In
                this case, we are not making changes to either.</p>
              <p>Any middleware in the queue can stop the request and send a response back to the client. When that
                happens, the rest of the middleware, including the route handlers, will not work. We’ll see an example
                of this in the code-along section.</p>
              <p>Calling <code class="highlighter-rouge">next()</code> signals to Express that the middleware has
                finished, and it should call the next middleware function. <strong>If next() is not called and a
                  response is not sent back to the client, the request will hang, and clients will get a timeout
                  error</strong>, so make sure to always call <code class="highlighter-rouge">next()</code> or use one
                of the methods that send a response back like <code class="highlighter-rouge">res.send()</code> or <code
                  class="highlighter-rouge">res.json()</code>.</p>
              <p>Now let’s add our shiny middleware to the queue! Right after <code
                  class="highlighter-rouge">server.use(express.json());</code> add the following line.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">logger</span><span class="p">);</span>
</code></pre>
                </div>
              </div>
              <p>Hitting any of our endpoints will display some information about the request in the console.</p>
              <p>Congratulations, you know how to write custom middleware for Express!</p>
              <h5>Follow Along</h5>
              <p>Any middleware in the queue can stop the request and send a response back to the client. When that
                happens, the rest of the middleware, including the route handlers, will not be executed. Let’s see this
                in action by writing our very own authentication middleware, but first, a bit of a story (any similarity
                to an actual story is a pure coincidence).</p>
              <p>Imagine you’re next to a lake where a dangerous creature dwells, and it is moving towards you with ill
                intentions. Luckily, next to you is a sealed door that leads to safety, unfortunately, to open the door
                you need to provide the right password. Let’s implement the API for that.</p>
              <p>Start by defining a function that shows our current predicament at the console as the application
                loads.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">atGate</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">At the gate, about to be eaten`);

  next();
}
</span></code></pre>
                </div>
              </div>
              <p>Then add it as the first middleware in the queue.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">atGate</span><span class="p">);</span>
</code></pre>
                </div>
              </div>
              <p>This is what’s called global or application-wide middleware. It applies to every endpoint in our
                server. Accessing any route in our server should display the message on the console.</p>
              <p>Now let’s add the authentication middleware that only grants access if we hit the correct route;
                picking any other route is futile, so be careful!</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">auth</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">/mellon</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">You shall not pass!</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>Now let’s add a route handler that leads to safety:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">server</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/mellon</span><span class="dl">'</span><span class="p">,</span> <span class="nx">auth</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Gate opening...</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Inside and safe</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">Welcome Traveler!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>What’s new here is that we are adding our middleware as the second parameter and the route handler as
                the third. Using middleware this way is what we call <strong>local middleware</strong> or route
                middleware. It just means we are using middleware locally and only applies to the endpoint where it’s
                added.</p>
              <h5>Challenge</h5>
              <p>Write a piece of middleware that responds with the message, “Balance is the key, making things even is
                the secret to success.” It should send an HTTP Status Code 403 (Forbidden) when the client makes a
                request, and when the seconds value in the server clock is odd. Otherwise, let the request flow through
                the rest of the middleware queue.</p>
              <p>So if a client makes any request and the server clock is at 11:10:11 or 11:10:13 the request is
                rejected, but at 11:10:12, or 11:10:14 is not.</p>
              <h5>Dig Deeper</h5>
              <ul>

                <li>
                  <a href="https://expressjs.com/en/api.html#express.json" target="blank_">express.json</a><br> The
                  documentation for how to use express.json to format your requests in Node/express</li>
              </ul>
              <hr>
              <h4 class="mark mb-3 p-2">Learn to write error handling middleware</h4>
              <p>There are two types of middleware in Express that we’ll call <em>regular</em> middleware and <em>error
                  handling</em> middleware.</p>
              <p>We have seen and worked with <em>regular middleware</em>. It is the middleware used when the
                application is working normally, but what happens when there is an error? That’s when <em>error handling
                  middleware</em> comes into action and all <em>regular middleware</em> is turned off.</p>
              <p>In this section we’ll cover how to write <em>error handling middleware</em> and how it works.</p>
              <h5>Overview</h5>
              <p>When our application encounters an error in the middle of executing middleware (remember route handlers
                are also middleware) code, we can <strong>choose</strong> to hand over control to <em>error handling
                  middleware</em> by calling <code class="highlighter-rouge">next()</code> with one argument. It is an
                unspoken convention to make that argument be an error object like this: <code
                  class="highlighter-rouge">next(new Error("error message"))</code>.</p>
              <p>This type of middleware takes four arguments: <code class="highlighter-rouge">error</code>, <code
                  class="highlighter-rouge">req</code>, <code class="highlighter-rouge">res</code>, and <code
                  class="highlighter-rouge">next</code>. We pass the first argument when calling <code
                  class="highlighter-rouge">next(new Error('error message here'))</code>. When the error handling code
                is finished, we can choose to end the request or call next without arguments to continue to the next
                <em>regular middleware</em>.</p>
              <p>Error handling middleware CAN be placed anywhere in the stack, but it makes the most sense to place it
                at the end. If the intention is for middleware to handle errors that may occur elsewhere in the queue,
                then it needs to run after the rest of the middleware has run.</p>
              <h5>Follow Along</h5>
              <p>Let’s see this error-handling middleware in code. First, let’s write an endpoint that sends a file to
                the client in response to a <code class="highlighter-rouge">GET</code> request to the <code
                  class="highlighter-rouge">/download</code> endpoint.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">server</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/download</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">index.html</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
</code></pre>
                </div>
              </div>
              <p>If we run our server and make a <code class="highlighter-rouge">GET</code> request to <code
                  class="highlighter-rouge">/download</code>, the server will crash since there is no <code
                  class="highlighter-rouge">index.html</code> file to send. We need to rewrite our endpoint and take
                advantage of the fact that <code class="highlighter-rouge">res.sendFile</code> supports passing a
                callback function as a second argument. This callback function will run after the file is sent, or if
                there is an error in the process of sending the file.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="c1">// note we added the third parameter here: next</span>
<span class="nx">server</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/download</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">index.html</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// if there is an error the callback function will get an error as it's first argument</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// we could handle the error here or pass it down to error-handling middleware like so:</span>
      <span class="nx">next</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="c1">// call the next error-handling middleware in the queue</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">File sent successfully</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>Now let’s go add error-handling middleware to our server. We can create the middleware function and
                then <code class="highlighter-rouge">use</code> it like any other middleware, or we can do it inline.
                Below an example of <code class="highlighter-rouge">using</code> it inline.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>

  <span class="nx">res</span>
    <span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">There was an error performing the required operation</span><span class="dl">'</span> <span class="p">});</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>This middleware will only get called if any other middleware or route handler <strong>that comes
                  before</strong> it has called <code class="highlighter-rouge">next()</code> with an argument like in
                the <code class="highlighter-rouge">/download</code> endpoint above.</p>
              <p>The complete code for our server now look like so:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="nx">server</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/download</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">filePath</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">index.html</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// if there is an error the callback function will get an error as it's first argument</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// we could handle the error here or pass it down to error-handling middleware like so:</span>
      <span class="nx">next</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="c1">// call the next error-handling middleware in the queue</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">File sent successfully</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>

  <span class="nx">res</span>
    <span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="na">message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">There was an error performing the required operation</span><span class="dl">'</span> <span class="p">});</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
</code></pre>
                </div>
              </div>
              <p>Open your browser and visit <a
                  href="http://localhost:5000/download">http://localhost:5000/download</a>, and the error message coming
                from our error-handling middleware should display.</p>
              <h5>Challenge</h5>
              <p>Write a piece of middleware that accepts an object with two properties: <code
                  class="highlighter-rouge">errorCode</code> and <code class="highlighter-rouge">errorMessage</code>.
                Your middleware should respond with different messages based on the <code
                  class="highlighter-rouge">errorCode</code> provided. If the error code is <code
                  class="highlighter-rouge">1404</code> return HTTP status code 404 and a <code
                  class="highlighter-rouge">not found</code> message, if the code is <code
                  class="highlighter-rouge">1500</code> return a <em>500</em> status code and a generic error message.
              </p>
              <h5>Dig Deeper</h5>
              <ul>
                <li>
                  <a href="https://nemethgergely.com/error-handling-express-async-await/" target="blank_">Error handling
                    middleware</a><br> An article on error handling using middleware.</li>
              </ul>
              <hr>
              <h2>
                <a id="guided-project" class="anchor" href="#guided-project" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Guided Project</h2>
              <h3>Node API 3 Guided Project Starter Code</h3>
              <a target="_blank" href="https://github.com/LambdaSchool/node-api3-guided">GitHub Repo</a>
              <hr>
              <h2 class="display-4">
                <a id="project" class="anchor" href="#project" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Project</h2>
              <ul class="list-group">
                <li class="list-group-item">
                  <h5><a target="_blank" href="https://github.com/LambdaSchool/node-api3-project">Node API 3 Project</a>
                  </h5>
                </li>
              </ul>
              <h2 class="display-4">
                <a id="review" class="anchor" href="#review" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Review</h2>
              <h3 class="display-5">Class Recordings</h3>
              <p class="lead">You can use class recordings to help you master the material.</p>
              <div>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">
                    <strong><a target="_blank" href="https://youtu.be/7MAoEoyVtkA">Express Middleware for Web PT 18 w/
                        Jason Maurer </a></strong>
                    <p>Express is a minimalist framework. It doesn’t provide everything out of the box, but using
                      middleware we can add extra functionality to our application. Middleware provide a way to extend
                      the features provided by the Express framework. They are implemented as small functions that
                      handle one aspect of our application. Tasks like authentication and logging are commonly handled
                      by middleware. Another benefit of Middleware is that it provides an easy way to add modularity to
                      our code.</p>
                  </li>
                  <li class="list-group-item">
                    <a href="/archive/FSW/module/recCJjYFEz0i5O5p5">All previous recordings</a>
                  </li>
                </ul>
              </div>
              <h3 class="display-5">Demonstrate Mastery</h3>
              <p>To demonstrate mastery of this module, you need to complete and pass a code review on each of the
                following:</p>
              <ul>
                <li>Objective challenge: <p>Write a paragraph (or two) explaining what Express middleware is and what
                    you’d use it for when writing Web APIs.</p>
                  <p>When done send your explanation to your PM on Slack.</p>
                </li>
                <li>Objective challenge: <p>Write a piece of middleware that responds with the message, “Balance is the
                    key, making things even is the secret to success.” It should send an HTTP Status Code 403
                    (Forbidden) when the client makes a request, and when the seconds value in the server clock is odd.
                    Otherwise, let the request flow through the rest of the middleware queue.</p>
                  <p>So if a client makes any request and the server clock is at 11:10:11 or 11:10:13 the request is
                    rejected, but at 11:10:12, or 11:10:14 is not.</p>
                </li>
                <li>Objective challenge: <p>Write a piece of middleware that accepts an object with two properties:
                    <code class="highlighter-rouge">errorCode</code> and <code
                      class="highlighter-rouge">errorMessage</code>. Your middleware should respond with different
                    messages based on the <code class="highlighter-rouge">errorCode</code> provided. If the error code
                    is <code class="highlighter-rouge">1404</code> return HTTP status code 404 and a <code
                      class="highlighter-rouge">not found</code> message, if the code is <code
                      class="highlighter-rouge">1500</code> return a <em>500</em> status code and a generic error
                    message.</p>
                </li>
                <li>Guided Project: Node API 3 Guided Project Starter Code</li>
                <li>Project: Node API 3 Project</li>
              </ul>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-80850900-4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push( arguments );
      }
      gtag( 'js', new Date() );

      gtag( 'config', 'UA-80850900-4' );
    </script>
    <script type="text/javascript">
      function getDomain() {
        const domainName = window.location.hostname.split( '.' )[ 1 ];
        return `${domainName}.com`;
      }
    </script>
    <script src="" integrity="" crossorigin="anonymous"></script>
    <script>
      window.jQuery || document.write( '<script src="/assets/js/vendor/jquery-slim.min.js"><\/script>' )
    </script>
    <script src="/assets/js/vendor/popper.min.js" integrity="" crossorigin="anonymous"></script>
    <script src="/dist/js/bootstrap.min.js" integrity="" crossorigin="anonymous"></script>
    <script src="/assets/js/activate.js"></script>
    <script src="/assets/js/jekyll-search.js" type="text/javascript"></script>
    <script type="text/javascript">
      SimpleJekyllSearch.init( {
        searchInput: document.getElementById( 'search-input' ),
        resultsContainer: document.getElementById( 'results-container' ),
        dataSource: '/search.json',
        searchResultTemplate: '<li class="list-group-item"><a href="{url}" title="Express Middleware">{title}</a></li>',
        noResultsText: '',
        limit: 10,
        fuzzy: true,
      } )
    </script>
    <script src="/assets/js/mermaid.min.js"></script>
    <script type="text/javascript">
      if ( window.attachEvent ) {
        window.attachEvent( 'onload', verifySignedIn );
      } else {
        if ( window.onload ) {
          var currentOnLoadFn = window.onload;
          var newOnLoadFn = function ( evt ) {
            currentOnLoadFn( evt );
            verifySignedIn();
          };
          window.onload = newOnLoadFn;
        } else {
          window.onload = verifySignedIn;
        }
      }

      function verifySignedIn() {
        if ( isPagePublic() ) {
          return showPageContents();
        }

        window.__user = null;
        isSignedIn().then( ( user ) => {
          window.__user = user;

          if ( !user.signedIn ) {
            redirectToSignIn();
          } else if ( !user.student && !window.__openToAdmissions ) {
            showUnauthorizedMessage();
          } else {
            showPageContents();
          }
        } );
      }

      function isPagePublic() {
        const openCourses = [
          'and-pre',
          'ds-pre',
          'fsw-pre',
          'help',
          'ios-pre',
        ];

        const openPages = [
          'cs-and',
          'cs-fsw',
          'cs-ios',
          'cr',
          'ds',
          'jx',
          'p4s',
          'ux',
        ];

        const pathParts = window.location.pathname.split( '/' );
        const courseName = pathParts[ 1 ];
        const pageName = pathParts[ pathParts.length - 1 ];

        return openCourses.includes( courseName ) || openPages.includes( pageName );
      }

      function isSignedIn() {
        const isDeployPreview = window.location.hostname.startsWith( 'deploy-preview' ) && window.location.hostname
          .endsWith( 'netlify.com' );

        if ( isDeployPreview ) return Promise.resolve( {
          signedIn: true,
          student: true
        } );

        return fetch( `${getAuthBaseUrl()}/whoami`, {
            credentials: 'include'
          } )
          .then( ( response ) => response.text() )
          .then( ( userAsText ) => userAsText ? JSON.parse( userAsText ) : null )
          .then( ( userData ) => ( {
            signedIn: Boolean( userData ),
            student: Boolean( userData && userData.airtableId ),
            id: userData ? userData.id : null,
            email: userData ? userData.email : null
          } ) )
          .catch( ( error ) => {} );
      }

      function redirectToSignIn() {
        const signInUrl =
          `${getAuthBaseUrl()}/sign-in?redirect=${encodeURIComponent(window.location.href)}&reason=auth_required`
        const redirectMessage = document.querySelector( '#redirect-message' );
        redirectMessage.style.display = "block";
        redirectMessage.innerHTML =
          `<div>You are being redirected to the sign in page. If you aren't redirected automatically, you can use <a href=${signInUrl}>this link</a>.</div>`
        window.location = signInUrl;
      }

      function showPageContents() {
        document.querySelector( '#content-wrapper' ).style.visibility = 'visible';
      }

      function showUnauthorizedMessage() {
        document.querySelector( '#unauthorized-message' ).style.display = 'block';
      }

      function getAuthBaseUrl() {
        const domain = getDomain();
        const authBaseUrl = `https://auth.${domain}`;
        return authBaseUrl;
      }
    </script>
    <script src="/assets/js/docs.min.js"></script>
    <script>
      var MathJax = {
        tex: {
          inlineMath: [
            [ '$$', '$$' ],
            [ '\[', '\])' ]
          ]
        },
        "HTML-CSS": {
          styles: {
            ".MathJax span": {
              color: "#000000"
            }
          }
        }
      }
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
    </script>
    <script>
      handleExternalLinks();

      function handleExternalLinks() {
        const domain = getDomain();
        const links = document.querySelectorAll( 'a' );
        return links.forEach( ( link ) => {
          if ( !link.host.includes( domain ) ) link.target = '_blank';
        } )
      };
    </script>
  </div>
</body>

</html>
