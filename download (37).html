<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
      name="description"
      content="Intended as a home for Lambda School curriculum."
    />
    <meta name="author" content="" />
    <meta name="generator" content="Jekyll v3.8.0" />
    <title>Client-Side Authentication Â· Lambda School</title>

    <link
      rel="stylesheet"
      integrity
      crossorigin="anonymous"
      href="https://d33wubrfki0l68.cloudfront.net/css/0f99ed215b3d52fa1bee44dc614ea3fa1d1bebc0/dist/css/bootstrap.min.css"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://d33wubrfki0l68.cloudfront.net/css/1bf8317b3d6d0c9d813c92505f052bf79ffdcdfe/assets/css/docs.min.css"
    />

    <link
      rel="stylesheet"
      href="https://d33wubrfki0l68.cloudfront.net/css/f3626ab7ab84821f8b60ea92b4a5c6acf59991af/assets/css/main.css"
    />



    <script>
      !(function () {
        var analytics = (window.analytics = window.analytics || []);
        if (!analytics.initialize)
          if (analytics.invoked)
            window.console &&
              console.error &&
              console.error("Segment snippet included twice.");
          else {
            analytics.invoked = !0;
            analytics.methods = [
              "trackSubmit",
              "trackClick",
              "trackLink",
              "trackForm",
              "pageview",
              "identify",
              "reset",
              "group",
              "track",
              "ready",
              "alias",
              "debug",
              "page",
              "once",
              "off",
              "on",
            ];
            analytics.factory = function (t) {
              return function () {
                var e = Array.prototype.slice.call(arguments);
                e.unshift(t);
                analytics.push(e);
                return analytics;
              };
            };
            for (var t = 0; t < analytics.methods.length; t++) {
              var e = analytics.methods[t];
              analytics[e] = analytics.factory(e);
            }
            analytics.load = function (t, e) {
              var n = document.createElement("script");
              n.type = "text/javascript";
              n.async = !0;
              n.src =
                "https://cdn.segment.com/analytics.js/v1/" +
                t +
                "/analytics.min.js";
              var a = document.getElementsByTagName("script")[0];
              a.parentNode.insertBefore(n, a);
              analytics._loadOptions = e;
            };
            analytics.SNIPPET_VERSION = "4.1.0";
            analytics.load("BjKorwKrSvMamfNoGkBq9rISk7wF6QQX");
            analytics.page();
          }
      })();
    </script>

    <link
      rel="apple-touch-icon"
      href="/assets/img/favicons/apple-touch-icon.png"
      sizes="180x180"
    />
    <link
      rel="icon"
      href="/assets/img/favicons/favicon-32x32.png"
      sizes="32x32"
      type="image/png"
    />
    <link
      rel="icon"
      href="/assets/img/favicons/favicon-16x16.png"
      sizes="16x16"
      type="image/png"
    />
    <link rel="manifest" href="/assets/img/favicons/manifest.json" />
    <link
      rel="mask-icon"
      href="/assets/img/favicons/safari-pinned-tab.svg"
      color="#a0001e"
    />
    <link rel="icon" href="/favicon.ico" />
    <meta
      name="msapplication-config"
      content="/assets/img/favicons/browserconfig.xml"
    />
    <meta name="theme-color" content="#a0001e" />
  </head>

  <body>
    <noscript>Please enable JavaScript to view this page.</noscript>
    <div id="redirect-message" style="display: none">
      You must be logged in to view this page.
    </div>
    <div id="unauthorized-message" style="display: none">
      You must be a Lambda School student to view this page.
    </div>
    <div id="content-wrapper">
      <a id="skippy" class="sr-only sr-only-focusable" href="#content">
        <div class="container">
          <span class="skiplink-text">Skip to main content</span>
        </div>
      </a>
      <div class="mobile-menu">
        <div class="m-drop">
          <div class="mobile-row">
            <div class="header-row" style="padding: 3px 7px">
              <a class="navbar-brand" href="/" aria-label="Lambda School"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="33"
                  height="35"
                  viewBox="0 0 33 35"
                  fill="none"
                >
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M0 0V16.0609C0 27.7335 9.08929 31.7843 15.7321 34.7513H15.75L16.2857 35C16.4107 34.9289 16.5357 34.8756 16.6786 34.8223C16.75 34.7868 16.8393 34.7513 16.9107 34.7157C23.5714 31.7665 32.6964 27.698 32.6964 16.0609V0H0ZM20.7071 23.4536L20.3571 22.5102L15.6071 10.0736C15.3214 10.802 14.6607 12.5609 13.9464 14.4442L11.2143 21.7817C11.0893 22.1371 11.1607 22.3147 11.25 22.4391C11.4464 22.6701 11.8768 22.6701 12.5554 22.6701H12.6786L12.6768 23.4518H7.56964V22.6701H7.9625C8.65893 22.6701 9.23036 22.368 9.65893 21.5152L10.1768 20.3426L14.9089 8.29696L14.0696 6.07614H18.4804L24.5696 22.0127L25.125 23.4536H20.7071Z"
                    fill="#EC3944"
                  /></svg
              ></a>
              <button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#mobile-course-menu"
                aria-controls="mobile-course-menu"
                aria-expanded="false"
                aria-label="Toggle navigation"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 30 30"
                  width="30"
                  height="30"
                  focusable="false"
                >
                  <title>Menu</title>
                  <path
                    stroke="#ffffff"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    d="M4 7h22M4 15h22M4 23h22"
                  ></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="nav-row">
            <div class="results-container">
              <ul id="results-container" class="dropdown list-group"></ul>
            </div>
            <div id="mobile-course-menu" class="collapse nav-row">
              <div class="docs-mobile-sidebar" id="bd-docs-nav-mobile">
                <nav class="bd-links">
                  <div class="bd-toc-item">
                    <h4 class="bd-toc-link">Web Applications II</h4>
                  </div>

                  <div class="bd-toc-item">
                    <a
                      class="bd-toc-link"
                      href="/web3/sprint/recq59MvEIZfUAohy"
                    >
                      1.&nbsp;&nbsp;Advanced React
                    </a>
                    <ul class="nav bd-sidenav">
                      <li>
                        <a href="/web3/module/recnDKrWb24lgaziC/">
                          Class Components
                        </a>
                      </li>
                      <li>
                        <a href="/web3/module/rec1DPoOZSmocXfak/">
                          The React Lifecycle
                        </a>
                      </li>
                      <li>
                        <a href="/web3/module/recAxmnYmusEi8JuL/">
                          Composing and Sharing Non-Visual Behavior
                        </a>
                      </li>
                      <li>
                        <a href="/web3/module/rechTQVfCg4p85Hoi/">
                          Testing Web Applications
                        </a>
                      </li>
                    </ul>
                  </div>
                  <div class="bd-toc-item">
                    <a
                      class="bd-toc-link"
                      href="/web3/sprint/recukritK1B1pFrcM"
                    >
                      2.&nbsp;&nbsp;Advanced State Management
                    </a>
                    <ul class="nav bd-sidenav">
                      <li>
                        <a href="/web3/module/rectpk6uIV3pCHJh8/">
                          The Reducer Pattern
                        </a>
                      </li>
                      <li>
                        <a href="/web3/module/recba2NUdVmgKYyR3/"> Redux </a>
                      </li>
                      <li>
                        <a href="/web3/module/recSoiWNJzGURrXYh/">
                          Async Redux
                        </a>
                      </li>
                      <li>
                        <a href="/web3/module/recByjgF7FwwH5Z7W/">
                          Context API
                        </a>
                      </li>
                    </ul>
                  </div>
                  <div class="bd-toc-item">
                    <a
                      class="bd-toc-link"
                      href="/web3/sprint/recnhsJGy28gNi1K5"
                    >
                      3.&nbsp;&nbsp;Advanced Web Applications
                    </a>
                    <ul class="nav bd-sidenav">
                      <li>
                        <a href="/web3/module/recS9H6qCj0dQe32B/">
                          Testing React
                        </a>
                      </li>
                      <li class="active bd-sidenav-active">
                        <a href="/web3/module/recQlbCZf9tOVgiXC/">
                          Client-Side Authentication
                        </a>
                      </li>
                      <li>
                        <a href="/web3/module/recupVjaAKPqbuk7Y/">
                          HTTP / AJAX II
                        </a>
                      </li>
                      <li>
                        <a href="/web3/module/receOMvCB7dSyX5FL/">
                          Deploying Web Apps
                        </a>
                      </li>
                    </ul>
                  </div>
                  <div class="bd-toc-item">
                    <a
                      class="bd-toc-link"
                      href="/web3/sprint/recVFiuMBzbcZllxC"
                    >
                      4.&nbsp;&nbsp;WEB Unit 3 Build
                    </a>
                    <ul class="nav bd-sidenav"></ul>
                  </div>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="main-container">
        <div class="sidebar-container bd-sidebar">
          <div class="docs-sidebar">
            <a class="navbar-brand" href="/" aria-label="Lambda School"
              ><svg
                width="135"
                height="35"
                viewBox="0 0 756 197"
                fill="#ec3944"
              >
                <g>
                  <path
                    d="M292.9,126.6h-6.7c-9,0-12.6-1.9-12.6-9.5V48.5c0-7.7,1.6-8.6,11.4-9.7v-4.5h-41.3v4.5 c9.8,1.1,11.4,1.9,11.4,9.7v69.3c0,7.7-1.6,8.6-11.4,9.7v4.5h73.7l4.9-29.4h-4.4C308.5,119.6,303.9,126.6,292.9,126.6z"
                  ></path>
                  <path
                    d="M385.5,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1l0.1-0.1l0,0V132h26v-4.4C387.7,127.1,385.5,126.2,385.5,121.1z M368,117.8 c-4.4,3.3-7.6,5.3-12,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4V117.8L368,117.8z"
                  ></path>
                  <path
                    d="M514.4,121V79.5c0-14.8-6-22.4-18.7-22.4c-11.5,0-19.4,6.6-25.5,13.9c-1.8-9.6-7.7-13.9-17.8-13.9 c-11.4,0-18.7,6.2-24.8,13.6V57h-2.3l-23.8,7.4v2.4l8.6,5v49.4c0,5-2.1,6.1-8.9,6.4v4.4h35.1v-4.4c-6.7-0.3-8.7-1.3-8.7-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7v40.8c0,5-1.9,6.1-8.7,6.4v4.4l34.8,0v-4.4c-6.7-0.3-8.6-1.3-8.6-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7l-0.1,40.5c0,5-1.8,6.4-8.6,6.7l0,4.4h35.1v-4.4 C516.7,127.4,514.4,126.1,514.4,121z"
                  ></path>
                  <path
                    d="M573.2,57.3c-11,0-18.5,5.7-23.4,12.8V22.9h-2.7l-23.4,6.8v2.5l8.6,4.5V132h2.9l8-3.5c5.8,3.3,12.3,5,20.2,5 c20.8,0,37.4-15.8,37.4-42.6C600.9,69.9,590.4,57.3,573.2,57.3z M563.4,128.7c-5.4,0-10.3-2.4-13.7-7.9V73.6 c3.4-3.4,8.5-5.7,13.5-5.7c13.9,0,20,12.8,20,29.5C583.3,114.7,575.8,128.5,563.4,128.7z"
                  ></path>
                  <path
                    d="M677,121.2V22.8h-2.6L651,29.6V32l8.6,4.5v25.7c-3.4-3.2-8.8-5.1-15.5-5.1c-19.9,0-35.2,15.3-35.2,41.3 c0,20.7,11.2,34.6,28.1,34.6c9.8,0,17-5.3,22.6-13.1v0.9V132h26.3l0-4.4C679.1,127.3,677,126.3,677,121.2z M659.6,117.1 L659.6,117.1c-3.4,3.4-8,5.1-13.2,5.1c-13.2,0-20.4-12.8-20.4-29.8c0-17.8,7.3-29.2,19.5-29.2c8.7,0,14.1,6.9,14.1,18.3 L659.6,117.1z"
                  ></path>
                  <path
                    d="M747.1,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1v-0.1h0.1l0,11.1l26,0.1v-4.5C749.3,127.1,747.1,126.2,747.1,121.1z M729.6,117.8c-4.4,3.3-7.6,5.3-12.1,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4L729.6,117.8L729.6,117.8z"
                  ></path>
                </g>
                <path
                  d="M0,0v90.4c0,65.7,50.9,88.5,88.1,105.2h0.1l3,1.4c0.7-0.4,1.4-0.7,2.2-1c0.4-0.2,0.9-0.4,1.3-0.6 c37.3-16.6,88.4-39.5,88.4-105V0H0z M116,132l-2-5.3l-26.6-70c-1.6,4.1-5.3,14-9.3,24.6l-15.3,41.3c-0.7,2-0.3,3,0.2,3.7 c1.1,1.3,3.5,1.3,7.3,1.3H71l0,4.4H42.4l0-4.4h2.2c3.9,0,7.1-1.7,9.5-6.5l2.9-6.6l26.5-67.8l-4.7-12.5h24.7l34.1,89.7l3.1,8.1H116z"
                ></path></svg
            ></a>
            <ul id="results-container" class="dropdown list-group"></ul>
            <nav class="bd-links collapse" id="bd-docs-nav">
              <div class="bd-toc-item">
                <h4 class="bd-toc-link">Web Applications II</h4>
              </div>

              <div class="bd-toc-item">
                <a class="bd-toc-link" href="/web3/sprint/recq59MvEIZfUAohy">
                  1.&nbsp;&nbsp;Advanced React
                </a>
                <ul class="nav bd-sidenav">
                  <li>
                    <a href="/web3/module/recnDKrWb24lgaziC/">
                      Class Components
                    </a>
                  </li>
                  <li>
                    <a href="/web3/module/rec1DPoOZSmocXfak/">
                      The React Lifecycle
                    </a>
                  </li>
                  <li>
                    <a href="/web3/module/recAxmnYmusEi8JuL/">
                      Composing and Sharing Non-Visual Behavior
                    </a>
                  </li>
                  <li>
                    <a href="/web3/module/rechTQVfCg4p85Hoi/">
                      Testing Web Applications
                    </a>
                  </li>
                </ul>
              </div>
              <div class="bd-toc-item">
                <a class="bd-toc-link" href="/web3/sprint/recukritK1B1pFrcM">
                  2.&nbsp;&nbsp;Advanced State Management
                </a>
                <ul class="nav bd-sidenav">
                  <li>
                    <a href="/web3/module/rectpk6uIV3pCHJh8/">
                      The Reducer Pattern
                    </a>
                  </li>
                  <li>
                    <a href="/web3/module/recba2NUdVmgKYyR3/"> Redux </a>
                  </li>
                  <li>
                    <a href="/web3/module/recSoiWNJzGURrXYh/"> Async Redux </a>
                  </li>
                  <li>
                    <a href="/web3/module/recByjgF7FwwH5Z7W/"> Context API </a>
                  </li>
                </ul>
              </div>
              <div class="bd-toc-item">
                <a class="bd-toc-link" href="/web3/sprint/recnhsJGy28gNi1K5">
                  3.&nbsp;&nbsp;Advanced Web Applications
                </a>
                <ul class="nav bd-sidenav">
                  <li>
                    <a href="/web3/module/recS9H6qCj0dQe32B/">
                      Testing React
                    </a>
                  </li>
                  <li class="active bd-sidenav-active">
                    <a href="/web3/module/recQlbCZf9tOVgiXC/">
                      Client-Side Authentication
                    </a>
                  </li>
                  <li>
                    <a href="/web3/module/recupVjaAKPqbuk7Y/">
                      HTTP / AJAX II
                    </a>
                  </li>
                  <li>
                    <a href="/web3/module/receOMvCB7dSyX5FL/">
                      Deploying Web Apps
                    </a>
                  </li>
                </ul>
              </div>
              <div class="bd-toc-item">
                <a class="bd-toc-link" href="/web3/sprint/recVFiuMBzbcZllxC">
                  4.&nbsp;&nbsp;WEB Unit 3 Build
                </a>
                <ul class="nav bd-sidenav"></ul>
              </div>
            </nav>
          </div>
        </div>
        <main class="content-container flex-wrapper" role="main">
          <div class="sticky-nav">
            <div class="sprint-nav">
              <ul class="section-nav">
                <li class="toc-entry toc-h2"><a href="#prepare">Prepare</a></li>
                <li class="toc-entry toc-h2"><a href="#learn">Learn</a></li>
                <li class="toc-entry toc-h2"><a href="#project">Project</a></li>
                <li class="toc-entry toc-h2"><a href="#review">Review</a></li>
              </ul>
            </div>
          </div>
          <div class="wrapper limit-width">
            <div class="flex-wrapper">
              <div class="limit-width">
                <div class="jumbotron">
                  <h1 class="bd-title" id="content">
                    Client-Side Authentication
                  </h1>
                  <span class="lead">
                    <p class="bd-lead"></p>
                    <p>
                      We will learn how to work with a server that uses tokens
                      for authentication
                    </p>
                  </span>
                  <strong
                    >At the end of this module, you should be able to:</strong
                  >
                  <ul>
                    <li>handle authentication with tokens in a React app</li>
                    <li>
                      implement protected routes using an authentication token
                      and Redirect
                    </li>
                  </ul>
                </div>
                <div class="alert alert-warning" role="alert">
                  <h4>Pro Tip</h4>
                  <p>
                    As you think [positively or negatively], so shall you
                    become.
                  </p>
                  <footer class="blockquote-footer">
                    <p>Bruce Lee</p>
                  </footer>
                </div>
                <h2 class="display-4">
                  <a
                    id="prepare"
                    class="anchor"
                    href="#prepare"
                    aria-hidden="true"
                    ><span class="octicon octicon-link"></span></a
                  >Prepare
                </h2>
                <p class="lead">Review each preclass resource before class.</p>
                <div class="preclass">
                  <ul class="list-group list-group-flush"></ul>
                </div>
                <h2 class="display-4">
                  <a id="learn" class="anchor" href="#learn" aria-hidden="true"
                    ><span class="octicon octicon-link"></span></a
                  >Learn
                </h2>
                <h4 class="mark mb-3 p-2">
                  Learn to handle authentication with tokens in a React app
                </h4>
                <p>
                  Many services out in the wild require the client (our React
                  app, for example) to provide proof that itâs authenticated
                  with them. The server running these services can issue a JWT
                  (JSON Web Token) as the authentication token, in exchange for
                  correct login credentials. So how do we handle this token from
                  then on, inside our Single Page Application?
                </p>
                <h5>Overview</h5>
                <p>
                  In general, servers donât remember anything about us after
                  each interaction. Clients need to tack a reminder to every
                  request, and this is commonly done automatically with cookies.
                  Cookies are just small pieces of data generated by the browser
                  to store state information.
                </p>
                <p>
                  Modern web services dealing with JSON data often use Jason Web
                  Tokens (JWT)s instead. These tokens, issued by the server, are
                  strings of cryptic text, which can be stored on the
                  client-side using local storage or session storage. The server
                  can readily tell the client that it issued the token. It can
                  also read the token and make decisions for data transfer based
                  on the clientâs permission.
                </p>
                <p>
                  A common pattern is for a login endpoint to exist, which takes
                  a payload of
                  <code class="highlighter-rouge">username</code> and
                  <code class="highlighter-rouge">password</code>. If the
                  credentials are known, the server responds with a fresh JWT.
                  From then on, itâs the applicationâs responsibility to add an
                  <code class="highlighter-rouge"
                    >Authorization: &lt;token&gt;</code
                  >
                  header to every request, to be allowed access to protected
                  resources that require authentication.
                </p>
                <h5>Follow Along</h5>
                <p>
                  We are going to create an Axios configuration that attaches an
                  <code class="highlighter-rouge"
                    >Authorization: &lt;token&gt;</code
                  >
                  header to requests. To do that, we will create a new file
                  called <code class="highlighter-rouge">axiosAuth.js</code>.
                  Whenever the application needs to exchange data with a
                  protected endpoint, it imports this module, instead of the
                  usual
                  <code class="highlighter-rouge"
                    >import axios from "axios";</code
                  >.
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="k">import</span> <span class="nx">axios</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">axios</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">axiosWithAuth</span> <span class="o">=</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">Authorization</span><span class="p">:</span> <span class="nx">token</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">});</span>
<span class="p">};</span>
</code></pre>
                  </div>
                </div>
                <p>
                  <em
                    >Note: Some APIâs require you to use a slightly different
                    syntax. Make sure you understand the API you are working
                    with:</em
                  >
                </p>
                <div class="language-javascript highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="nx">Authorization</span><span class="p">:</span> <span class="s2">`Bearer </span><span class="p">${</span><span class="nx">token</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
</code></pre>
                  </div>
                </div>
                <p>
                  After the user properly authenticates (properly logs in), the
                  server returns the token. Your application needs to save the
                  returned token (the permissions) to
                  <code class="highlighter-rouge">localStorage</code>, so that
                  the above
                  <code class="highlighter-rouge">axiosWithAuth</code> module
                  can grab it for other calls that require the Authorization
                  header.
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="kd">const</span> <span class="nx">login</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">endpoint/here</span><span class="dl">'</span><span class="p">,</span> <span class="nx">userCredentials</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>
      <span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">/dashboard</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
                  </div>
                </div>
                <p>
                  Now that we have the token, we can do an AJAX request to an
                  endpoint using the
                  <code class="highlighter-rouge">axiosWithAuth.js</code>
                  module.
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code>  <span class="k">import</span> <span class="p">{</span> <span class="nx">axiosWithAuth</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../../path/to/axiosAuth.js</span><span class="dl">'</span><span class="p">;</span>
  <span class="c1">// etc</span>
  <span class="nx">axiosWithAuth</span><span class="p">().</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">endpoint/path/here</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="cm">/* do something with the data */</span><span class="p">);</span>
</code></pre>
                  </div>
                </div>
                <p>
                  If you inspect the request on the Network tab in Chrome
                  Devtools, you should see
                  <code class="highlighter-rouge"
                    >Authorization:
                    eyJ1c2VySWQiOiJiMDhmODZhZi0zNWRhLTQ4ZjItOGZhYi1jZWYzOTA0NjYwYmQifQ</code
                  >
                  among the request headers.
                </p>
                <h5>Challenge</h5>
                <p>
                  Improve our custom Axios configuration using the library
                  <code class="highlighter-rouge">axios-retry</code>. The idea
                  is to automatically retry the request three times, if there
                  are errors or timeouts.
                </p>
                <hr />
                <h4 class="mark mb-3 p-2">
                  Learn to implement protected routes using an authentication
                  token and Redirect
                </h4>
                <p>
                  Most of the web apps we will work on will have some sort of
                  authentication system. We want to protect any routes in our
                  app from being rendered if the user is not authenticated with
                  a token from the server.
                </p>
                <h5>Overview</h5>
                <p>
                  As we build our web apps, we will most likely have some
                  âprotectedâ routes - routes that should only render with
                  authentication. Normally, the client will make a login
                  request, sending the server the userâs username and password.
                  Then, the server will check those credentials against the
                  database, and if it can authenticate the user, it will return
                  a token. Once we have this token, we can add two layers of
                  protection to our app. One uses protected routes, and the
                  other sends an authentication header with our API calls (as we
                  learned in the above objective).
                </p>
                <h5>Follow Along</h5>
                <p>
                  Letâs see what this looks like in code. We will use some React
                  Router components, and build a custom
                  <code class="highlighter-rouge">&lt;PrivateRoute /&gt;</code>
                  component to protect the route.
                </p>
                <p>
                  In our <code class="highlighter-rouge">App</code> component,
                  letâs add a couple of public routes and a couple of links:
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">to</span><span class="o">=</span><span class="dl">"</span><span class="s2">/public</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">Public</span> <span class="nx">Page</span><span class="o">&lt;</span><span class="sr">/Link</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Link</span> <span class="nx">to</span><span class="o">=</span><span class="dl">"</span><span class="s2">/protected</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">Protected</span> <span class="nx">Page</span><span class="o">&lt;</span><span class="sr">/Link</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="dl">"</span><span class="s2">/public</span><span class="dl">"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Public</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="dl">"</span><span class="s2">/login</span><span class="dl">"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Login</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                  </div>
                </div>
                <p>
                  Notice the links? Anyone can click on the âPublic Pageâ link,
                  but if they click on the âProtected Pageâ link without
                  authorization, they will be routed to the login page instead.
                </p>
                <p>
                  Next step will be to add a
                  <code class="highlighter-rouge">&lt;PrivateRoute /&gt;</code>
                  route:
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="dl">"</span><span class="s2">/public</span><span class="dl">"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Public</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="dl">"</span><span class="s2">/login</span><span class="dl">"</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Login</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="nx">PrivateRoute</span> <span class="nx">path</span><span class="o">=</span><span class="dl">'</span><span class="s1">/protected</span><span class="dl">'</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Protected</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span></code></pre>
                  </div>
                </div>
                <p>Here are the requirements for our PrivateRoute component.</p>
                <ul>
                  <li>
                    It has the same API as
                    <code class="highlighter-rouge">&lt;Route /&gt;</code>.
                  </li>
                  <li>
                    It renders a
                    <code class="highlighter-rouge">&lt;Route /&gt;</code> and
                    passes all the props through to it.
                  </li>
                  <li>
                    It checks if the user is authenticated, if they are, it
                    renders the âcomponentâ prop. If not, it redirects the user
                    to /login.
                  </li>
                </ul>
                <p>With those requirements in mind, letâs build it out.</p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="c1">// Requirement 1.</span>
<span class="c1">// It has the same API as `&lt;Route /&gt;`</span>

<span class="kd">const</span> <span class="nx">PrivateRoute</span> <span class="o">=</span> <span class="p">({</span> <span class="na">component</span><span class="p">:</span> <span class="nx">Component</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>

<span class="p">)</span>
</code></pre>
                  </div>
                </div>
                <p>
                  This code means that the component can accept a component
                  Prop, just like
                  <code class="highlighter-rouge">&lt;Route /&gt;</code> does,
                  and take any other prop that gets passed into it by spreading
                  in <code class="highlighter-rouge">...rest</code>.
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="c1">// Requirement 2.</span>
<span class="c1">// It renders a `&lt;Route /&gt;` and passes all the props through to it.</span>

<span class="kd">const</span> <span class="nx">PrivateRoute</span> <span class="o">=</span> <span class="p">({</span> <span class="na">component</span><span class="p">:</span> <span class="nx">Component</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">Route</span> <span class="p">{...</span><span class="nx">rest</span><span class="p">}</span> <span class="nx">render</span><span class="o">=</span><span class="p">{}</span> <span class="sr">/</span><span class="err">&gt;
</span><span class="p">)</span>
</code></pre>
                  </div>
                </div>
                <p>
                  We are passing in all of the props passed to
                  <code class="highlighter-rouge">&lt;PrivateRoute /&gt;</code>
                  in the App component.
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="c1">// Requirement 3.</span>
<span class="c1">// It checks if the user is authenticated, if they are,</span>
<span class="c1">// it renders the "component" prop. If not, it redirects</span>
<span class="c1">// the user to /login.</span>

<span class="kd">const</span> <span class="nx">PrivateRoute</span> <span class="o">=</span> <span class="p">({</span> <span class="na">component</span><span class="p">:</span> <span class="nx">Component</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">Route</span>
    <span class="p">{...</span><span class="nx">rest</span><span class="p">}</span>
    <span class="nx">render</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span> <span class="o">=&gt;</span>
      <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">"</span><span class="s2">token</span><span class="dl">"</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">)</span> <span class="p">:</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">Redirect</span> <span class="nx">to</span><span class="o">=</span><span class="dl">"</span><span class="s2">/login</span><span class="dl">"</span> <span class="o">/&gt;</span>
      <span class="p">)</span>
    <span class="p">}</span>
  <span class="sr">/</span><span class="err">&gt;
</span><span class="p">);</span>
</code></pre>
                  </div>
                </div>
                <p>
                  This is using the render props pattern. We wonât go too much
                  into how this works here, but it would be a great weekend
                  learning objective for you to look into if you so desire.
                </p>
                <p>
                  Also, notice the
                  <code class="highlighter-rouge">&lt;Redirect /&gt;</code>
                  component? That is from React Router. It does exactly what you
                  think - redirects the app to the supplied route.
                </p>
                <p>
                  At this point, you can see the PrivateRoute component in
                  action if you try to click on the Protected Page link. You
                  should be redirected to â/loginâ instead of being taken to the
                  â/protectedâ page.
                </p>
                <p>
                  Letâs think about the login page now. Our login page is going
                  to be a form that takes in a userâs credentials, calls the
                  login endpoint with a
                  <code class="highlighter-rouge">POST</code> request, and then
                  redirects the user to the protected route when the login API
                  call returns. Letâs set it up and practice our authentication
                  skills!
                </p>
                <div class="language-js highlighter-rouge">
                  <div class="highlight">
                    <pre
                      class="highlight"
                    ><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">axiosWithAuth</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../path/to/module</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Login</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
 <span class="kd">const</span> <span class="p">[</span><span class="nx">credentials</span><span class="p">,</span> <span class="nx">setCredentials</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({});</span>

  <span class="kd">const</span> <span class="nx">login</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">axiosWithAuth</span><span class="p">().</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">login/endpoint</span><span class="dl">'</span><span class="p">,</span> <span class="nx">credentials</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">})</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">handleChange</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="na">setCredentials</span><span class="p">:</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">credentials</span><span class="p">,</span>
        <span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">name</span><span class="p">]:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
      <span class="p">}</span>
  <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">login</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">input</span>
            <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text</span><span class="dl">"</span>
            <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">username</span><span class="dl">"</span>
            <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">username</span><span class="p">}</span>
            <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span>
          <span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">input</span>
            <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">password</span><span class="dl">"</span>
            <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">password</span><span class="dl">"</span>
            <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">credentials</span><span class="p">.</span><span class="nx">password</span><span class="p">}</span>
            <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span>
          <span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">button</span><span class="o">&gt;</span><span class="nx">Log</span> <span class="k">in</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Login</span><span class="p">;</span>
</code></pre>
                  </div>
                </div>
                <p>
                  Great work providing a good experience for your amazing users!
                </p>
                <h5>Challenge</h5>
                <p>
                  Add some
                  <code class="highlighter-rouge">loggingIn</code> state, and
                  <code class="highlighter-rouge">error</code> state. Solve for
                  both potential states in your login form. For example, if
                  <code class="highlighter-rouge">loggingIn</code> is true, show
                  a spinner in the button. If there is an error, display an
                  error message.
                </p>
                <hr />
                <h2 class="display-4">
                  <a
                    id="project"
                    class="anchor"
                    href="#project"
                    aria-hidden="true"
                    ><span class="octicon octicon-link"></span></a
                  >Project
                </h2>
                <ul class="list-group">
                  <li class="list-group-item">
                    <h5>
                      <a
                        target="_blank"
                        href="https://github.com/LambdaSchool/Auth-Friends"
                        >Auth Friends</a
                      >
                    </h5>
                    <p>
                      Build an app that renders list of friends retrieved from a
                      server that uses tokens for authentication
                    </p>
                  </li>
                </ul>
                <h2 class="display-4">
                  <a
                    id="review"
                    class="anchor"
                    href="#review"
                    aria-hidden="true"
                    ><span class="octicon octicon-link"></span></a
                  >Review
                </h2>
                <h3 class="display-5">Class Recordings</h3>
                <p class="lead">
                  You can use class recordings to help you master the material.
                </p>
                <div>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                      <strong
                        ><a target="_blank" href="https://youtu.be/9PgoErOMgOY"
                          >Client-Side Authentication for Web35 w/Warren
                          Longmire</a
                        ></strong
                      >
                      <p>Client-Side Authentication</p>
                    </li>
                    <li class="list-group-item">
                      <a href="/archive/FSW/module/recQlbCZf9tOVgiXC"
                        >All previous recordings</a
                      >
                    </li>
                  </ul>
                </div>
                <h3 class="display-5">Demonstrate Mastery</h3>
                <p>
                  To demonstrate mastery of this module, you need to complete
                  and pass a code review on each of the following:
                </p>
                <ul>
                  <li>
                    Objective challenge:
                    <p>
                      Improve our custom Axios configuration using the library
                      <code class="highlighter-rouge">axios-retry</code>. The
                      idea is to automatically retry the request three times, if
                      there are errors or timeouts.
                    </p>
                  </li>
                  <li>
                    Objective challenge:
                    <p>
                      Add some
                      <code class="highlighter-rouge">loggingIn</code> state,
                      and <code class="highlighter-rouge">error</code> state.
                      Solve for both potential states in your login form. For
                      example, if
                      <code class="highlighter-rouge">loggingIn</code> is true,
                      show a spinner in the button. If there is an error,
                      display an error message.
                    </p>
                  </li>
                  <li>Project: Auth Friends</li>
                </ul>
              </div>
            </div>
          </div>
        </main>
      </div>

      <script
        async
        src="https://www.googletagmanager.com/gtag/js?id=UA-80850900-4"
      ></script>
      <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
          dataLayer.push(arguments);
        }
        gtag("js", new Date());

        gtag("config", "UA-80850900-4");
      </script>
      <script type="text/javascript">
        function getDomain() {
          const domainName = window.location.hostname.split(".")[1];
          return `${domainName}.com`;
        }
      </script>
      <script src="" integrity="" crossorigin="anonymous"></script>
      <script>
        window.jQuery ||
          document.write(
            '<script src="/assets/js/vendor/jquery-slim.min.js"><\/script>'
          );
      </script>
      <script
        src="/assets/js/vendor/popper.min.js"
        integrity=""
        crossorigin="anonymous"
      ></script>
      <script
        src="/dist/js/bootstrap.min.js"
        integrity=""
        crossorigin="anonymous"
      ></script>
      <script src="/assets/js/activate.js"></script>
      <script src="/assets/js/jekyll-search.js" type="text/javascript"></script>
      <script type="text/javascript">
        SimpleJekyllSearch.init({
          searchInput: document.getElementById("search-input"),
          resultsContainer: document.getElementById("results-container"),
          dataSource: "/search.json",
          searchResultTemplate:
            '<li class="list-group-item"><a href="{url}" title="Client-Side Authentication">{title}</a></li>',
          noResultsText: "",
          limit: 10,
          fuzzy: true,
        });
      </script>
      <script src="/assets/js/mermaid.min.js"></script>
      <script type="text/javascript">
        if (window.attachEvent) {
          window.attachEvent("onload", verifySignedIn);
        } else {
          if (window.onload) {
            var currentOnLoadFn = window.onload;
            var newOnLoadFn = function (evt) {
              currentOnLoadFn(evt);
              verifySignedIn();
            };
            window.onload = newOnLoadFn;
          } else {
            window.onload = verifySignedIn;
          }
        }

        function verifySignedIn() {
          if (isPagePublic()) {
            return showPageContents();
          }

          window.__user = null;
          isSignedIn().then((user) => {
            window.__user = user;

            if (!user.signedIn) {
              redirectToSignIn();
            } else if (!user.student && !window.__openToAdmissions) {
              showUnauthorizedMessage();
            } else {
              showPageContents();
            }
          });
        }

        function isPagePublic() {
          const openCourses = [
            "and-pre",
            "ds-pre",
            "fsw-pre",
            "help",
            "ios-pre",
          ];

          const openPages = [
            "cs-and",
            "cs-fsw",
            "cs-ios",
            "cr",
            "ds",
            "jx",
            "p4s",
            "ux",
          ];

          const pathParts = window.location.pathname.split("/");
          const courseName = pathParts[1];
          const pageName = pathParts[pathParts.length - 1];

          return (
            openCourses.includes(courseName) || openPages.includes(pageName)
          );
        }

        function isSignedIn() {
          const isDeployPreview =
            window.location.hostname.startsWith("deploy-preview") &&
            window.location.hostname.endsWith("netlify.com");

          if (isDeployPreview)
            return Promise.resolve({
              signedIn: true,
              student: true,
            });

          return fetch(`${getAuthBaseUrl()}/whoami`, {
            credentials: "include",
          })
            .then((response) => response.text())
            .then((userAsText) => (userAsText ? JSON.parse(userAsText) : null))
            .then((userData) => ({
              signedIn: Boolean(userData),
              student: Boolean(userData && userData.airtableId),
              id: userData ? userData.id : null,
              email: userData ? userData.email : null,
            }))
            .catch((error) => {});
        }

        function redirectToSignIn() {
          const signInUrl = `${getAuthBaseUrl()}/sign-in?redirect=${encodeURIComponent(
            window.location.href
          )}&reason=auth_required`;
          const redirectMessage = document.querySelector("#redirect-message");
          redirectMessage.style.display = "block";
          redirectMessage.innerHTML = `<div>You are being redirected to the sign in page. If you aren't redirected automatically, you can use <a href=${signInUrl}>this link</a>.</div>`;
          window.location = signInUrl;
        }

        function showPageContents() {
          document.querySelector("#content-wrapper").style.visibility =
            "visible";
        }

        function showUnauthorizedMessage() {
          document.querySelector("#unauthorized-message").style.display =
            "block";
        }

        function getAuthBaseUrl() {
          const domain = getDomain();
          const authBaseUrl = `https://auth.${domain}`;
          return authBaseUrl;
        }
      </script>
      <script src="/assets/js/docs.min.js"></script>
      <script>
        var MathJax = {
          tex: {
            inlineMath: [
              ["$$", "$$"],
              ["\[", "\])"],
            ],
          },
          "HTML-CSS": {
            styles: {
              ".MathJax span": {
                color: "#000000",
              },
            },
          },
        };
      </script>
      <script
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
        type="text/javascript"
      ></script>
      <script>
        handleExternalLinks();

        function handleExternalLinks() {
          const domain = getDomain();
          const links = document.querySelectorAll("a");
          return links.forEach((link) => {
            if (!link.host.includes(domain)) link.target = "_blank";
          });
        }
      </script>
    </div>
  </body>
</html>
