<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Intended as a home for Lambda School curriculum.">
  <meta name="author" content="">
  <meta name="generator" content="Jekyll v3.8.0">
  <title>Component Side Effects ¬∑ Lambda School</title>

  <link rel='stylesheet' integrity crossorigin='anonymous'
    href='https://d33wubrfki0l68.cloudfront.net/css/0f99ed215b3d52fa1bee44dc614ea3fa1d1bebc0/dist/css/bootstrap.min.css' />

  <link href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" rel="stylesheet">
  <link rel='stylesheet'
    href='https://d33wubrfki0l68.cloudfront.net/css/1bf8317b3d6d0c9d813c92505f052bf79ffdcdfe/assets/css/docs.min.css' />

  <link rel='stylesheet'
    href='https://d33wubrfki0l68.cloudfront.net/css/f3626ab7ab84821f8b60ea92b4a5c6acf59991af/assets/css/main.css' />

  <script>
    ( function ( i, s, o, g, r, a, m ) {
      i[ 'GoogleAnalyticsObject' ] = r;
      i[ r ] = i[ r ] || function () {
        ( i[ r ].q = i[ r ].q || [] ).push( arguments )
      }, i[ r ].l = 1 * new Date();
      a = s.createElement( o ),
        m = s.getElementsByTagName( o )[ 0 ];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore( a, m )
    } )( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' );
    ga( 'create', 'UA-122016605-1', 'learn.lambdaschool.com' );
    ga( 'send', 'pageview' );
  </script>

  <script>
    ! function () {
      var analytics = window.analytics = window.analytics || [];
      if ( !analytics.initialize )
        if ( analytics.invoked ) window.console && console.error && console.error( "Segment snippet included twice." );
        else {
          analytics.invoked = !0;
          analytics.methods = [ "trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset",
            "group", "track", "ready", "alias", "debug", "page", "once", "off", "on"
          ];
          analytics.factory = function ( t ) {
            return function () {
              var e = Array.prototype.slice.call( arguments );
              e.unshift( t );
              analytics.push( e );
              return analytics
            }
          };
          for ( var t = 0; t < analytics.methods.length; t++ ) {
            var e = analytics.methods[ t ];
            analytics[ e ] = analytics.factory( e )
          }
          analytics.load = function ( t, e ) {
            var n = document.createElement( "script" );
            n.type = "text/javascript";
            n.async = !0;
            n.src = "https://cdn.segment.com/analytics.js/v1/" + t + "/analytics.min.js";
            var a = document.getElementsByTagName( "script" )[ 0 ];
            a.parentNode.insertBefore( n, a );
            analytics._loadOptions = e
          };
          analytics.SNIPPET_VERSION = "4.1.0";
          analytics.load( "BjKorwKrSvMamfNoGkBq9rISk7wF6QQX" );
          analytics.page();
        }
    }();
  </script>

  <link rel="apple-touch-icon" href="/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
  <link rel="icon" href="/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
  <link rel="icon" href="/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
  <link rel="manifest" href="/assets/img/favicons/manifest.json">
  <link rel="mask-icon" href="/assets/img/favicons/safari-pinned-tab.svg" color="#a0001e">
  <link rel="icon" href="/favicon.ico">
  <meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
  <meta name="theme-color" content="#a0001e">
</head>

<body>
  <noscript>Please enable JavaScript to view this page.</noscript>
  <div id="redirect-message" style="display: none;">
    You must be logged in to view this page.
  </div>
  <div id="unauthorized-message" style="display: none;">
    You must be a Lambda School student to view this page.
  </div>
  <div id="content-wrapper">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
      <div class="container">
        <span class="skiplink-text">Skip to main content</span>
      </div>
    </a>
    <div class="mobile-menu">
      <div class="m-drop">
        <div class="mobile-row">
          <div class="header-row" style="padding: 3px 7px">
            <a class="navbar-brand" href="/" aria-label="Lambda School"><svg xmlns="http://www.w3.org/2000/svg"
                width="33" height="35" viewBox="0 0 33 35" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M0 0V16.0609C0 27.7335 9.08929 31.7843 15.7321 34.7513H15.75L16.2857 35C16.4107 34.9289 16.5357 34.8756 16.6786 34.8223C16.75 34.7868 16.8393 34.7513 16.9107 34.7157C23.5714 31.7665 32.6964 27.698 32.6964 16.0609V0H0ZM20.7071 23.4536L20.3571 22.5102L15.6071 10.0736C15.3214 10.802 14.6607 12.5609 13.9464 14.4442L11.2143 21.7817C11.0893 22.1371 11.1607 22.3147 11.25 22.4391C11.4464 22.6701 11.8768 22.6701 12.5554 22.6701H12.6786L12.6768 23.4518H7.56964V22.6701H7.9625C8.65893 22.6701 9.23036 22.368 9.65893 21.5152L10.1768 20.3426L14.9089 8.29696L14.0696 6.07614H18.4804L24.5696 22.0127L25.125 23.4536H20.7071Z"
                  fill="#EC3944" />
              </svg></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mobile-course-menu"
              aria-controls="mobile-course-menu" aria-expanded="false" aria-label="Toggle navigation">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false">
                <title>Menu</title>
                <path stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10"
                  d="M4 7h22M4 15h22M4 23h22"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="nav-row">
          <div class="results-container">
            <ul id="results-container" class="dropdown list-group"></ul>
          </div>
          <div id="mobile-course-menu" class="collapse nav-row">
            <div class="docs-mobile-sidebar" id="bd-docs-nav-mobile">
              <nav class="bd-links">
                <div class="bd-toc-item">
                  <h4 class="bd-toc-link">Web Applications I</h4>
                </div>

                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web2/sprint/recPSZMPrmESUYo2C">
                    1.&nbsp;&nbsp;Applied JavaScript
                  </a>
                  <ul class="nav bd-sidenav">

                    <li>
                      <a href="/web2/module/rectn5PUU5ubcQkPu/">
                        DOM I
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/recJWv3RIfa4NFXbn/">
                        DOM II
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/rec847sNXZX9CVDNl/">
                        Components I
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/recd6kDKS6eMapSRq/">
                        Components II
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web2/sprint/recYL2HDPPpkDmGEm">
                    2.&nbsp;&nbsp;Intro to React
                  </a>
                  <ul class="nav bd-sidenav">

                    <li>
                      <a href="/web2/module/recZau7hH8vzww14N/">
                        React Components and Component State
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/recgzSGQtp2HYwgSR/">
                        Composing React Components and Passing Data Via Props
                      </a>
                    </li>
                    <li class="active bd-sidenav-active">
                      <a href="/web2/module/recKe8PW6ZMwjL1Qg/">
                        Component Side Effects
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/recNDoSqyUw3eq1y3/">
                        Advanced Styling Techniques
                      </a>
                    </li>
                  </ul>
                </div>

                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web2/sprint/recH2pYM3qVavZTRN">
                    3.&nbsp;&nbsp;Single Page Applications
                  </a>
                  <ul class="nav bd-sidenav">

                    <li>
                      <a href="/web2/module/recd7jGy7tfVkcFlX/">
                        React Router
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/rect081xiYT2cfxGF/">
                        Form Management
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/recKK5C7wV0WiECfr/">
                        Advanced Form Management
                      </a>
                    </li>
                    <li>
                      <a href="/web2/module/recduYpjgZBQaQM8X/">
                        cypress.io
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="bd-toc-item ">
                  <a class="bd-toc-link" href="/web2/sprint/recwKyMueNtoTTmUD">
                    4.&nbsp;&nbsp;WEB Unit 2 Build
                  </a>
                  <ul class="nav bd-sidenav">

                  </ul>
                </div>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="main-container">
      <div class="sidebar-container bd-sidebar">
        <div class="docs-sidebar">
          <a class="navbar-brand" href="/" aria-label="Lambda School"><svg width="135" height="35" viewBox="0 0 756 197"
              fill="#ec3944">
              <g>
                <path
                  d="M292.9,126.6h-6.7c-9,0-12.6-1.9-12.6-9.5V48.5c0-7.7,1.6-8.6,11.4-9.7v-4.5h-41.3v4.5 c9.8,1.1,11.4,1.9,11.4,9.7v69.3c0,7.7-1.6,8.6-11.4,9.7v4.5h73.7l4.9-29.4h-4.4C308.5,119.6,303.9,126.6,292.9,126.6z">
                </path>
                <path
                  d="M385.5,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1l0.1-0.1l0,0V132h26v-4.4C387.7,127.1,385.5,126.2,385.5,121.1z M368,117.8 c-4.4,3.3-7.6,5.3-12,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4V117.8L368,117.8z">
                </path>
                <path
                  d="M514.4,121V79.5c0-14.8-6-22.4-18.7-22.4c-11.5,0-19.4,6.6-25.5,13.9c-1.8-9.6-7.7-13.9-17.8-13.9 c-11.4,0-18.7,6.2-24.8,13.6V57h-2.3l-23.8,7.4v2.4l8.6,5v49.4c0,5-2.1,6.1-8.9,6.4v4.4h35.1v-4.4c-6.7-0.3-8.7-1.3-8.7-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7v40.8c0,5-1.9,6.1-8.7,6.4v4.4l34.8,0v-4.4c-6.7-0.3-8.6-1.3-8.6-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7l-0.1,40.5c0,5-1.8,6.4-8.6,6.7l0,4.4h35.1v-4.4 C516.7,127.4,514.4,126.1,514.4,121z">
                </path>
                <path
                  d="M573.2,57.3c-11,0-18.5,5.7-23.4,12.8V22.9h-2.7l-23.4,6.8v2.5l8.6,4.5V132h2.9l8-3.5c5.8,3.3,12.3,5,20.2,5 c20.8,0,37.4-15.8,37.4-42.6C600.9,69.9,590.4,57.3,573.2,57.3z M563.4,128.7c-5.4,0-10.3-2.4-13.7-7.9V73.6 c3.4-3.4,8.5-5.7,13.5-5.7c13.9,0,20,12.8,20,29.5C583.3,114.7,575.8,128.5,563.4,128.7z">
                </path>
                <path
                  d="M677,121.2V22.8h-2.6L651,29.6V32l8.6,4.5v25.7c-3.4-3.2-8.8-5.1-15.5-5.1c-19.9,0-35.2,15.3-35.2,41.3 c0,20.7,11.2,34.6,28.1,34.6c9.8,0,17-5.3,22.6-13.1v0.9V132h26.3l0-4.4C679.1,127.3,677,126.3,677,121.2z M659.6,117.1 L659.6,117.1c-3.4,3.4-8,5.1-13.2,5.1c-13.2,0-20.4-12.8-20.4-29.8c0-17.8,7.3-29.2,19.5-29.2c8.7,0,14.1,6.9,14.1,18.3 L659.6,117.1z">
                </path>
                <path
                  d="M747.1,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1v-0.1h0.1l0,11.1l26,0.1v-4.5C749.3,127.1,747.1,126.2,747.1,121.1z M729.6,117.8c-4.4,3.3-7.6,5.3-12.1,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4L729.6,117.8L729.6,117.8z">
                </path>
              </g>
              <path
                d="M0,0v90.4c0,65.7,50.9,88.5,88.1,105.2h0.1l3,1.4c0.7-0.4,1.4-0.7,2.2-1c0.4-0.2,0.9-0.4,1.3-0.6 c37.3-16.6,88.4-39.5,88.4-105V0H0z M116,132l-2-5.3l-26.6-70c-1.6,4.1-5.3,14-9.3,24.6l-15.3,41.3c-0.7,2-0.3,3,0.2,3.7 c1.1,1.3,3.5,1.3,7.3,1.3H71l0,4.4H42.4l0-4.4h2.2c3.9,0,7.1-1.7,9.5-6.5l2.9-6.6l26.5-67.8l-4.7-12.5h24.7l34.1,89.7l3.1,8.1H116z">
              </path>
            </svg></a>
          <ul id="results-container" class="dropdown list-group"></ul>
          <nav class="bd-links collapse" id="bd-docs-nav">
            <div class="bd-toc-item">
              <h4 class="bd-toc-link">Web Applications I</h4>
            </div>

            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web2/sprint/recPSZMPrmESUYo2C">
                1.&nbsp;&nbsp;Applied JavaScript
              </a>
              <ul class="nav bd-sidenav">

                <li>
                  <a href="/web2/module/rectn5PUU5ubcQkPu/">
                    DOM I
                  </a>
                </li>
                <li>
                  <a href="/web2/module/recJWv3RIfa4NFXbn/">
                    DOM II
                  </a>
                </li>
                <li>
                  <a href="/web2/module/rec847sNXZX9CVDNl/">
                    Components I
                  </a>
                </li>
                <li>
                  <a href="/web2/module/recd6kDKS6eMapSRq/">
                    Components II
                  </a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web2/sprint/recYL2HDPPpkDmGEm">
                2.&nbsp;&nbsp;Intro to React
              </a>
              <ul class="nav bd-sidenav">

                <li>
                  <a href="/web2/module/recZau7hH8vzww14N/">
                    React Components and Component State
                  </a>
                </li>
                <li>
                  <a href="/web2/module/recgzSGQtp2HYwgSR/">
                    Composing React Components and Passing Data Via Props
                  </a>
                </li>
                <li class="active bd-sidenav-active">
                  <a href="/web2/module/recKe8PW6ZMwjL1Qg/">
                    Component Side Effects
                  </a>
                </li>
                <li>
                  <a href="/web2/module/recNDoSqyUw3eq1y3/">
                    Advanced Styling Techniques
                  </a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web2/sprint/recH2pYM3qVavZTRN">
                3.&nbsp;&nbsp;Single Page Applications
              </a>
              <ul class="nav bd-sidenav">

                <li>
                  <a href="/web2/module/recd7jGy7tfVkcFlX/">
                    React Router
                  </a>
                </li>
                <li>
                  <a href="/web2/module/rect081xiYT2cfxGF/">
                    Form Management
                  </a>
                </li>
                <li>
                  <a href="/web2/module/recKK5C7wV0WiECfr/">
                    Advanced Form Management
                  </a>
                </li>
                <li>
                  <a href="/web2/module/recduYpjgZBQaQM8X/">
                    cypress.io
                  </a>
                </li>
              </ul>
            </div>
            <div class="bd-toc-item ">
              <a class="bd-toc-link" href="/web2/sprint/recwKyMueNtoTTmUD">
                4.&nbsp;&nbsp;WEB Unit 2 Build
              </a>
              <ul class="nav bd-sidenav">

              </ul>
            </div>
          </nav>
        </div>
      </div>
      <main class="content-container flex-wrapper" role="main">
        <div class="sticky-nav">
          <div class="sprint-nav">
            <ul class="section-nav">
              <li class="toc-entry toc-h2"><a href="#prepare">Prepare</a></li>
              <li class="toc-entry toc-h2"><a href="#learn">Learn</a></li>
              <li class="toc-entry toc-h2"><a href="#project">Project</a></li>
              <li class="toc-entry toc-h2"><a href="#review">Review</a></li>
            </ul>
          </div>

        </div>
        <div class="wrapper limit-width">
          <div class="flex-wrapper">
            <div class="limit-width">
              <div class="jumbotron">
                <h1 class="bd-title" id="content">Component Side Effects</h1>
                <span class="lead">
                  <p class="bd-lead"></p>
                  <p>Side effects in web apps are very common. It‚Äôs important to understand what side effects are so we
                    can handle them properly in our components.</p>
                </span>
                <strong>At the end of this module, you should be able to:</strong>
                <ul>
                  <li>explain what side effects are in React components</li>
                  <li>demonstrate how to sync side effects with state and props using the effect hook</li>
                  <li>fetch data from an API using the effect hook</li>
                  <li>demonstrate how to clean up side effects in the effect hook</li>
                </ul>
              </div>
              <div class="alert alert-warning" role="alert">
                <h4>Pro Tip</h4>
              </div>
              <h2 class="display-4">
                <a id="prepare" class="anchor" href="#prepare" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Prepare</h2>
              <p class="lead">Review each preclass resource before class.</p>
              <div class="preclass">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">
                    <div class="embed-responsive embed-responsive-16by9">
                      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/M5yZxpyub48"
                        frameborder="0" allowfullscreen></iframe>
                    </div>
                  </li>
                  <li class="list-group-item">
                    <div class="embed-responsive embed-responsive-16by9">
                      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/7oCm8Ih-ZCA"
                        frameborder="0" allowfullscreen></iframe>
                    </div>
                  </li>
                  <li class="list-group-item">
                    <div class="embed-responsive embed-responsive-16by9">
                      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/jMa1nnILdNM"
                        frameborder="0" allowfullscreen></iframe>
                    </div>
                  </li>
                  <li class="list-group-item">
                    <div class="embed-responsive embed-responsive-16by9">
                      <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/rCtq5zvWI0Y"
                        frameborder="0" allowfullscreen></iframe>
                    </div>
                  </li>
                </ul>
              </div>
              <h2 class="display-4">
                <a id="learn" class="anchor" href="#learn" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Learn</h2>
              <h4 class="mark mb-3 p-2">Learn to explain what side effects are in React components</h4>
              <p>Side effects in web apps are very common. It‚Äôs important to understand what side effects are so we can
                handle them properly in our components.</p>
              <h5>Overview</h5>
              <p>What are ‚Äúside effects‚Äù? A side effect is anything that affects something outside the scope of the
                function being executed. Fetching data from an API, timers, logging, and manually manipulating the DOM
                are all examples of side effects. There are two categories of side effects in React components - those
                that don‚Äôt require cleanup and those that do require cleanup. We will discuss effects which require
                cleanup later in this module.</p>
              <p>A React component without side effects is called a pure component. A component is considered pure if it
                always renders the same output for the same state and props. Similarly, a side effect is something that
                can cause a component to return a different output for the same state and props. Pure components don‚Äôt
                have any side effects. React offers us tools for managing side effects so we can avoid bugs and
                inconsistencies in our app. The effect hook (<code class="highlighter-rouge">useEffect()</code>) is one
                of those.</p>
              <h3 id="the-effect-hook">The Effect Hook</h3>
              <p>The effect hook tells React that a component needs to run, or execute, some side effect. This hook
                takes in two parameters. The first is a callback function where we can run the side effect. Let‚Äôs take a
                look at an effect hook that is handling a <code class="highlighter-rouge">console.log</code> side
                effect:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello from the effect hook!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>Used inside the component, puts the effect function inside the component‚Äôs function scope. This gives
                it access to state, props, and local variables. So we could also do something like this:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">someProp</span><span class="p">,</span> <span class="nx">stateValueOne</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>Here are some basic examples of other common side effects we might see in React Components:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="c1">// Making API calls</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">user</span><span class="p">,</span> <span class="nx">setUser</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">error</span><span class="p">,</span> <span class="nx">setError</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">fetchUserData</span><span class="p">(</span><span class="nx">userId</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setUser</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">))</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">setError</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">message</span><span class="p">));</span>
<span class="p">});</span>

<span class="c1">// Manipulating the DOM</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">count</span><span class="p">,</span> <span class="nx">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s2">`Count is: </span><span class="p">${</span><span class="nx">count</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">The component has mounted.</span><span class="dl">"</span><span class="p">);</span>
<span class="p">},</span> <span class="p">[]);</span>
</code></pre>
                </div>
              </div>
              <hr>
              <h4 class="mark mb-3 p-2">Learn to demonstrate how to sync side effects with state and props using the
                effect hook</h4>
              <p>There are many times when we may only want a side effect to run when certain data changes. Learning how
                to sync the effect hook with changes in our state or props is essential to handling side effects in the
                most efficient manner.</p>
              <h5>Overview</h5>
              <p>In the examples we saw above, the effect hooks used were not synced with any particular pieces of data.
                Because of that, each of those hooks would run every single time a piece of state or a prop changed.
                With a lot of side effects, this would be somewhat concerning from a performance standpoint. Or, in the
                worst-case scenarios, where a side effect causes the state to change, we would find ourselves in an
                infinite loop and eventually crash our browser üò≥.</p>
              <p>Luckily we can sync our side effects with state and props changes. We do this by passing in a
                dependency array as the second argument to the effect hook. Note that this argument is optional. If we
                don‚Äôt pass in an array after the callback function, the effect will fire after every change. Let‚Äôs take
                a look at a data fetch that sets state in our component.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="p">[</span><span class="nx">user</span><span class="p">,</span> <span class="nx">setUser</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">error</span><span class="p">,</span> <span class="nx">setError</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">fetchUserData</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">userId</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setUser</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">))</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">setError</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">message</span><span class="p">));</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>When this effect fires, it calls either <code class="highlighter-rouge">setUser</code> or <code
                  class="highlighter-rouge">setError</code>. That means that one of those pieces of state will change,
                which would, in turn, cause the effect to fire again, causing the state to change, firing the effect
                again, and placing us in an infinite loop!</p>
              <p>If you look closely at the effect hook, you‚Äôll notice that this effect also relies on another piece of
                data. That is <code class="highlighter-rouge">props.userId</code>. As we think about the component that
                this hook would be in, we can imagine that we only want this effect to fire if that <code
                  class="highlighter-rouge">userId</code> prop changes, right? We definitely don‚Äôt want it to fire if
                <code class="highlighter-rouge">user</code> or <code class="highlighter-rouge">error</code> change! So,
                that means that we want this effect to sync up with <code class="highlighter-rouge">props.userId</code>
                only - nothing else. Let‚Äôs go ahead and add a dependency array argument with that particular dependency
                in the array.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="p">[</span><span class="nx">user</span><span class="p">,</span> <span class="nx">setUser</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">error</span><span class="p">,</span> <span class="nx">setError</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">fetchUserData</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">userId</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setUser</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">user</span><span class="p">))</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">setError</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">message</span><span class="p">));</span>
<span class="p">},</span> <span class="p">[</span><span class="nx">props</span><span class="p">.</span><span class="nx">userId</span><span class="p">]);</span> <span class="c1">// Dependency array added</span>
</code></pre>
                </div>
              </div>
              <p>Now this effect will fire when and only when <code class="highlighter-rouge">props.userId</code>
                changes!</p>
              <p>But wait, wouldn‚Äôt we want this effect to fire when the component first mounts? Yes, definitely. Even
                with a dependency array added to the effect hook, it will fire when the component mounts, and then only
                fire when the given dependencies change.</p>
              <p>This brings up one last thought. How can we add an effect to our component that we only want to fire
                off once as the component mounts, and not any other times during the life of the component? Essentially,
                we would want to tell the effect hook to not synchronize that particular effect with any state/props
                changes, right? We can solve this by adding the dependency array to the effect hook, but leaving it
                blank. Let‚Äôs set up an effect hook that runs a data fetch side effect that we don‚Äôt want to sync with
                any state/props changes.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="kd">const</span> <span class="p">[</span><span class="nx">error</span><span class="p">,</span> <span class="nx">setError</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
<span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">getInitialData</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setData</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">))</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">setError</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">response</span><span class="p">));</span>
<span class="p">},</span> <span class="p">[]);</span>
</code></pre>
                </div>
              </div>
              <h3 id="summary">Summary</h3>
              <p>Using a dependency array as the second argument in the effect hook, we can tell it with which state or
                props the effect should be synced. This is a handy guide to use as you begin the build the mental model
                for this principle:</p>
              <blockquote>
                <p>‚Ä¶ the question is ‚Äúwith which state and props does this effect synchronize with‚Äù</p>
              </blockquote>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">useEffect</span><span class="p">(</span><span class="nx">fn</span><span class="p">);</span> <span class="c1">// all state and props</span>
<span class="nx">useEffect</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="p">[]);</span> <span class="c1">// no state or props</span>
<span class="nx">useEffect</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="p">[</span><span class="nx">these</span><span class="p">,</span> <span class="nx">states</span><span class="p">,</span> <span class="nx">props</span><span class="p">]);</span>
</code></pre>
                </div>
              </div>
              <hr>
              <h4 class="mark mb-3 p-2">Learn to fetch data from an API using the effect hook</h4>
              <p>A common use case for the Effect Hook is fetching data. Fetching data from an API depends on the API as
                an external resource, and so it is a side effect. Because of this, we put our axios call inside the
                effect function.</p>
              <h5>Overview</h5>
              <p>Now that we know how to sync effects with data, and we know how to avoid infinite loops, let‚Äôs take a
                more in-depth look at fetching data using an effect hook. There are a couple of possible situations we
                want to look at when fetching data in a component. First is writing an effect that is not synced with
                any state or props so that it only fetches data once as the component mounts. Next, is writing an effect
                that makes an API call that could fire again during the life of the component, depending on a piece of
                state or a prop.</p>
              <h5>Follow Along</h5>
              <h4 id="fetching-data-when-a-component-mounts">Fetching Data when a Component Mounts</h4>
              <p>Let‚Äôs fetch a random dog image to render when this component mounts. We‚Äôll do this using the ‚Äúdogs‚Äù
                API. Open a new sandbox and follow along.</p>
              <p>The first thing we‚Äôll do is get our <code class="highlighter-rouge">App</code> component ready with
                some state and the proper JSX:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Initialize state to hold the image URL</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">dogPic</span><span class="p">,</span> <span class="nx">setDogPic</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">""</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">App</span><span class="dl">"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">We</span> <span class="nx">Love</span> <span class="nx">Puppers</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dogPic</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="dl">"</span><span class="s2">a random dog</span><span class="dl">"</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>Next, we‚Äôll add the effect hook (minus the data fetch logic) with an empty dependency array.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Initialize state to hold the image URL</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">dogPic</span><span class="p">,</span> <span class="nx">setDogPic</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">""</span><span class="p">);</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{},</span> <span class="p">[]);</span> <span class="c1">// Not synced with any data, so this effect only fires once</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">App</span><span class="dl">"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">We</span> <span class="nx">Love</span> <span class="nx">Puppers</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dogPic</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="dl">"</span><span class="s2">a random dog</span><span class="dl">"</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>Now we can add the fetch logic. We‚Äôll use Axios here as we‚Äôve previously learned.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Initialize state to hold the image URL</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">dogPic</span><span class="p">,</span> <span class="nx">setDogPic</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">""</span><span class="p">);</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// This axios GET request will return a single image</span>
    <span class="nx">axios</span>
      <span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://dog.ceo/api/breeds/image/random</span><span class="dl">"</span><span class="p">)</span>
      <span class="c1">// Which we then set to state</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setDogPic</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span>
      <span class="c1">// Always include error handling</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">));</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">App</span><span class="dl">"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">We</span> <span class="nx">Love</span> <span class="nx">Puppers</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">dogPic</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="dl">"</span><span class="s2">a random dog</span><span class="dl">"</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>See a working example of the completed example <a
                  href="https://codesandbox.io/s/affectionate-chaplygin-9p27c">here</a>.</p>
              <h3 id="fetching-data-multiple-times-with-synced-effect-hooks">Fetching Data Multiple Times with Synced
                Effect Hooks</h3>
              <p>Often, we will want to make the same fetch call multiple times during the life of a component, all
                based on when certain data changes. It can be tempting to write a function outside of the effect hook
                that calls an API, then call that function from the effect hook during the mounting stage, and then
                subsequently call it from a handler function later. Like this:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code>  <span class="kd">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">query</span><span class="p">,</span> <span class="nx">setQuery</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">);</span>

  <span class="c1">// This effect will only fire once when the component mounts</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">fetchData</span><span class="p">();</span> <span class="c1">// calls an external function that is dependent on state or props ‚ö†Ô∏è</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="c1">// external function that relies on (or is dependent on) query</span>
  <span class="kd">const</span> <span class="nx">fetchData</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">some/api/endpoint/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">query</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setData</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">handleChange</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setQuery</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
    <span class="nx">fetchData</span><span class="p">();</span> <span class="c1">// calls same external function after setting query</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">query</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">handleChange</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>This is not safe, as the effect hook calls <code class="highlighter-rouge">fetchData</code> which
                relies on <code class="highlighter-rouge">query</code>. According to the <a
                  href="https://reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies">React
                  docs</a></p>
              <blockquote>
                <p>It‚Äôs difficult to remember which props or state are used by functions outside of the effect. This is
                  why usually you‚Äôll want to declare functions needed by an effect inside of it. Then it‚Äôs easy to see
                  what values from the component scope that effect depends on.</p>
              </blockquote>
              <p>Let‚Äôs put the <code class="highlighter-rouge">fetchData</code> function inside the effect hook, and
                sync the hook with <code class="highlighter-rouge">query</code>:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code>  <span class="kd">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">();</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">query</span><span class="p">,</span> <span class="nx">setQuery</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">);</span>

  <span class="c1">// This effect will fire when the component mounts, AND each time "query" is updated! ‚úÖ</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">fetchData</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">axios</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">some/api/endpoint/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">query</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setData</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="nx">fetchData</span><span class="p">();</span> <span class="c1">// calls an external function</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">query</span><span class="p">]);</span>


  <span class="kd">const</span> <span class="nx">handleChange</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">setQuery</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">query</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">handleChange</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">...</span>
    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>So, to examine this more closely, we will fetch data from the algolia API based on a query string typed
                into an input. Again, open a new sandbox to follow along.</p>
              <p>To start out, we will have our state and JSX ready.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="na">hits</span><span class="p">:</span> <span class="p">[]</span> <span class="p">});</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">query</span><span class="p">,</span> <span class="nx">setQuery</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">query</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">setQuery</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hits</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">objectID</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>Next, we will add the effect hook, synchronizing the hook to the <code
                  class="highlighter-rouge">query</code> state, tied into the input.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="na">hits</span><span class="p">:</span> <span class="p">[]</span> <span class="p">});</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">query</span><span class="p">,</span> <span class="nx">setQuery</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">);</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{},</span> <span class="p">[</span><span class="nx">query</span><span class="p">]);</span> <span class="c1">// when query changes, fire this effect again</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">query</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">setQuery</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hits</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">objectID</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>Finally, we will add the fetch logic.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="na">hits</span><span class="p">:</span> <span class="p">[]</span> <span class="p">});</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">query</span><span class="p">,</span> <span class="nx">setQuery</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">);</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">fetchData</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">axios</span>
        <span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://hn.algolia.com/api/v1/search?query=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">query</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">setData</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">));</span>
    <span class="p">};</span>

    <span class="nx">fetchData</span><span class="p">();</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">query</span><span class="p">]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">query</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">setQuery</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">)}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hits</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">objectID</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>        <span class="p">))}</span>
      <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre>
                </div>
              </div>
              <p>See the final sandbox <a href="https://codesandbox.io/s/xenodochial-field-h4rfd">here</a>.</p>
              <hr>
              <h4 class="mark mb-3 p-2">Learn to demonstrate how to clean up side effects in the effect hook</h4>
              <p>Network requests, manual DOM manipulations, and logging are some examples of effects that do not
                require cleanup. In other words, these effects can run and will not cause problems if the component
                mounts, unmounts, and remounts again. Other effects, however, will continue to execute, even if the
                component unmounts. Imagine that you write an effect function for a component that doesn‚Äôt get cleaned
                up, then your user navigates back and forth to the component ten times. You now have 10 effect functions
                all running the same effect over and over again. You‚Äôve increased the power and memory needed to run
                that function 10x‚Äôs! Ahhh! That does not sound good, right? It‚Äôs not! This is what we call a <em>memory
                  leak</em>.</p>
              <h5>Overview</h5>
              <p>Perhaps you‚Äôve created a subscription to a chat API to give a live chat functionality to your app. Or,
                more simply, you‚Äôve added an event listener to the DOM. These are both functions that need to be
                ‚Äúcleaned up‚Äù when the component is unmounting, so we don‚Äôt cause an unnecessary memory leak. Thankfully,
                the Effect Hook has a built-in way to handle cleanups.</p>
              <p>To clean up an effect, we return a function from the effect hook‚Äôs callback function, like this:</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// We write our desired effect as before.</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">The Effect Hook has run.</span><span class="dl">"</span><span class="p">);</span>
  <span class="c1">// Returning a function will tell React that you want this</span>
  <span class="c1">// code to run when the component unmounts or re-renders</span>
  <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">The Effect Hook has been cleaned up.</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
                </div>
              </div>
              <p>The returned function is called when the component is unmounting, giving us a place to clean up
                subscriptions and event listeners.</p>
              <h5>Follow Along</h5>
              <p>Let‚Äôs add an event listener to a function that listens for the mouse position. When the mouse moves,
                the event listener will update some state with the new mouse position, and the component will render the
                mouse position state to the DOM. Follow along in a new sandbox.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">position</span><span class="p">,</span> <span class="nx">setPosition</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">});</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{},</span> <span class="p">[]);</span> <span class="c1">// We only want to create the event listener once, so this effect will only fire when the component mounts</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="p">}:{</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
                </div>
              </div>
              <p>Now add the event listener with the event listener‚Äôs callback function.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">position</span><span class="p">,</span> <span class="nx">setPosition</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">});</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Add an event listener</span>
    <span class="kd">const</span> <span class="nx">setFromEvent</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">setPosition</span><span class="p">({</span> <span class="na">x</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span> <span class="p">});</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">mousemove</span><span class="dl">"</span><span class="p">,</span> <span class="nx">setFromEvent</span><span class="p">);</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="p">}:{</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
                </div>
              </div>
              <p>Finally, return a function from the effect hook to clean up the event listener.</p>
              <div class="language-js highlighter-rouge">
                <div class="highlight">
                  <pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">position</span><span class="p">,</span> <span class="nx">setPosition</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">});</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">setFromEvent</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">setPosition</span><span class="p">({</span> <span class="na">x</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clientY</span> <span class="p">});</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">mousemove</span><span class="dl">"</span><span class="p">,</span> <span class="nx">setFromEvent</span><span class="p">);</span>

    <span class="c1">// the function returned here will remove, or "clean up", the event listener</span>
    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">mousemove</span><span class="dl">"</span><span class="p">,</span> <span class="nx">setFromEvent</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="p">}:{</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">};</span>
</code></pre>
                </div>
              </div>
              <p>See a working example of the completed example <a
                  href="https://codesandbox.io/s/long-hill-fg79j">here</a>.</p>
              <h5>Challenge</h5>
              <p>Try this out again, but this time with the <code class="highlighter-rouge">resize</code> event
                listener. That listener will listen for the browser to change size. So if you set your state with <code
                  class="highlighter-rouge">window.innerHeight</code> and <code
                  class="highlighter-rouge">window.innerWidth</code>, then listen for the resizing event to happen and
                update your state with those same properties, you should be able to render the browser size
                continuously.</p>
              <hr>
              <h2 class="display-4">
                <a id="project" class="anchor" href="#project" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Project</h2>
              <ul class="list-group">
                <li class="list-group-item">
                  <h5><a target="_blank" href="https://github.com/LambdaSchool/nasa-photo-of-the-day">NASA Photo of the
                      Day</a></h5>
                  <p>Build an app that consumes the NASA API to fetch the Astronomy Photo of the Day. Display the photo
                    and other info on the DOM.</p>
                </li>
              </ul>
              <h2 class="display-4">
                <a id="review" class="anchor" href="#review" aria-hidden="true"><span
                    class="octicon octicon-link"></span></a>Review</h2>
              <h3 class="display-5">Class Recordings</h3>
              <p class="lead">You can use class recordings to help you master the material.</p>
              <div>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">
                    <strong><a target="_blank" href="https://youtu.be/T2wgHRkHa6k">Components Side Effects for WebPT22
                        w/Ben Schinn</a></strong>
                    <p>Side effects in web apps are very common. It‚Äôs important to understand what side effects are so
                      we can handle them properly in our components.</p>
                  </li>
                  <li class="list-group-item">
                    <a href="/archive/FSW/module/recKe8PW6ZMwjL1Qg">All previous recordings</a>
                  </li>
                </ul>
              </div>
              <h3 class="display-5">Demonstrate Mastery</h3>
              <p>To demonstrate mastery of this module, you need to complete and pass a code review on each of the
                following:</p>
              <ul>
                <li>Objective challenge: <p>Try this out again, but this time with the <code
                      class="highlighter-rouge">resize</code> event listener. That listener will listen for the browser
                    to change size. So if you set your state with <code
                      class="highlighter-rouge">window.innerHeight</code> and <code
                      class="highlighter-rouge">window.innerWidth</code>, then listen for the resizing event to happen
                    and update your state with those same properties, you should be able to render the browser size
                    continuously.</p>
                </li>
                <li>Project: NASA Photo of the Day</li>
              </ul>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-80850900-4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push( arguments );
      }
      gtag( 'js', new Date() );

      gtag( 'config', 'UA-80850900-4' );
    </script>
    <script type="text/javascript">
      function getDomain() {
        const domainName = window.location.hostname.split( '.' )[ 1 ];
        return `${domainName}.com`;
      }
    </script>
    <script src="" integrity="" crossorigin="anonymous"></script>
    <script>
      window.jQuery || document.write( '<script src="/assets/js/vendor/jquery-slim.min.js"><\/script>' )
    </script>
    <script src="/assets/js/vendor/popper.min.js" integrity="" crossorigin="anonymous"></script>
    <script src="/dist/js/bootstrap.min.js" integrity="" crossorigin="anonymous"></script>
    <script src="/assets/js/activate.js"></script>
    <script src="/assets/js/jekyll-search.js" type="text/javascript"></script>
    <script type="text/javascript">
      SimpleJekyllSearch.init( {
        searchInput: document.getElementById( 'search-input' ),
        resultsContainer: document.getElementById( 'results-container' ),
        dataSource: '/search.json',
        searchResultTemplate: '<li class="list-group-item"><a href="{url}" title="Component Side Effects">{title}</a></li>',
        noResultsText: '',
        limit: 10,
        fuzzy: true,
      } )
    </script>
    <script src="/assets/js/mermaid.min.js"></script>
    <script type="text/javascript">
      if ( window.attachEvent ) {
        window.attachEvent( 'onload', verifySignedIn );
      } else {
        if ( window.onload ) {
          var currentOnLoadFn = window.onload;
          var newOnLoadFn = function ( evt ) {
            currentOnLoadFn( evt );
            verifySignedIn();
          };
          window.onload = newOnLoadFn;
        } else {
          window.onload = verifySignedIn;
        }
      }

      function verifySignedIn() {
        if ( isPagePublic() ) {
          return showPageContents();
        }

        window.__user = null;
        isSignedIn().then( ( user ) => {
          window.__user = user;

          if ( !user.signedIn ) {
            redirectToSignIn();
          } else if ( !user.student && !window.__openToAdmissions ) {
            showUnauthorizedMessage();
          } else {
            showPageContents();
          }
        } );
      }

      function isPagePublic() {
        const openCourses = [
          'and-pre',
          'ds-pre',
          'fsw-pre',
          'help',
          'ios-pre',
        ];

        const openPages = [
          'cs-and',
          'cs-fsw',
          'cs-ios',
          'cr',
          'ds',
          'jx',
          'p4s',
          'ux',
        ];

        const pathParts = window.location.pathname.split( '/' );
        const courseName = pathParts[ 1 ];
        const pageName = pathParts[ pathParts.length - 1 ];

        return openCourses.includes( courseName ) || openPages.includes( pageName );
      }

      function isSignedIn() {
        const isDeployPreview = window.location.hostname.startsWith( 'deploy-preview' ) && window.location.hostname
          .endsWith( 'netlify.com' );

        if ( isDeployPreview ) return Promise.resolve( {
          signedIn: true,
          student: true
        } );

        return fetch( `${getAuthBaseUrl()}/whoami`, {
            credentials: 'include'
          } )
          .then( ( response ) => response.text() )
          .then( ( userAsText ) => userAsText ? JSON.parse( userAsText ) : null )
          .then( ( userData ) => ( {
            signedIn: Boolean( userData ),
            student: Boolean( userData && userData.airtableId ),
            id: userData ? userData.id : null,
            email: userData ? userData.email : null
          } ) )
          .catch( ( error ) => {} );
      }

      function redirectToSignIn() {
        const signInUrl =
          `${getAuthBaseUrl()}/sign-in?redirect=${encodeURIComponent(window.location.href)}&reason=auth_required`
        const redirectMessage = document.querySelector( '#redirect-message' );
        redirectMessage.style.display = "block";
        redirectMessage.innerHTML =
          `<div>You are being redirected to the sign in page. If you aren't redirected automatically, you can use <a href=${signInUrl}>this link</a>.</div>`
        window.location = signInUrl;
      }

      function showPageContents() {
        document.querySelector( '#content-wrapper' ).style.visibility = 'visible';
      }

      function showUnauthorizedMessage() {
        document.querySelector( '#unauthorized-message' ).style.display = 'block';
      }

      function getAuthBaseUrl() {
        const domain = getDomain();
        const authBaseUrl = `https://auth.${domain}`;
        return authBaseUrl;
      }
    </script>
    <script src="/assets/js/docs.min.js"></script>
    <script>
      var MathJax = {
        tex: {
          inlineMath: [
            [ '$$', '$$' ],
            [ '\[', '\])' ]
          ]
        },
        "HTML-CSS": {
          styles: {
            ".MathJax span": {
              color: "#000000"
            }
          }
        }
      }
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
    </script>
    <script>
      handleExternalLinks();

      function handleExternalLinks() {
        const domain = getDomain();
        const links = document.querySelectorAll( 'a' );
        return links.forEach( ( link ) => {
          if ( !link.host.includes( domain ) ) link.target = '_blank';
        } )
      };
    </script>
  </div>
</body>

</html>
