

<a href="#content" id="skippy" class="sr-only sr-only-focusable"></a>

<span class="skiplink-text">Skip to main content</span>

<a href="/" class="navbar-brand"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMyIgaGVpZ2h0PSIzNSIgdmlld2JveD0iMCAwIDMzIDM1IiBmaWxsPSJub25lIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wIDBWMTYuMDYwOUMwIDI3LjczMzUgOS4wODkyOSAzMS43ODQzIDE1LjczMjEgMzQuNzUxM0gxNS43NUwxNi4yODU3IDM1QzE2LjQxMDcgMzQuOTI4OSAxNi41MzU3IDM0Ljg3NTYgMTYuNjc4NiAzNC44MjIzQzE2Ljc1IDM0Ljc4NjggMTYuODM5MyAzNC43NTEzIDE2LjkxMDcgMzQuNzE1N0MyMy41NzE0IDMxLjc2NjUgMzIuNjk2NCAyNy42OTggMzIuNjk2NCAxNi4wNjA5VjBIMFpNMjAuNzA3MSAyMy40NTM2TDIwLjM1NzEgMjIuNTEwMkwxNS42MDcxIDEwLjA3MzZDMTUuMzIxNCAxMC44MDIgMTQuNjYwNyAxMi41NjA5IDEzLjk0NjQgMTQuNDQ0MkwxMS4yMTQzIDIxLjc4MTdDMTEuMDg5MyAyMi4xMzcxIDExLjE2MDcgMjIuMzE0NyAxMS4yNSAyMi40MzkxQzExLjQ0NjQgMjIuNjcwMSAxMS44NzY4IDIyLjY3MDEgMTIuNTU1NCAyMi42NzAxSDEyLjY3ODZMMTIuNjc2OCAyMy40NTE4SDcuNTY5NjRWMjIuNjcwMUg3Ljk2MjVDOC42NTg5MyAyMi42NzAxIDkuMjMwMzYgMjIuMzY4IDkuNjU4OTMgMjEuNTE1MkwxMC4xNzY4IDIwLjM0MjZMMTQuOTA4OSA4LjI5Njk2TDE0LjA2OTYgNi4wNzYxNEgxOC40ODA0TDI0LjU2OTYgMjIuMDEyN0wyNS4xMjUgMjMuNDUzNkgyMC43MDcxWiIgZmlsbD0iI0VDMzk0NCI+PC9wYXRoPgo8L3N2Zz4=" /></a>

![](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdib3g9IjAgMCAzMCAzMCIgd2lkdGg9IjMwIiBoZWlnaHQ9IjMwIiBmb2N1c2FibGU9ImZhbHNlIj48dGl0bGU+TWVudTwvdGl0bGU+PHBhdGggc3Ryb2tlPSIjZmZmZmZmIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNNCA3aDIyTTQgMTVoMjJNNCAyM2gyMiI+PC9wYXRoPjwvc3ZnPg==)

#### Web API: Java

<a href="/web4java/sprint/recnLDyTtONLTMiFJ" class="bd-toc-link">1.  Java Precourse Information</a>

-   [Welcome to Java Spring](/web4java/module/recfnUAvFbeyIAHib/)
-   [Java Spring Course Table of Contents](/web4java/module/recjH0lMflsFIVzDM/)

<a href="/web4java/sprint/recoJ4ZqNQWX3cy6E" class="bd-toc-link">2.  Java Fundamentals</a>

-   [Java - JDK and Java Classes](/web4java/module/recAGVTYNZyJbEFpu/)
-   [Java Interfaces, Abstract Classes, Lambda Expression](/web4java/module/rec6Hrk77HupYeoN5/)
-   [Java - RDBMS and SQL Basics](/web4java/module/recyJ663TrxVgpqY9/)
-   [Java - Intro to Maven, Spring, and Tomcat Using REST API](/web4java/module/recqtftA9E98qpbak/)

<a href="/web4java/sprint/recRVUSWQEtosl0Cz" class="bd-toc-link">3.  RDBMS and Intro to APIs</a>

-   [Java - Spring Database Creation Including Seed Data](/web4java/module/recb0OVmRrJzqhH4D/)
-   [Java - Read Data using CRUD Operations](/web4java/module/rec3THcdjv8BumGCt/)
-   [Java - Inserting Deleting and Updating Data using CRUD Operations](/web4java/module/recJihkiNn2KH2nEW/)
-   [Java - Data Modeling and Auditing Fields with custom querying](/web4java/module/rec2oQCFWOVShtxIx/)

<a href="/web4java/sprint/recSqm5AAEkJcIl3p" class="bd-toc-link">4.  Java Frameworks</a>

-   [Java - Exception Handling](/web4java/module/rec3E1WYDyoiEF1e3/)
-   [Java - User Authentication](/web4java/module/rececDV2OMIUcY2eH/)
-   [Java - Automated Testing](/web4java/module/recDboXln5wm4aKJt/)
-   [Java - Java Deployment and Best Practices](/web4java/module/rec7pCiBPzI4DkAJT/)

<a href="/web4java/sprint/recC5dhR9menaROwx" class="bd-toc-link">5.  WEB Unit 4 Java Build</a>

------------------------------------------------------------------------

<a href="/" class="navbar-brand"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM1IiBoZWlnaHQ9IjM1IiB2aWV3Ym94PSIwIDAgNzU2IDE5NyIgZmlsbD0iI2VjMzk0NCI+PGc+PHBhdGggZD0iTTI5Mi45LDEyNi42aC02LjdjLTksMC0xMi42LTEuOS0xMi42LTkuNVY0OC41YzAtNy43LDEuNi04LjYsMTEuNC05Ljd2LTQuNWgtNDEuM3Y0LjUgYzkuOCwxLjEsMTEuNCwxLjksMTEuNCw5Ljd2NjkuM2MwLDcuNy0xLjYsOC42LTExLjQsOS43djQuNWg3My43bDQuOS0yOS40aC00LjRDMzA4LjUsMTE5LjYsMzAzLjksMTI2LjYsMjkyLjksMTI2LjZ6Ij48L3BhdGg+PHBhdGggZD0iTTM4NS41LDEyMS4xVjc5LjNjMC0xNS44LTkuNC0yMi40LTI2LjYtMjIuNGMtMTUsMC0yNi44LDYuNi0yNi44LDE5LjNjMCwyLjQsMC4yLDMuMywwLjgsNWgxNi42IGMtMC41LTItMC43LTUtMC43LTcuNWMwLTkuNiwzLjYtMTIuNCw5LjQtMTIuNGM2LjQsMCw5LjcsMiw5LjcsMTQuNHYxMS4ybC0yMC44LDcuN2MtMTAuNiw0LjEtMTkuMyw4LjgtMTkuMywyMC43IGMwLDEwLjksNy41LDE3LjgsMTguNiwxNy44YzkuOSwwLDE3LjQtNi4yLDIxLjktMTIuMWwwLjEtMC4xbDAsMFYxMzJoMjZ2LTQuNEMzODcuNywxMjcuMSwzODUuNSwxMjYuMiwzODUuNSwxMjEuMXogTTM2OCwxMTcuOCBjLTQuNCwzLjMtNy42LDUuMy0xMiw1LjRjLTcuNywwLTExLjItNS4yLTExLjItMTIuNmMwLTcuNywzLjYtMTEuMiw5LjgtMTMuNWwxMy40LTUuNFYxMTcuOEwzNjgsMTE3Ljh6Ij48L3BhdGg+PHBhdGggZD0iTTUxNC40LDEyMVY3OS41YzAtMTQuOC02LTIyLjQtMTguNy0yMi40Yy0xMS41LDAtMTkuNCw2LjYtMjUuNSwxMy45Yy0xLjgtOS42LTcuNy0xMy45LTE3LjgtMTMuOSBjLTExLjQsMC0xOC43LDYuMi0yNC44LDEzLjZWNTdoLTIuM2wtMjMuOCw3LjR2Mi40bDguNiw1djQ5LjRjMCw1LTIuMSw2LjEtOC45LDYuNHY0LjRoMzUuMXYtNC40Yy02LjctMC4zLTguNy0xLjMtOC43LTYuNHYtNDcgYzQuNy0zLjYsOS41LTYuNSwxNS41LTYuNWM3LjYsMCwxMC41LDQuMiwxMC41LDEyLjd2NDAuOGMwLDUtMS45LDYuMS04LjcsNi40djQuNGwzNC44LDB2LTQuNGMtNi43LTAuMy04LjYtMS4zLTguNi02LjR2LTQ3IGM0LjctMy42LDkuNS02LjUsMTUuNS02LjVjNy42LDAsMTAuNSw0LjIsMTAuNSwxMi43bC0wLjEsNDAuNWMwLDUtMS44LDYuNC04LjYsNi43bDAsNC40aDM1LjF2LTQuNCBDNTE2LjcsMTI3LjQsNTE0LjQsMTI2LjEsNTE0LjQsMTIxeiI+PC9wYXRoPjxwYXRoIGQ9Ik01NzMuMiw1Ny4zYy0xMSwwLTE4LjUsNS43LTIzLjQsMTIuOFYyMi45aC0yLjdsLTIzLjQsNi44djIuNWw4LjYsNC41VjEzMmgyLjlsOC0zLjVjNS44LDMuMywxMi4zLDUsMjAuMiw1IGMyMC44LDAsMzcuNC0xNS44LDM3LjQtNDIuNkM2MDAuOSw2OS45LDU5MC40LDU3LjMsNTczLjIsNTcuM3ogTTU2My40LDEyOC43Yy01LjQsMC0xMC4zLTIuNC0xMy43LTcuOVY3My42IGMzLjQtMy40LDguNS01LjcsMTMuNS01LjdjMTMuOSwwLDIwLDEyLjgsMjAsMjkuNUM1ODMuMywxMTQuNyw1NzUuOCwxMjguNSw1NjMuNCwxMjguN3oiPjwvcGF0aD48cGF0aCBkPSJNNjc3LDEyMS4yVjIyLjhoLTIuNkw2NTEsMjkuNlYzMmw4LjYsNC41djI1LjdjLTMuNC0zLjItOC44LTUuMS0xNS41LTUuMWMtMTkuOSwwLTM1LjIsMTUuMy0zNS4yLDQxLjMgYzAsMjAuNywxMS4yLDM0LjYsMjguMSwzNC42YzkuOCwwLDE3LTUuMywyMi42LTEzLjF2MC45VjEzMmgyNi4zbDAtNC40QzY3OS4xLDEyNy4zLDY3NywxMjYuMyw2NzcsMTIxLjJ6IE02NTkuNiwxMTcuMSBMNjU5LjYsMTE3LjFjLTMuNCwzLjQtOCw1LjEtMTMuMiw1LjFjLTEzLjIsMC0yMC40LTEyLjgtMjAuNC0yOS44YzAtMTcuOCw3LjMtMjkuMiwxOS41LTI5LjJjOC43LDAsMTQuMSw2LjksMTQuMSwxOC4zIEw2NTkuNiwxMTcuMXoiPjwvcGF0aD48cGF0aCBkPSJNNzQ3LjEsMTIxLjFWNzkuM2MwLTE1LjgtOS40LTIyLjQtMjYuNi0yMi40Yy0xNSwwLTI2LjgsNi42LTI2LjgsMTkuM2MwLDIuNCwwLjIsMy4zLDAuOCw1aDE2LjYgYy0wLjUtMi0wLjctNS0wLjctNy41YzAtOS42LDMuNi0xMi40LDkuNC0xMi40YzYuNCwwLDkuNywyLDkuNywxNC40djExLjJsLTIwLjgsNy43Yy0xMC42LDQuMS0xOS4zLDguOC0xOS4zLDIwLjcgYzAsMTAuOSw3LjUsMTcuOCwxOC42LDE3LjhjOS45LDAsMTcuNC02LjIsMjEuOS0xMi4xdi0wLjFoMC4xbDAsMTEuMWwyNiwwLjF2LTQuNUM3NDkuMywxMjcuMSw3NDcuMSwxMjYuMiw3NDcuMSwxMjEuMXogTTcyOS42LDExNy44Yy00LjQsMy4zLTcuNiw1LjMtMTIuMSw1LjRjLTcuNywwLTExLjItNS4yLTExLjItMTIuNmMwLTcuNywzLjYtMTEuMiw5LjgtMTMuNWwxMy40LTUuNEw3MjkuNiwxMTcuOEw3MjkuNiwxMTcuOHoiPjwvcGF0aD48L2c+PHBhdGggZD0iTTAsMHY5MC40YzAsNjUuNyw1MC45LDg4LjUsODguMSwxMDUuMmgwLjFsMywxLjRjMC43LTAuNCwxLjQtMC43LDIuMi0xYzAuNC0wLjIsMC45LTAuNCwxLjMtMC42IGMzNy4zLTE2LjYsODguNC0zOS41LDg4LjQtMTA1VjBIMHogTTExNiwxMzJsLTItNS4zbC0yNi42LTcwYy0xLjYsNC4xLTUuMywxNC05LjMsMjQuNmwtMTUuMyw0MS4zYy0wLjcsMi0wLjMsMywwLjIsMy43IGMxLjEsMS4zLDMuNSwxLjMsNy4zLDEuM0g3MWwwLDQuNEg0Mi40bDAtNC40aDIuMmMzLjksMCw3LjEtMS43LDkuNS02LjVsMi45LTYuNmwyNi41LTY3LjhsLTQuNy0xMi41aDI0LjdsMzQuMSw4OS43bDMuMSw4LjFIMTE2eiI+PC9wYXRoPjwvc3ZnPg==" /></a>

#### Web API: Java

<a href="/web4java/sprint/recnLDyTtONLTMiFJ" class="bd-toc-link">1.  Java Precourse Information</a>

-   [Welcome to Java Spring](/web4java/module/recfnUAvFbeyIAHib/)
-   [Java Spring Course Table of Contents](/web4java/module/recjH0lMflsFIVzDM/)

<a href="/web4java/sprint/recoJ4ZqNQWX3cy6E" class="bd-toc-link">2.  Java Fundamentals</a>

-   [Java - JDK and Java Classes](/web4java/module/recAGVTYNZyJbEFpu/)
-   [Java Interfaces, Abstract Classes, Lambda Expression](/web4java/module/rec6Hrk77HupYeoN5/)
-   [Java - RDBMS and SQL Basics](/web4java/module/recyJ663TrxVgpqY9/)
-   [Java - Intro to Maven, Spring, and Tomcat Using REST API](/web4java/module/recqtftA9E98qpbak/)

<a href="/web4java/sprint/recRVUSWQEtosl0Cz" class="bd-toc-link">3.  RDBMS and Intro to APIs</a>

-   [Java - Spring Database Creation Including Seed Data](/web4java/module/recb0OVmRrJzqhH4D/)
-   [Java - Read Data using CRUD Operations](/web4java/module/rec3THcdjv8BumGCt/)
-   [Java - Inserting Deleting and Updating Data using CRUD Operations](/web4java/module/recJihkiNn2KH2nEW/)
-   [Java - Data Modeling and Auditing Fields with custom querying](/web4java/module/rec2oQCFWOVShtxIx/)

<a href="/web4java/sprint/recSqm5AAEkJcIl3p" class="bd-toc-link">4.  Java Frameworks</a>

-   [Java - Exception Handling](/web4java/module/rec3E1WYDyoiEF1e3/)
-   [Java - User Authentication](/web4java/module/rececDV2OMIUcY2eH/)
-   [Java - Automated Testing](/web4java/module/recDboXln5wm4aKJt/)
-   [Java - Java Deployment and Best Practices](/web4java/module/rec7pCiBPzI4DkAJT/)

<a href="/web4java/sprint/recC5dhR9menaROwx" class="bd-toc-link">5.  WEB Unit 4 Java Build</a>

------------------------------------------------------------------------

-   [Prepare](#prepare)
-   [Learn](#learn)
-   [Guided Project](#guided-project)
-   [Project](#project)
-   [Review](#review)

# Java - Data Modeling and Auditing Fields with custom querying

<span class="lead"> </span>

<span id="Data_Modeling_and_Auditing_Fields_with_Custom_Querying"></span>

**At the end of this module, you should be able to:**

-   add additional fields to a Many to Many Join Table
-   add standard auditing fields to each table
-   populate and display standard auditing fields
-   use SQL, JPA and Hibernate to perform custom data manipulation operations on a RDBMS through a Spring Application
-   implement default Swagger documentation
-   print the default Swagger documentation

#### Pro Tip

Omit needless words.

Strunk and White

## <a href="#prepare" id="prepare" class="anchor"><span class="octicon octicon-link"></span></a>Prepare

Review each preclass resource before class.

## <a href="#learn" id="learn" class="anchor"><span class="octicon octicon-link"></span></a>Learn

#### Learn to add additional fields to a Many to Many Join Table

<span id="Additional_fields"></span>

##### Overview

-   See the Github Repository [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git) for the code used in the objective.

### Software Needed

-   Java Development Kit (JDK) - at least version 11
-   JetBrains IntelliJ IDEA IDE
-   Postman

We have a new business rule. When an employee is added to a Job Title, we need to add the name of their manager for that Job Title. In other words, our Join Table needs an additional attribute, column. This is a very common situation so let’s do it!

First, we need to know that our `@ManyToMany` annotation does not allow us to add additional fields to the join table. If you look at the database diagram, you can see that our Many to Many relationship gets implemented using two One to Many relations.

![Sample Employee Database](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-01.png)

-   One Employee to Many employee, job titles combinations
-   One Job title to Many employee, job titles combinations

We will make use of this construct to add our manager column.

The idea is to make changes to our database, allowing us to add this column. In making those changes, we want to impact our users, clients, as little as possible. So, we will keep our controllers the same. The data being sent to and from our application will have to change slightly to accommodate the new field. This is a great time to use the file comparison tool in IntelliJ (See the objective on IntelliJ Tips and Tricks from a previous module) -> comparing the these two applications

-   <https://github.com/LambdaSchool/java-sampleemps/tree/master/sampleemps_create_delete_update>
-   <https://github.com/LambdaSchool/java-sampleemps/tree/master/sampleemps_data_modeling>

do note that the second application has code from several different objectives for this module!

##### Follow Along

Let’s take the repo [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_create\_delete\_update](https://github.com/LambdaSchool/java-sampleemps.git)t and transform it into the repo [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git)t step by step!

-   Create the join table class `models.Employeetitles` with the extra manager column.
-   This is a brand new class. Much of the code is straightforward and commented below.
-   However, we do have a new issue, a compound primary key. This is where more than 2 or more fields are combined to make the primary key. In our case, we are combining `employeeid` and `jobtitleid`.
    -   Notice that each field has the @Id annotation signifying they are part of the primary key.
    -   Since we have a compound primary key, we must implement the interface `Serializable` to aid in generating JSON Objects of this class.
        -   When you implement Serializable, you also have to implement equals and hashCode
        -   This is done in a method similar to adding Getters and Setters
            -   Right click in the class where you want to add the new code.
            -   Select `Generate...` -> `equals() and hashCode()`
            -   In the dialog box,
                -   make sure `Use getters during code generation` is checked
                -   make sure `Accept subclasses as parameters to equals()` method is NOT checked

![getters screen](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-02.png)

-   In the next dialog box, check that all fields are included in the `equals()` method. This is the norm.

![equals screen](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-03.png)

-   In the next dialog box, check that all fields are included in the `hashCode()` method. This is the norm.

![hashCode screen](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-04.png)

-   The next dialog box requires some thought. You want to check all the fields that cannot be NULL. In our code, none of the fields can be NULL so I have checked all fields.

![Null screen](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-05.png)

-   Now click finished and see the code get generated for you!

Expand to see the code for models.EmployeeTitles

    package com.lambdaschool.sampleemps.models;

    import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

    import javax.persistence.Column;
    import javax.persistence.Entity;
    import javax.persistence.Id;
    import javax.persistence.JoinColumn;
    import javax.persistence.ManyToOne;
    import javax.persistence.Table;
    import java.io.Serializable;
    import java.util.Objects;

    @Entity
    @Table(name = "employeetitles")
    /*
     * When you have a compound primary key, you must implement Serializable for Hibernate
     * When you implement Serializable you must implement equals and hash code
     */
    public class EmployeeTitles implements Serializable
    {
        /*
         * 1/2 of the primary key (long) for employeetitles.
         * Also is a foreign key into the Employee table
         */
        @Id
        @ManyToOne
        /*
         * Many of these records can point to a single Employee. In other words, an employee can have multiple job titles
         */
        @JoinColumn(name = "employeeid")
        @JsonIgnoreProperties(value = "jobnames",
            allowSetters = true)
        private Employee emp;

        /*
         * 1/2 of the primary key (long) for employeetitles.
         * Also is a foreign key into the JobTitle table
         */
        @Id
        /*
         * Many of these records can point to a single JobTitle. In other words, multiple employees can have the same job title
         */
        @ManyToOne
        @JoinColumn(name = "jobtitleid")
        @JsonIgnoreProperties(value = "empnames",
            allowSetters = true)
        private JobTitle jobname;

        /*
         * Our extra field - why we are going all this hassle!
         */
        @Column(nullable = false)
        private String manager;

        /*
         * JPA requires the default constructor
         */
        public EmployeeTitles()
        {
        }

        /*
         * Allows us to easily create a record given all the data
         */
        public EmployeeTitles(
            Employee emp,
            JobTitle jobname,
            String manager)
        {
            this.emp = emp;
            this.jobname = jobname;
            this.manager = manager;
        }

        /*
         * Our standard getters and setters
         */
        public Employee getEmp()
        {
            return emp;
        }

        public void setEmp(Employee emp)
        {
            this.emp = emp;
        }

        public JobTitle getJobname()
        {
            return jobname;
        }

        public void setJobname(JobTitle jobname)
        {
            this.jobname = jobname;
        }

        public String getManager()
        {
            return manager;
        }

        public void setManager(String manager)
        {
            this.manager = manager;
        }

        /*
         * Since we have implemented Serializable - required for the compound primary key,
         * We have also Override equals and hashCode. This is done through the same menu system
         * as generating getters and setters. We pick equals() and hashCode() from that context menu
         * and generate them.
         */
        @Override
        public boolean equals(Object o)
        {
            if (this == o)
            {
                return true;
            }
            if (o == null || getClass() != o.getClass())
            {
                return false;
            }
            EmployeeTitles that = (EmployeeTitles) o;
            return getEmp().equals(that.getEmp()) &&
                getJobname().equals(that.getJobname()) &&
                manager.equals(that.manager);
        }

        @Override
        public int hashCode()
        {
            return Objects.hash(getEmp(),
                getJobname(),
                manager);
        }
    }

Now we need to update equals and hashCode to work with the ids. An EmployeeTitle object is considered equal to another object when their jobtileids and employeeids are equal. So, we write our equals method to reflect this.

Expand to see the new equals and hashcode methods

        /*
         * Since we have implemented Serializable - required for the compound primary key,
         * We have also Override equals and hashCode. This is done through the same menu system
         * as generating getters and setters. We pick equals() and hashCode() from that context menu
         * and generate them.
         */
        @Override
        public boolean equals(Object o)
        {
            // if the one we are comparing an object to itself, just return true
            if (this == o)
            {
                return true;
            }

            // make sure that we are comparing this object to one of the same class
            // if not return false
            if (!(o instanceof EmployeeTitles))
            {
                return false;
            }

            // check to see if the ids are equal.
            // if one of the objects happens to have a null for one of the fields
            // set the id to 0
            EmployeeTitles that = (EmployeeTitles) o;
            return ((emp == null) ? 0 : emp.getEmployeeid()) == ((that.emp == null) ? 0 : that.emp.getEmployeeid()) &&
                    ((jobname == null) ? 0 : jobname.getJobtitleid()) == ((that.jobname == null) ? 0 : that.jobname.getJobtitleid());
        }

        @Override
        public int hashCode()
        {
    //        return Objects.hash(getEmp(),
    //                            getJobname(),
    //                            manager);
            return 34;
        }

The Many To Many attributes in the Employee and JobTitle have to be replaced with One To Many relationships. Since we are changing the fields of the class, the Getters and Setters have to change. These changes are documented below.

Expand to see the code changes for models.Employee

Replace the following ManyToMany Relationship

        @ManyToMany()
        /*
         * Note: JoinTable is the name of a table that will get created in the database combining the two primary keys making up this relationship
         *       joinColumn is the primary key of the main, driving, table
         *       inverseJoinColumns is the primary key of the other table in the relationship
         */
        @JoinTable(name = "employeetitles",
            joinColumns = @JoinColumn(name = "employeeid"),
            inverseJoinColumns = @JoinColumn(name = "jobtitleid"))
        @JsonIgnoreProperties(value = "employees",
            allowSetters = true)
        List jobtitles = new ArrayList<>();
    </code></pre>

    With the OneToMany Relationship


        /*
         * emp is the field from EmployeeTitles
         * CascadeType.ALL says that when we add, update, delete an Employee record, have that affect emp in EmployeeTitle.
         * Notice that in EmployeeTitle there is no cascade option. This way manipulating an Employee record only affects
         * the EmployeeTitle join table but does not affect the JobTitle table.
         */
        @OneToMany(mappedBy = "emp",
            cascade = CascadeType.ALL)
        /*
         * When displaying EmployeeTitles from the Employee class, do not display the employee again.
         * However do allow for data to be added to the emp field in EmployeeTitles
         */
        @JsonIgnoreProperties(value = "emp",
            allowSetters = true)
        /*
         * We know all of this works with EmployeeTitles because that is the class of the field name that making the One To Many relationship!
         * This array contains the list of EmployeeTitles assigned to this Employee
         */
        private Set jobnames = new HashSet<>();
    </code></pre>

    Add this constructor to better work with Seed Data


        public Employee(
            String name,
            double salary)
        {
            this.name = name;
            this.salary = salary;
        }

Replace these Getters and Setters/p>

        public Set getJobtitles()
        {
            return jobtitles;
        }

        public void setJobtitles(Set jobtitles)
        {
            this.jobtitles = jobtitles;
        }
    </code></pre>

    With ones that work with the new fields


        public Set getJobnames()
        {
            return jobnames;
        }

        public void setJobnames(Set jobnames)
        {
            this.jobnames = jobnames;
        }
    </code></pre>

    </details>


    Expand to see the full models.Employee class incorporating all changes


    package com.lambdaschool.sampleemps.models;

    import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

    import javax.persistence.CascadeType;
    import javax.persistence.Column;
    import javax.persistence.Entity;
    import javax.persistence.GeneratedValue;
    import javax.persistence.GenerationType;
    import javax.persistence.Id;
    import javax.persistence.JoinColumn;
    import javax.persistence.JoinTable;
    import javax.persistence.ManyToMany;
    import javax.persistence.OneToMany;
    import javax.persistence.Table;
    import javax.persistence.Transient;
    import java.util.ArrayList;
    import java.util.HashSet;
    import java.util.List;
    import java.util.Set;

    @Entity
    @Table(name = "employees")
    public class Employee
    {
        @Id // The primary key
        @GeneratedValue(strategy = GenerationType.AUTO) // We will let the database decide how to generate it
        private long employeeid; // long so we can have many rows

        @Column(nullable = false,
                unique = true)
        private String name;

        @Transient
        public boolean hasvalueforsalary = false;
        private double salary;

        /*
         * emp is the field from EmployeeTitles
         * CascadeType.ALL says that when we add, update, delete an Employee record, have that affect emp in EmployeeTitle.
         * Notice that in EmployeeTitle there is no cascade option. This way manipulating an Employee record only affects
         * the EmployeeTitle join table but does not affect the JobTitle table.
         */
        @OneToMany(mappedBy = "emp",
                cascade = CascadeType.ALL)
        /*
         * When displaying EmployeeTitles from the Employee class, do not display the employee again.
         * However do allow for data to be added to the emp field in EmployeeTitles
         */
        @JsonIgnoreProperties(value = "emp",
                allowSetters = true)
        /*
         * We know all of this works with EmployeeTitles because that is the class of the field name that making the One To Many relationship!
         * This array contains the list of EmployeeTitles assigned to this Employee
         */
        private Set jobnames = new HashSet<>();

        @OneToMany(mappedBy = "employee",
                cascade = CascadeType.ALL,
                // when adding, reading, updating, and delete, the operations should affect the emails table as well)
                orphanRemoval = true)
        // if we find a email that has a reference to an employee that does not exist, delete that email record
        // we want to ignore, not display, the employee object found in Email
        @JsonIgnoreProperties(value = "employee")
        private List emails = new ArrayList<>();

        public Employee()
        {
            // the default constructor is required by the JPA
        }

        public Employee(
                String name,
                double salary)
        {
            this.name = name;
            this.salary = salary;
        }

        public long getEmployeeid()
        {
            return employeeid;
        }

        public void setEmployeeid(long employeeid)
        {
            this.employeeid = employeeid;
        }

        public String getName()
        {
            return name;
        }

        public void setName(String name)
        {
            this.name = name;
        }

        public double getSalary()
        {
            return salary;
        }

        public void setSalary(double salary)
        {
            hasvalueforsalary = true;
            this.salary = salary;
        }

        public List getEmails()
        {
            return emails;
        }

        public void setEmails(List emails)
        {
            this.emails = emails;
        }

        public Set getJobnames()
        {
            return jobnames;
        }

        public void setJobnames(Set jobnames)
        {
            this.jobnames = jobnames;
        }
    }
    </code></pre>

    </details>

    We finished our work with the Employee model. Now to work with the other side, Job Titles. Since we have declared Employees to be our driving table, JobTitles is much easier


    Expand to see the code changes for models.JobTitle

    Replace the following ManyToMany Relationship


        @ManyToMany(mappedBy = "jobtitles")
        @JsonIgnoreProperties(value = "jobtitles",
            allowSetters = true)
        private List employees = new ArrayList<>();
    </code></pre>

    With the OneToMany Relationship


        /*
         * jobname is the field from EmployeeTitles
         * CascadeType.ALL says that when we add, update, delete an Job Title record, have that affect jobname in EmployeeTitle.
         * Notice that in EmployeeTitle there is no cascade option. This way manipulating an JobTitle record only affects
         * the EmployeeTitle join table but does not affect the Employee table.
         */
        @OneToMany(mappedBy = "jobname",
            cascade = CascadeType.ALL)
        /*
         * When displaying EmployeeTitles from the JobTitle class, do not display the Job Title again.
         * However do allow for data to be added to the jobname field in EmployeeTitles
         */
        @JsonIgnoreProperties(value = "jobname",
            allowSetters = true)
        /*
         * We know all of this works with EmployeeTitles because that is the class of the field name that making the One To Many relationship!
         * This array contains the list of EmployeeTitles assigned to this Job Title
         */
        private Set empnames = new HashSet<>();
    </code></pre>

    Replace these Getters and Setters


        public List getEmployees()
        {
            return employees;
        }

        public void setEmployees(List employees)
        {
            this.employees = employees;
        }
    </code></pre>

    With ones that work with the new fields


        public Set getEmpnames()
        {
            return empnames;
        }

        public void setEmpnames(Set empnames)
        {
            this.empnames = empnames;
        }
    </code></pre>

    </details>


    Expand to see the full models.JobTitles class incorporating all changes


    package com.lambdaschool.sampleemps.models;

    import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

    import javax.persistence.CascadeType;
    import javax.persistence.Entity;
    import javax.persistence.GeneratedValue;
    import javax.persistence.GenerationType;
    import javax.persistence.Id;
    import javax.persistence.ManyToMany;
    import javax.persistence.OneToMany;
    import javax.persistence.Table;
    import java.util.HashSet;
    import java.util.Set;

    @Entity
    @Table(name = "jobtitles")
    public class JobTitle
    {
        @Id // The primary key
        @GeneratedValue(strategy = GenerationType.AUTO) // We will let the database decide how to generate it
        private long jobtitleid; // long so we can have many rows

        private String title;

        /*
         * jobname is the field from EmployeeTitles
         * CascadeType.ALL says that when we add, update, delete an Job Title record, have that affect jobname in EmployeeTitle.
         * Notice that in EmployeeTitle there is no cascade option. This way manipulating an JobTitle record only affects
         * the EmployeeTitle join table but does not affect the Employee table.
         */
        @OneToMany(mappedBy = "jobname",
                cascade = CascadeType.ALL)
        /*
         * When displaying EmployeeTitles from the JobTitle class, do not display the Job Title again.
         * However do allow for data to be added to the jobname field in EmployeeTitles
         */
        @JsonIgnoreProperties(value = "jobname",
                allowSetters = true)
        /*
         * We know all of this works with EmployeeTitles because that is the class of the field name that making the One To Many relationship!
         * This array contains the list of EmployeeTitles assigned to this Job Title
         */
        private Set empnames = new HashSet<>();

        public JobTitle()
        {
            // the default constructor is required by the JPA
        }

        public long getJobtitleid()
        {
            return jobtitleid;
        }

        public void setJobtitleid(long jobtitleid)
        {
            this.jobtitleid = jobtitleid;
        }

        public String getTitle()
        {
            return title;
        }

        public void setTitle(String title)
        {
            this.title = title;
        }

        public Set getEmpnames()
        {
            return empnames;
        }

        public void setEmpnames(Set empnames)
        {
            this.empnames = empnames;
        }
    }
    </code></pre>

    </details>

    We also have to make some changes to the `EmployeeServiceImpl`. See code below. Comments describe changes.


    Expand to see the the updated methods code for services.EmployeeServiceImpl


        /******* THE SAVE METHOD ******/
        @Transactional
        @Override
        public Employee save(Employee employee)
        {
            Employee newEmployee = new Employee();

            if (employee.getEmployeeid() != 0)
            {
                employeerepos.findById(employee.getEmployeeid())
                        .orElseThrow(() -> new EntityNotFoundException("Employee " + employee.getEmployeeid() + " Not Found"));

                newEmployee.setEmployeeid(employee.getEmployeeid());
            }

            newEmployee.setName(employee.getName());
            newEmployee.setSalary(employee.getSalary());

            // ***** changing this code to adjust to the new model
            newEmployee.getJobnames()
                    .clear();
            for (EmployeeTitles jt : employee.getJobnames())
            {
                JobTitle newJT = jtrepos.findById(jt.getJobname()
                                                          .getJobtitleid())
                        .orElseThrow(() -> new EntityNotFoundException("JobTitle " + jt.getJobname()
                                .getJobtitleid() + " Not Found"));

                // yes I just hard coded a manager!
                newEmployee.getJobnames()
                        .add(new EmployeeTitles(newEmployee, newJT, "Stumps"));
            }
            // ***** changing the above code to adjust to the new model

            newEmployee.getEmails()
                    .clear();
            for (Email e : employee.getEmails())
            {
                Email newEmail = new Email();
                newEmail.setEmail(e.getEmail());
                newEmail.setEmployee(newEmployee);

                newEmployee.getEmails()
                        .add(newEmail);
            }
            return employeerepos.save(newEmployee);
        }

        /******* THE UPDATE METHOD *******/
        @Transactional
        @Override
        public Employee update(
                Employee employee,
                long employeeid)
        {
            Employee currentEmployee = employeerepos.findById(employeeid)
                    .orElseThrow(() -> new EntityNotFoundException("Employee " + employeeid + " Not Found"));

            if (employee.getName() != null)
            {
                currentEmployee.setName(employee.getName());
            }

            if (employee.hasvalueforsalary)
            {
                currentEmployee.setSalary(employee.getSalary());
            }

            // changing this code to adjust to the new model
            currentEmployee.getJobnames()
                    .clear();
            for (EmployeeTitles jt : employee.getJobnames())
            {
                JobTitle newJT = jtrepos.findById(jt.getJobname()
                                                          .getJobtitleid())
                        .orElseThrow(() -> new EntityNotFoundException("JobTitle " + jt.getJobname()
                                .getJobtitleid() + " Not Found"));

                // yes I just hard coded a manager!
                currentEmployee.getJobnames()
                        .add(new EmployeeTitles(currentEmployee, newJT, "Stumps"));
            }
            // changing the above code to adjust to the new model

            if (employee.getEmails()
                    .size() > 0)
            {
                currentEmployee.getEmails()
                        .clear();
                for (Email e : employee.getEmails())
                {
                    Email newEmail = new Email();
                    newEmail.setEmail(e.getEmail());
                    newEmail.setEmployee(currentEmployee);

                    currentEmployee.getEmails()
                            .add(newEmail);
                }
            }

            return employeerepos.save(currentEmployee);
        }

Remember the controllers do NOT change!!!

##### Dig Deeper

-   [Many-to-Many Association](https://vladmihalcea.com/the-best-way-to-map-a-many-to-many-association-with-extra-columns-when-using-jpa-and-hibernate/)  
    The best way to map a many-to-many association with extra columns when using JPA and Hibernate
-   [Many To Many Extra Columns Relationship](https://hellokoding.com/jpa-many-to-many-extra-columns-relationship-mapping-example-with-spring-boot-maven-and-mysql/)  
    JPA and Hibernate Many To Many Extra Columns Relationship Mapping Example with Spring Boot and MySQL

------------------------------------------------------------------------

#### Learn to add standard auditing fields to each table

<span id="Adding_Audit_Fields"></span>

##### Overview

-   See the Github Repository [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git)t for the code used in the objective.

### Software Needed

-   Java Development Kit (JDK) - at least version 11
-   JetBrains IntelliJ IDEA IDE
-   Postman

A very common extra set of columns that are added to tables are auditing columns.

-   Who created the row
-   When was the row created
-   Who last modified the row
-   When was the row last modified

These are so common that the Spring Framework provides us with JPA Auditing Annotations. We just need to implement them as we desire. Here is the common approach:

A note on the fields

-   The When fields, data and time, will be read from the system date and time
-   The Who fields, username, for now will default to something. We will be adding user authentication in the future and that is when these fields will really show their worth!

##### Follow Along

Let’s continue taking the repo [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_create\_delete\_update](https://github.com/LambdaSchool/java-sampleemps.git)t and transforming it into the repo [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git)t step by step!

We are going to add these auditing fields to each table. Let’s first create a new Abstract Class that contains these audit fields. Take special notice of the comments around the annotations. This is boilerplate code. This abstract class can normally be added as is to any Java Spring application where you wish to implement audit fields.

Expand to see the new abstract class models.Auditable


    import org.springframework.data.annotation.CreatedBy;
    import org.springframework.data.annotation.CreatedDate;
    import org.springframework.data.annotation.LastModifiedBy;
    import org.springframework.data.annotation.LastModifiedDate;
    import org.springframework.data.jpa.domain.support.AuditingEntityListener;

    import javax.persistence.EntityListeners;
    import javax.persistence.MappedSuperclass;
    import javax.persistence.Temporal;
    import java.util.Date;

    import static javax.persistence.TemporalType.TIMESTAMP;

    /**
     * Abstract class that adds standard auditing fields to tables that extend it
     *
     * @MappedSuperclass - Since relational databases do not support inheritance,
     * Spring Boot provides a way to say that this class is a "parent" class whose fields will be included in the child class.
     * The child class is the one that forms the entity for the database.
     * @EntityListeners - When an entity is accessed by the Spring Framework, the argument of the Entity Listener annotation is fired.
     * Thus this annotation is "listening" for when an entity is accessed and then performs its argument.
     * AuditingEntityListener.class - The class that captures the data for and updates the annotations used in auditing -
     * CreatedBy, CreatedDate, ModifiedBy, ModifiedDate
     */
    @MappedSuperclass
    @EntityListeners(AuditingEntityListener.class)
    abstract class Auditable
    {
        /**
         * String field containing the username of who created this row
         */
        @CreatedBy
        protected String createdBy;

        /**
         * Date field containing the date and time when the row was created
         * 
         * Temporal(TIMESTAMP) - Sets the precision of the date being saved. In this case Date and Time
         */
        @CreatedDate
        @Temporal(TIMESTAMP)
        protected Date createdDate;

        /**
         * String field containing the username of who last modified this row
         */
        @LastModifiedBy
        protected String lastModifiedBy;

        /**
         * Date field containing the data and time when the row was last modified
         * 

         * Temporal(TIMESTAMP) - Sets the precision of the date being saved. In this case Date and Time
         */
        @LastModifiedDate
        @Temporal(TIMESTAMP)
        protected Date lastModifiedDate;
    }

    </code></pre>

    </details>

    For each table where we want auditing fields, we just have its class extend the class Auditable and we have auditing fields! So for example the class header for the Employee class becomes

    ```JAVA
    public class Employee extends Auditable
    ```

    And yes you can implement an interface and extend an abstract class in the same header. So, the class header for EmployeeTitles becomes

    ```JAVA
    public class EmployeeTitles extends Auditable implements Serializable
    ```

    Note that order matters. You do have to extend the abstract class BEFORE implementing the interfaces.

    We need to make sure we extends Auditable for all of the modules.

    We still have a couple of more steps. First, we need to tell the auditing function where to find the username. We do this by implementing the interface `AuditorAware` - so the auditing functions is aware of the username! Create a new class in `Services` called `UserAuditing`. Remember for now we are simply defaulting the username to something, in our case ***SYSTEM***. Later we will be adding authenticated users to our applications. Then this will make more sense! And again this is boilerplate code that can be used without modification in most Java Spring applications!


    Expand to see the new services.UserAuditing



    package com.lambdaschool.usermodel.services;

    import org.springframework.data.domain.AuditorAware;
    import org.springframework.stereotype.Component;

    import java.util.Optional;

    /**
     * Spring Boot needs to know what username to use for the auditing fields CreatedBy and ModifiedBy
     * For now, a default name will be used
     */
    @Component
    public class UserAuditing implements AuditorAware
    {
        /**
         * The current user
         *
         * @return Optional(String) of current user
         */
        @Override
        public Optional getCurrentAuditor()
        {
            String uname;
            uname = "SYSTEM";
            return Optional.of(uname);
        }
    }

    </code></pre>

    </details>

    And finally the step most people forget! We did all this work and now we need to "turn on" the auditing function! Add the annotation `@EnableJpaAuditing` to our main class. So our class `SampleempsApplication` now looks like the following


    Expand to see the finished main class SampleempsApplication



    package com.lambdaschool.sampleemps;

    import org.springframework.boot.SpringApplication;
    import org.springframework.boot.autoconfigure.SpringBootApplication;
    import org.springframework.data.jpa.repository.config.EnableJpaAuditing;

    @EnableJpaAuditing
    @SpringBootApplication
    public class SampleempsApplication
    {

        public static void main(String[] args)
        {
            SpringApplication.run(SampleempsApplication.class,
                args);
        }

    }

##### Dig Deeper

-   [Enable auditing](https://medium.com/@manika09singh/enable-auditing-using-spring-data-jpa-2f62587ccb23)  
    Enable auditing using Spring Data JPA
-   [Spring Data JPA Auditing](https://dzone.com/articles/spring-data-jpa-auditing-automatically-the-good-stuff)  
    Spring Data JPA Auditing: Automatically Saving the Good Stuff. Most closely follows our plan
-   [Baeldung](https://www.baeldung.com/database-auditing-jpa)  
    Baeldung - Auditing with JPA, Hibernate, and Spring Data JPA
-   [Baeldung](https://www.baeldung.com/hibernate-inheritance)  
    Baeldung - MappedSuperclass

------------------------------------------------------------------------

#### Learn to populate and display standard auditing fields

<span id="Using_Audit_Fields"></span>

##### Overview

-   See the Github Repository [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git) for the code used in the objective.

### Software Needed

-   Java Development Kit (JDK) - at least version 11
-   JetBrains IntelliJ IDEA IDE
-   Postman

We are using Spring Data and JPA to populate our SeedData. We have extended Auditable for all our tables. We have enabled JPA Auditing in our main class. We run our application and get the following

Expand to see http://localhost:2019/employees/employees


    [
        {
            "employeeid": 3,
            "name": "CINNAMON",
            "salary": 80000.0,
            "jobnames": [
                {
                    "jobname": {
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                },
                {
                    "jobname": {
                        "jobtitleid": 2,
                        "title": "Wizard"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "emailid": 4,
                    "email": "[email protected]"
                },
                {
                    "emailid": 5,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 6,
            "name": "BARNBARN",
            "salary": 80000.0,
            "jobnames": [
                {
                    "jobname": {
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "emailid": 7,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 8,
            "name": "JOHN",
            "salary": 75000.0,
            "jobnames": [
                {
                    "jobname": {
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                }
            ],
            "emails": []
        },
        {
            "employeeid": 9,
            "name": "Detra Nolan",
            "salary": 144432.77313869854,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 10,
                    "email": "[email protected]"
                },
                {
                    "emailid": 11,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 12,
            "name": "Miss Barrie Lockman",
            "salary": 129601.33401646325,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 13,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 14,
            "name": "Lonna Larson",
            "salary": 140194.20054205784,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 15,
                    "email": "[email protected]"
                },
                {
                    "emailid": 16,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 17,
            "name": "Parker Marquardt",
            "salary": 85592.60933164599,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 18,
                    "email": "[email protected]"
                },
                {
                    "emailid": 19,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 20,
            "name": "Nicolle Zemlak",
            "salary": 133865.34843281,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 21,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 22,
            "name": "Mrs. Man Skiles",
            "salary": 137968.11706319422,
            "jobnames": [],
            "emails": []
        },
        {
            "employeeid": 23,
            "name": "Maryam Gorczany",
            "salary": 131355.17892474588,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 24,
                    "email": "[email protected]"
                },
                {
                    "emailid": 25,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 26,
            "name": "Mrs. Otha Wolff",
            "salary": 72941.15016509876,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 27,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 28,
            "name": "Derek Goodwin",
            "salary": 54903.90938516596,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 29,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 30,
            "name": "Elvie Bruen DDS",
            "salary": 64201.385303591815,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 31,
                    "email": "[email protected]"
                },
                {
                    "emailid": 32,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 33,
            "name": "Merry Towne",
            "salary": 131025.27828143144,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 34,
                    "email": "[email protected]"
                },
                {
                    "emailid": 35,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 36,
            "name": "Candie Boehm",
            "salary": 120093.44263973452,
            "jobnames": [],
            "emails": []
        },
        {
            "employeeid": 37,
            "name": "Jacinto Kling",
            "salary": 53328.48647559756,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 38,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 39,
            "name": "Dr. Sabina Schinner",
            "salary": 75510.48275117637,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 40,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 41,
            "name": "Windy Brakus",
            "salary": 104716.05351840358,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 42,
                    "email": "[email protected]"
                },
                {
                    "emailid": 43,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 44,
            "name": "Emanuel Daugherty",
            "salary": 99774.54071602612,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 45,
                    "email": "[email protected]"
                },
                {
                    "emailid": 46,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 47,
            "name": "Lorrie Swaniawski",
            "salary": 67203.81626286106,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 48,
                    "email": "[email protected]"
                },
                {
                    "emailid": 49,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 50,
            "name": "Randolph Schmeler",
            "salary": 115544.93884702613,
            "jobnames": [],
            "emails": []
        },
        {
            "employeeid": 51,
            "name": "Collen Gerhold",
            "salary": 79692.67702221699,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 52,
                    "email": "[email protected]"
                },
                {
                    "emailid": 53,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 54,
            "name": "Maris Kertzmann",
            "salary": 98830.45420054544,
            "jobnames": [],
            "emails": []
        },
        {
            "employeeid": 55,
            "name": "Josh Veum",
            "salary": 142356.39293671085,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 56,
                    "email": "[email protected]"
                },
                {
                    "emailid": 57,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 58,
            "name": "Miss Myles Rogahn",
            "salary": 71239.88988749337,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 59,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 60,
            "name": "Olympia Price DVM",
            "salary": 138789.6295924195,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 61,
                    "email": "[email protected]"
                },
                {
                    "emailid": 62,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 63,
            "name": "Tobie Wiza DDS",
            "salary": 50346.56949114981,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 64,
                    "email": "[email protected]"
                },
                {
                    "emailid": 65,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "employeeid": 66,
            "name": "Raymond Zboncak",
            "salary": 85188.22224334985,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 67,
                    "email": "[email protected]"
                }
            ]
        }
    ]

So where are the auditing fields??? We have not set up Getters for them so they do not appear in the JSON! If that is what we want, and often it is, then we are fine. As you see below the auditing fields are still in the database but do not crowd out the rest of the data in the JSON.

![Auditing Fields](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-06.png)

Let’s say we do want to have the auditing fields appear in the JSON. This is simple a matter of adding the right Getters to the right spot!

### Displaying Auditing fields for all tables

Let’s say you want auditing data on all the tables. Simply add Getters to your abstract class. No need to add setters. They are never used. JPA Auditing does its own thing. With the Getters added to your abstract class, your new output is

Expand to see http://localhost:2019/employees/employees with auditing data


    [
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:25.478+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:25.478+0000",
            "employeeid": 3,
            "name": "CINNAMON",
            "salary": 80000.0,
            "jobnames": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:25.485+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:25.485+0000",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-20T22:17:25.453+0000",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-20T22:17:25.453+0000",
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:25.486+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:25.486+0000",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-20T22:17:25.472+0000",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-20T22:17:25.472+0000",
                        "jobtitleid": 2,
                        "title": "Wizard"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:25.482+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:25.482+0000",
                    "emailid": 4,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:25.483+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:25.483+0000",
                    "emailid": 5,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:25.487+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:25.487+0000",
            "employeeid": 6,
            "name": "BARNBARN",
            "salary": 80000.0,
            "jobnames": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:25.488+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:25.488+0000",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-20T22:17:25.453+0000",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-20T22:17:25.453+0000",
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:25.487+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:25.487+0000",
                    "emailid": 7,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:25.489+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:25.489+0000",
            "employeeid": 8,
            "name": "JOHN",
            "salary": 75000.0,
            "jobnames": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:25.489+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:25.489+0000",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-20T22:17:25.453+0000",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-20T22:17:25.453+0000",
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                }
            ],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.150+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.150+0000",
            "employeeid": 9,
            "name": "Morgan Padberg",
            "salary": 59651.38167324421,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.163+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.163+0000",
            "employeeid": 10,
            "name": "Otilia Hermann",
            "salary": 146191.82553753187,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.164+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.164+0000",
                    "emailid": 11,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.164+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.164+0000",
            "employeeid": 12,
            "name": "Ivana Reilly",
            "salary": 90785.68084079534,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.165+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.165+0000",
            "employeeid": 13,
            "name": "Miss Malcolm Ebert",
            "salary": 112739.41455363025,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.166+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.166+0000",
                    "emailid": 14,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.167+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.167+0000",
            "employeeid": 15,
            "name": "Ryan Powlowski",
            "salary": 99280.17831156368,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.167+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.167+0000",
                    "emailid": 16,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.168+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.168+0000",
            "employeeid": 17,
            "name": "Hayden Ziemann",
            "salary": 127429.51939176352,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.169+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.169+0000",
                    "emailid": 18,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.169+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.169+0000",
                    "emailid": 19,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.170+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.170+0000",
            "employeeid": 20,
            "name": "Whitney Corwin",
            "salary": 112279.40911064125,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.170+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.170+0000",
            "employeeid": 21,
            "name": "Ms. Brigette Lang",
            "salary": 50357.87636437282,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.171+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.171+0000",
            "employeeid": 22,
            "name": "Terry Dietrich",
            "salary": 143174.4005789744,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.172+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.172+0000",
                    "emailid": 23,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.172+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.172+0000",
                    "emailid": 24,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.173+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.173+0000",
            "employeeid": 25,
            "name": "Raul Hegmann",
            "salary": 103192.60933759664,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.174+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.174+0000",
                    "emailid": 26,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.174+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.174+0000",
                    "emailid": 27,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.175+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.175+0000",
            "employeeid": 28,
            "name": "Dell Schumm",
            "salary": 85938.60881723888,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.176+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.176+0000",
                    "emailid": 29,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.176+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.176+0000",
                    "emailid": 30,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.177+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.177+0000",
            "employeeid": 31,
            "name": "Miguel Rutherford",
            "salary": 134800.26159867534,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.178+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.178+0000",
                    "emailid": 32,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.178+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.178+0000",
                    "emailid": 33,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.179+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.179+0000",
            "employeeid": 34,
            "name": "Shaunna Gaylord",
            "salary": 112681.8879417092,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.180+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.180+0000",
                    "emailid": 35,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.181+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.181+0000",
            "employeeid": 36,
            "name": "Miss Rosalia Ratke",
            "salary": 75228.13952859116,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.181+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.181+0000",
            "employeeid": 37,
            "name": "Eli Wehner Sr.",
            "salary": 129611.27744208522,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.182+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.182+0000",
                    "emailid": 38,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.182+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.182+0000",
            "employeeid": 39,
            "name": "Paul Torphy",
            "salary": 97857.13607443846,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.183+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.183+0000",
            "employeeid": 40,
            "name": "Perry Quigley",
            "salary": 79194.7193774427,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.184+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.184+0000",
                    "emailid": 41,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.184+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.184+0000",
                    "emailid": 42,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.185+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.185+0000",
            "employeeid": 43,
            "name": "Kristal Mertz",
            "salary": 144056.7071816315,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.185+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.185+0000",
                    "emailid": 44,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.186+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.186+0000",
            "employeeid": 45,
            "name": "Dustin Goldner MD",
            "salary": 82475.25067220436,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.187+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.187+0000",
                    "emailid": 46,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.187+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.187+0000",
                    "emailid": 47,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.188+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.188+0000",
            "employeeid": 48,
            "name": "Max Conn",
            "salary": 128022.53291654705,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.188+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.188+0000",
            "employeeid": 49,
            "name": "Cruz West",
            "salary": 112855.3673227873,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.189+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.189+0000",
                    "emailid": 50,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.189+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.189+0000",
            "employeeid": 51,
            "name": "Evelynn Hoeger MD",
            "salary": 67486.15658064265,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.190+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.190+0000",
                    "emailid": 52,
                    "email": "[email protected]otmail.com"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.190+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.190+0000",
            "employeeid": 53,
            "name": "Eva Koch V",
            "salary": 59287.72498842635,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-20T22:17:26.191+0000",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-20T22:17:26.191+0000",
                    "emailid": 54,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.191+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.191+0000",
            "employeeid": 55,
            "name": "Geneva Rosenbaum",
            "salary": 146019.0742355405,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-20T22:17:26.192+0000",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-20T22:17:26.192+0000",
            "employeeid": 56,
            "name": "Shawnda Haag",
            "salary": 114196.72669851984,
            "jobnames": [],
            "emails": []
        }
    ]

And the new Auditable class looks like

Expand to see models.Auditable with Getters


    package com.lambdaschool.sampleemps.models;

    import org.springframework.data.annotation.CreatedBy;
    import org.springframework.data.annotation.CreatedDate;
    import org.springframework.data.annotation.LastModifiedBy;
    import org.springframework.data.annotation.LastModifiedDate;
    import org.springframework.data.jpa.domain.support.AuditingEntityListener;

    import javax.persistence.EntityListeners;
    import javax.persistence.MappedSuperclass;
    import javax.persistence.Temporal;
    import java.util.Date;

    import static javax.persistence.TemporalType.TIMESTAMP;

    /**
     * Abstract class that adds standard auditing fields to tables that extend it
     *
     * @MappedSuperclass - Since relational databases do not support inheritance,
     * Spring Boot provides a way to say that this class is a "parent" class whose fields will be included in the child class.
     * The child class is the one that forms the entity for the database.
     * @EntityListeners - When an entity is accessed by the Spring Framework, the argument of the Entity Listener annotation is fired.
     * Thus this annotiation is "listening" for when an entity is accessed and then performs its argument.
     * AuditingEntityListener.class - The class that captures the data for and updates the annotations used in auditing -
     * CreatedBy, CreatedDate, ModifiedBy, ModifiedDate
     */
    @MappedSuperclass
    @EntityListeners(AuditingEntityListener.class)
    abstract class Auditable
    {
        /**
         * String field containing the username of who created this row
         */
        @CreatedBy
        protected String createdBy;

        /**
         * Date field containing the date and time when the row was created
         * 
         * Temporal(TIMESTAMP) - Sets the precision of the date being saved. In this case Date and Time
         */
        @CreatedDate
        @Temporal(TIMESTAMP)
        protected Date createdDate;

        /**
         * String field containing the username of who last modified this row
         */
        @LastModifiedBy
        protected String lastModifiedBy;

        /**
         * Date field containing the data and time when the row was last modified
         * 

         * Temporal(TIMESTAMP) - Sets the precision of the date being saved. In this case Date and Time
         */
        @LastModifiedDate
        @Temporal(TIMESTAMP)
        protected Date lastModifiedDate;

        public String getCreatedBy()
        {
            return createdBy;
        }

        public Date getCreatedDate()
        {
            return createdDate;
        }

        public String getLastModifiedBy()
        {
            return lastModifiedBy;
        }

        public Date getLastModifiedDate()
        {
            return lastModifiedDate;
        }
    }

    </code></pre>

    </details>

    ### Displaying only specific auditing fields

    Let's say you want to display when an employee was added to the database. You do not wish to display any other audit fields. This is a very common business practice. To do this

    - DO NOT ADD GETTERS TO AUDITABLE
    - Just add the getter you want to the table where you want it to be displayed
    - You will have to manually enter the code. IntelliJ does not offer generating getters for fields inherited from abstract classes

    So in our example, add the following getter to models.Employee.

    ```JAVA
        public Date getCreatedDate()
        {
            return createdDate;
        }
    ```

    And now you get the following data displaying only the creation date of the employee from the list of audit fields.


    Expand to see http://localhost:2019/employees/employees with specific auditing data



    [
        {
            "createdDate": "2020-03-20T21:29:45.786+0000",
            "employeeid": 3,
            "name": "CINNAMON",
            "salary": 80000.0,
            "jobnames": [
                {
                    "jobname": {
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                },
                {
                    "jobname": {
                        "jobtitleid": 2,
                        "title": "Wizard"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "emailid": 4,
                    "email": "[email protected]"
                },
                {
                    "emailid": 5,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:45.794+0000",
            "employeeid": 6,
            "name": "BARNBARN",
            "salary": 80000.0,
            "jobnames": [
                {
                    "jobname": {
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "emailid": 7,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:45.796+0000",
            "employeeid": 8,
            "name": "JOHN",
            "salary": 75000.0,
            "jobnames": [
                {
                    "jobname": {
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                }
            ],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.506+0000",
            "employeeid": 9,
            "name": "Rubin Pagac",
            "salary": 79515.58894383968,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 10,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.507+0000",
            "employeeid": 11,
            "name": "Michale Rolfson Sr.",
            "salary": 57586.73563954353,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.508+0000",
            "employeeid": 12,
            "name": "Waylon Dietrich",
            "salary": 63661.47659095831,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 13,
                    "email": "[email protected]"
                },
                {
                    "emailid": 14,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.509+0000",
            "employeeid": 15,
            "name": "Miss Lourie Lesch",
            "salary": 98282.89816430255,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 16,
                    "email": "[email protected]"
                },
                {
                    "emailid": 17,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.511+0000",
            "employeeid": 18,
            "name": "Mahalia Lueilwitz",
            "salary": 55116.17813966383,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 19,
                    "email": "[email protected]"
                },
                {
                    "emailid": 20,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.512+0000",
            "employeeid": 21,
            "name": "Opal Bergstrom",
            "salary": 83090.46372685424,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.513+0000",
            "employeeid": 22,
            "name": "Robbie Yundt",
            "salary": 89382.48633333342,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 23,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.514+0000",
            "employeeid": 24,
            "name": "Maple MacGyver",
            "salary": 66020.85602743662,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 25,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.515+0000",
            "employeeid": 26,
            "name": "Mr. Dena Schroeder",
            "salary": 126452.21728807941,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 27,
                    "email": "[email protected]"
                },
                {
                    "emailid": 28,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.516+0000",
            "employeeid": 29,
            "name": "Mathew Cummerata",
            "salary": 62970.104425578524,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.517+0000",
            "employeeid": 30,
            "name": "Claude Mertz Jr.",
            "salary": 141578.37885451617,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.518+0000",
            "employeeid": 31,
            "name": "Lisabeth Rice",
            "salary": 86891.12981394364,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 32,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.519+0000",
            "employeeid": 33,
            "name": "Keisha Wilderman",
            "salary": 60928.73309534274,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.520+0000",
            "employeeid": 34,
            "name": "Roberto Cole",
            "salary": 98060.39780158934,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.521+0000",
            "employeeid": 35,
            "name": "Mickey Prosacco",
            "salary": 76453.32280357803,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.521+0000",
            "employeeid": 36,
            "name": "Miss Weston Boyle",
            "salary": 109800.98700507148,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 37,
                    "email": "[email protected]"
                },
                {
                    "emailid": 38,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.523+0000",
            "employeeid": 39,
            "name": "Jarod Friesen",
            "salary": 132743.16918268875,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 40,
                    "email": "[email protected]"
                },
                {
                    "emailid": 41,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.523+0000",
            "employeeid": 42,
            "name": "Ali Robel",
            "salary": 90007.92665890715,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.524+0000",
            "employeeid": 43,
            "name": "Mariann Kulas",
            "salary": 63297.8959611414,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 44,
                    "email": "[email protected]"
                },
                {
                    "emailid": 45,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.525+0000",
            "employeeid": 46,
            "name": "Dortha Jones",
            "salary": 121362.46697960931,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 47,
                    "email": "[email protected]"
                },
                {
                    "emailid": 48,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.526+0000",
            "employeeid": 49,
            "name": "Mr. Carey Heathcote",
            "salary": 136114.63937627617,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.527+0000",
            "employeeid": 50,
            "name": "Mr. Gregory Douglas",
            "salary": 124594.46641271688,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 51,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.528+0000",
            "employeeid": 52,
            "name": "Yaeko O'Kon",
            "salary": 147448.16455677926,
            "jobnames": [],
            "emails": [
                {
                    "emailid": 53,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdDate": "2020-03-20T21:29:46.529+0000",
            "employeeid": 54,
            "name": "Ava Fay",
            "salary": 70285.61953920404,
            "jobnames": [],
            "emails": []
        },
        {
            "createdDate": "2020-03-20T21:29:46.529+0000",
            "employeeid": 55,
            "name": "Jason Reynolds",
            "salary": 86482.25152372931,
            "jobnames": [],
            "emails": []
        }
    ]

But what if we don't like the date format. We can change that by adding these two lines to our \`application.properties\` file \`\`\`TEXT spring.jackson.date-format=yyyy-MM-dd HH:mm:ss spring.jackson.time-zone=America/Los\_Angeles \`\`\` Of course we change the pattern using standard date formatting. See \[https://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html\](https://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html) for more information on date formatting! Now when we run our application, our date format is updated for all our dates!

Expand to see http://localhost:2019/employees/employees with updated date format


    [
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:07",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:07",
            "employeeid": 3,
            "name": "CINNAMON",
            "salary": 80000.0,
            "jobnames": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:07",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:07",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-21 10:44:07",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-21 10:44:07",
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:07",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:07",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-21 10:44:07",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-21 10:44:07",
                        "jobtitleid": 2,
                        "title": "Wizard"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:07",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:07",
                    "emailid": 4,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:07",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:07",
                    "emailid": 5,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:07",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:07",
            "employeeid": 6,
            "name": "BARNBARN",
            "salary": 80000.0,
            "jobnames": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:07",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:07",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-21 10:44:07",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-21 10:44:07",
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "STUBS"
                }
            ],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:07",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:07",
                    "emailid": 7,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:07",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:07",
            "employeeid": 8,
            "name": "JOHN",
            "salary": 75000.0,
            "jobnames": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:07",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:07",
                    "jobname": {
                        "createdBy": "SYSTEM",
                        "createdDate": "2020-03-21 10:44:07",
                        "lastModifiedBy": "SYSTEM",
                        "lastModifiedDate": "2020-03-21 10:44:07",
                        "jobtitleid": 1,
                        "title": "Big Boss"
                    },
                    "manager": "MOJO"
                }
            ],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 9,
            "name": "Foster Franecki",
            "salary": 59869.53985146481,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 10,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 11,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 12,
            "name": "Eldridge Bashirian Jr.",
            "salary": 112315.41731225738,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 13,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 14,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 15,
            "name": "Alexis Padberg PhD",
            "salary": 76223.26607275958,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 16,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 17,
            "name": "Dr. Bethanie Romaguera",
            "salary": 63478.77682909907,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 18,
            "name": "Millard Bailey",
            "salary": 75320.27095487631,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 19,
            "name": "Trinidad Hackett",
            "salary": 133329.11862916453,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 20,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 21,
            "name": "Eleni Bernhard",
            "salary": 138614.61426692628,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 22,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 23,
            "name": "Prince Christiansen",
            "salary": 70426.82059191875,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 24,
            "name": "Shannon Bartoletti",
            "salary": 68337.71135189131,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 25,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 26,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 27,
            "name": "Harold Conroy",
            "salary": 142133.9551248509,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 28,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 29,
            "name": "Marceline Borer DDS",
            "salary": 138667.54834687297,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 30,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 31,
            "name": "Booker Spinka",
            "salary": 137212.6280766009,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 32,
            "name": "Rashad Crist",
            "salary": 96591.48970477152,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 33,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 34,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 35,
            "name": "Catharine Labadie",
            "salary": 71895.31589367473,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 36,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 37,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 38,
            "name": "Tatiana Nitzsche",
            "salary": 85443.76158015004,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 39,
            "name": "Arthur Kuphal",
            "salary": 81377.47009783119,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 40,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 41,
            "name": "Dr. Lawerence Casper",
            "salary": 147748.70206736086,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 42,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 43,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 44,
            "name": "Seymour Olson DVM",
            "salary": 89899.87248405197,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 45,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 46,
            "name": "Alina Miller",
            "salary": 84556.90367960025,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 47,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 48,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 49,
            "name": "Nichole Russel",
            "salary": 82481.30000026332,
            "jobnames": [],
            "emails": []
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 50,
            "name": "Stephany Osinski",
            "salary": 93073.50912637703,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 51,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 52,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 53,
            "name": "Christopher Bednar Sr.",
            "salary": 89464.93132507637,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 54,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 55,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 56,
            "name": "Miss Major Schuppe",
            "salary": 53814.565016417524,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 57,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 58,
            "name": "Toby Weissnat",
            "salary": 103092.68543880018,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 59,
                    "email": "[email protected]"
                },
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 60,
                    "email": "[email protected]"
                }
            ]
        },
        {
            "createdBy": "SYSTEM",
            "createdDate": "2020-03-21 10:44:08",
            "lastModifiedBy": "SYSTEM",
            "lastModifiedDate": "2020-03-21 10:44:08",
            "employeeid": 61,
            "name": "Miss Brendon Bogisich",
            "salary": 91668.23355765417,
            "jobnames": [],
            "emails": [
                {
                    "createdBy": "SYSTEM",
                    "createdDate": "2020-03-21 10:44:08",
                    "lastModifiedBy": "SYSTEM",
                    "lastModifiedDate": "2020-03-21 10:44:08",
                    "emailid": 62,
                    "email": "[email protected]"
                }
            ]
        }
    ]

### Here are a couple of common pitfalls to avoid - You have everything set up. You are using Spring Data and JPA to populate your data. In other words you are using SeedData. You have extended Auditable for all your tables. You run your code and no Audit Data. See picture below: !\[Auditing Data\](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-07.png) - In this case you have left out the \`@EnableJpaAuditing\` in the main class. This is a common mistake of mine. So watch out for it! - New Issue: You have everything set up. You have extended Auditable for all your tables. You have added @EnableJpaAuditing you your main class but you are using data.sql to populate your data. You run your code and no Audit Data. See picture below: !\[Auditing Data\](https://lambdaschool.github.io/java-curriculum-assets/Sprint%2011%20-%20Java%20with%20RDBMS%20and%20API%20Intros/Module%204%20-%20JX%20Java%20-%20Data%20Modeling%20and%20Auditing%20Fields%20with%20custom%20querying/assets/JX-SP11-M4-08.png) - JPA Auditing only works when using JPA! \`data.sql\` bypasses Spring Data JPA altogether and does its own inserts. So if you want auditing data in this case, you have to manually add it your data.sql like this. Notice the addition of the four auditing fields in the column list and their corresponding values in the values being inserted.

data.sql with Auditing Data


    DELETE
    FROM EMPLOYEETITLES;

    DELETE
    FROM JOBTITLES;

    DELETE
    FROM EMAILS;

    DELETE
    FROM EMPLOYEES;

    INSERT INTO EMPLOYEES (EMPLOYEEID, NAME, SALARY, CREATED_BY, CREATED_DATE, LAST_MODIFIED_BY, LAST_MODIFIED_DATE)
        VALUES (1, 'CINNAMON', 80000.00, 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP),
               (2, 'BARNBARN', 80000.00, 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP),
               (3, 'JOHN', 75000.00, 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP);

    INSERT INTO EMAILS (EMAILID, EMAIL, EMPLOYEEID, CREATED_BY, CREATED_DATE, LAST_MODIFIED_BY, LAST_MODIFIED_DATE)
        VALUES (1, '[email protected]', 1, 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP),
               (2, '[email protected]', 1, 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP),
               (3, '[email protected]', 2, 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP);

    INSERT INTO JOBTITLES (JOBTITLEID, TITLE, CREATED_BY, CREATED_DATE, LAST_MODIFIED_BY, LAST_MODIFIED_DATE)
        VALUES (1, 'Big Boss', 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP),
               (2, 'Wizard', 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP);

    INSERT INTO EMPLOYEETITLES (EMPLOYEEID, JOBTITLEID, MANAGER, CREATED_BY, CREATED_DATE, LAST_MODIFIED_BY, LAST_MODIFIED_DATE)
        VALUES (1, 1, 'MOJO', 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP),
               (1, 2, 'STUBS', 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP),
               (2, 2, 'MOJO', 'SYSTEM', CURRENT_TIMESTAMP, 'SYSTEM', CURRENT_TIMESTAMP);

    /*
    Must tell hibernate of the id numbers already used.
    The number after with must be greater than the highest number id assigned.
     */
    alter sequence hibernate_sequence restart with 15;

\- And now you will have auditing data using data.sql!

------------------------------------------------------------------------

#### Learn to use SQL, JPA and Hibernate to perform custom data manipulation operations on a RDBMS through a Spring Application

<span id="Data_Manipulation_using_SQL"></span>

##### Overview

-   See the Github Repository [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git) for the code used in the objective.

### Software Needed

-   Java Development Kit (JDK) - at least version 11
-   JetBrains IntelliJ IDEA IDE
-   Postman

### Modifying Custom Queries

Sometimes we need to use custom queries to update data. This is especially true as our entity relationships get more complicated. For an example of this, let’s write a custom query to update, change, the Job Title title field without affecting any other data or relationships in the database.

First, let’s write the query to make sure it does what we want

    UPDATE jobtitles
    SET title = :ititle,
        last_modified_by = :uname,
        last_modified_date = CURRENT_TIMESTAMP
    WHERE jobtitleid = :jobtitleid

Note that the variables starting with a `:` are parameters we will get from Java. So we are

-   Updating the `jobtitles` table
-   Setting
    -   `title` field to a new one coming from Java
    -   we are modifying the row outside of Spring Data JPA, so we need to manually update the modified auditing fields
        -   `last_modified_by` is set to a username coming from Java
        -   `last_modified_date` is set from the system date
-   Updating row where `jobtitleid` = some id coming from Java

##### Follow Along

We are continuing taking the repo [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_create\_delete\_update](https://github.com/LambdaSchool/java-sampleemps.git) and transforming it into the repo [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git) step by step! So, from the following, make the necessary changes to the code you are working through for this Module.

Since this is related to the `JobTitle` table, let’s put this custom query in the `JobTitleRepository`.

    /* ...more code... */
        @Transactional
        @Modifying
        @Query(value = "UPDATE jobtitles SET title = :ititle, last_modified_by = :uname, last_modified_date = CURRENT_TIMESTAMP WHERE jobtitleid = :jobtitleid\n",
            nativeQuery = true)
        void updateJobTitle(
            String uname,
            long jobtitleid,
            String title);
    /* ...more code... */

Some notes on the query

-   `@Transactional` - we are changing data in the database so best practice says to make the operation transactional.
-   `@Modifying` - by default, a query can only read, and not manipulate, data. We have to override that behavior with this annotation.
-   `@Query` is the notation that says we are doing a query.
    -   `@Query` takes some attributes
        -   `value` is the actual query in String form. Yes, the query has to be all on one line!
        -   `nativeQuery = true` means the query will be using the actual database names of things. A preference of mine.
            -   native queries are usually faster
            -   can lose portability to other databases if care is not taken in naming conventions, which of course we do take care in class!
    -   The Query returns nothing, hence the void. To invoke the query we call the method updateJobTitle with three parameters:
        -   `uname` - the username of who is updating the date
        -   `jobtitleid` - the primary key of the row to update
        -   `title` - the new job title
        -   Note that like in controllers, these parameters match with the parameters in the query by NAME. So, `uname` goes with `:uname`!

Now let’s use our new query. We use it like we use any regular CRUD method from our repository. We make a service call and a controller method for our clients!

-   Create the services.JobTitleServices class

<!-- -->

    package com.lambdaschool.sampleemps.services;

    import com.lambdaschool.sampleemps.models.JobTitle;

    public interface JobTitleService
    {
        JobTitle update(
            long id,
            JobTitle jt);
    }

-   Create the services.JobTitleServiceImpl class

<!-- -->

    package com.lambdaschool.sampleemps.services;

    import com.lambdaschool.sampleemps.models.JobTitle;
    import com.lambdaschool.sampleemps.repositories.EmployeeRepository;
    import com.lambdaschool.sampleemps.repositories.JobTitleRepository;
    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.stereotype.Service;
    import org.springframework.transaction.annotation.Transactional;

    import javax.persistence.EntityExistsException;
    import javax.persistence.EntityNotFoundException;

    @Transactional
    @Service(value = "jobtitleSerivce") // needed to name this implementation as the service to use
    public class JobTitleServiceImpl
            implements JobTitleService
    {
        @Autowired
        private EmployeeRepository employeerepos;

        @Autowired
        private JobTitleRepository jtrepos;

        @Transactional
        @Override
        public JobTitle update(
            long id,
            JobTitle jt)
        {
            if (jt.getTitle() == null)
            {
                throw new EntityNotFoundException("No Title found to update!");
            }

            if (jt.getEmpnames()
                .size() > 0)
            {
                throw new EntityExistsException("Employees are not updated through Job Titles");
            }

            jtrepos.findById(id)
                .orElseThrow(() -> new EntityNotFoundException("Job Title id " + id + " not found!"));

            jtrepos.updateJobTitle("SYSTEM",
                id,
                jt.getTitle());
            return jtrepos.findById(id)
                .orElseThrow(() -> new EntityNotFoundException("Job Title id " + id + " not found!"));
        }
    }

-   This requires some explanation:
    -   First we check to make sure that a Job Title actually comes across from the client
    -   Then we make sure no Employees were sent with the Job Title object. We add Job Titles to Employees through another endpoint.
    -   Now we check to make sure we have a valid Job Title Id.
    -   If all that works, we invoke the update query
    -   Finally we find again the Job Title object in order to get a good Job Title object with the newly updated Job Title and return that Job Title object
-   Create the controllers.JobTitleController class

<!-- -->

    package com.lambdaschool.sampleemps.controllers;

    import com.lambdaschool.sampleemps.models.JobTitle;
    import com.lambdaschool.sampleemps.services.JobTitleService;
    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.http.HttpStatus;
    import org.springframework.http.ResponseEntity;
    import org.springframework.web.bind.annotation.PatchMapping;
    import org.springframework.web.bind.annotation.PathVariable;
    import org.springframework.web.bind.annotation.PutMapping;
    import org.springframework.web.bind.annotation.RequestBody;
    import org.springframework.web.bind.annotation.RequestMapping;
    import org.springframework.web.bind.annotation.RestController;

    import javax.validation.Valid;

    @RestController
    @RequestMapping("/jobtitles")
    public class JobTitleController
    {
        @Autowired
        JobTitleService jtService;

        @PutMapping(value = "/jobtitle/{jobtitleid}",
                consumes = {"application/json"})
        public ResponseEntity<?> putUpdateJobTitle(
                @PathVariable
                        long jobtitleid,
                @Valid
                @RequestBody
                        JobTitle newJT)
        {
            newJT = jtService.update(jobtitleid,
                                     newJT);
            return new ResponseEntity<>(HttpStatus.OK);
        }


        @PatchMapping(value = "/jobtitle/{jobtitlesid}",
                consumes = {"application/json"})
        public ResponseEntity<?> patchUpdateJobTitle(
                @PathVariable
                        long jobtitlesid,
                @RequestBody
                        JobTitle newJT)
        {
            newJT = jtService.update(jobtitlesid,
                                     newJT);
            return new ResponseEntity<>(HttpStatus.OK);
        }
    }

-   Some explanation
    -   The body for each of these endpoints would look the same
    -   In this case since there is only 1 field to update, PUT and PATCH do exactly the same thing. I decided to provide both to prevent the client from having to remember which one is implemented.

You can use the following JSON to test the endpoints

    {
      "title":"Lizard"
    }

##### Challenge

Let’s try adding some code on our own. You will need to find the appropriate code from the provided repository and add it to your own application.

A combination of custom Read queries and custom Modify queries are used to update the Many To Many relationship between Employee and JobTitle. You can see this code in action in the sampleemps\_data\_modeling application. The flow of this process is this. Since Employee is our driving table, I am putting this work with the methods for Employees

-   services.EmployeeService gets the methods to delete or add an employee job title combination
    -   deleteEmpJobTitle, addEmpJobTitle
    -   Both takes two parameters, the employee id and role id of the combination to delete or add
-   services.EmployeeServiceImpl
    -   Implements the deleteEmpJobTitle and addEmpJobTitle methods with this process
        -   Verify that the employee id is valid
        -   Verify that the job title id is valid
        -   Using a custom query, verify that the employee job title combinations
            -   exists when doing a delete. We must have something to delete!
            -   does not exist when doing an add. We don’t want duplicate combinations!
        -   Once all has been verified, use a custom query to actually perform the delete or add
-   controller.EmployeeController
    -   We need a way for clients to delete or add the employee job title combination.
    -   We get the ids through path variables
    -   see methods deleteEmployeeJobTitlesByid and addEmployeeJobTitlesByid
-   For the above we made use of three custom queries, all of which are located in repositories.EmployeeRepository
    -   checkEmpJobTitleCombo
        -   Counts the number of the given employee job titles combinations in the database
        -   Uses the interface views.JustTheCount
    -   deleteEmployeeJobTitleCombo
        -   deletes the combination of the given employee id and job title id
    -   insertEmployeeJobTitleCombo
        -   inserts the given combination of the given employee id and job title id
        -   initializes the audit fields with the username sent to the query and the current system date

------------------------------------------------------------------------

#### Learn to implement default Swagger documentation

<span id="Swagger"></span>

##### Overview

-   See the Github Repository [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git) for the code used in the objective.

### Software Needed

-   Java Development Kit (JDK) - at least version 11
-   JetBrains IntelliJ IDEA IDE
-   Postman

The point of our Web REST API Applications is to provide endpoints that allow clients to work with our data. But how do those clients know what our endpoints are and how to use them? We need to provide them documentation. One automated way to do this is through the Swagger system. Let’s implement Swagger and see the corresponding documentation!

##### Follow Along

-   Swagger is implemented through a few dependencies. We are adding three. One is the base Swagger dependency. Another implements the Swagger user interface. And the third on connects Swagger to our validation constraints. Let’s add those to our POM.XML

<!-- -->

            <!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 -->
            <dependency>
                <groupId>io.springfox</groupId>
                <artifactId>springfox-swagger2</artifactId>
                <version>2.9.2</version>
            </dependency>

            <!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui -->
            <dependency>
                <groupId>io.springfox</groupId>
                <artifactId>springfox-swagger-ui</artifactId>
                <version>2.9.2</version>
            </dependency>

            <dependency>
                <groupId>io.springfox</groupId>
                <artifactId>springfox-bean-validators</artifactId>
                <version>2.9.2</version>
            </dependency>

-   Now we need to add a configuration file to connect Swagger to Spring. The file being added is config.Swagger2Config. We are using Swagger Version 2. This version is the most straightforward to configure and is the most mature, stable version of Swagger.
    -   This class is boilerplate code we can add to any project where we want Swagger documentation. We do have a few items to customize to our application.

<!-- -->

    /* ...some code ... */
    @Configuration // annotation to tell Spring this is a configuration file
    @EnableSwagger2 // annotation to enable Swagger
    @Import(BeanValidatorPluginsConfiguration.class) // connects our validation constraints to this configuration class
    public class Swagger2Config
    {
        @Bean
        public Docket api()
        {
            return new Docket(DocumentationType.SWAGGER_2)
                .select()
                .apis(RequestHandlerSelectors
                    .basePackage("com.lambdaschool.sampleemps"))
                .paths(PathSelectors.regex("/.*"))
                .build()
                .apiInfo(apiEndPointsInfo());
        }

        private ApiInfo apiEndPointsInfo()
        {
            return new ApiInfoBuilder().title("Sample Employees Project")
                .description("A Project Used to Introduce Swagger Documentation")
                .contact(new Contact("John Mitchell",
                    "http://www.lambdaschool.com",
                    "[email protected]"))
                .license("MIT")
                .licenseUrl("https://github.com/LambdaSchool/java-sampleemps/blob/master/LICENSE")
                .version("1.0.0")
                .build();
        }
    }

-   In the method `api()` we must set the `.basePackage` to be the base package of our application. In our current example that is `com.lambdaschool.sampleemps`
-   In the method `apiEndPointsInfo()` we set
    -   `.title("")` - A general short title of our application
    -   `.description("")` - A longer more descriptive explanation of our application
    -   `.contact()` - you can add only one contact for the application
    -   `.license("")` - at Lambda School we prefer the MIT license but any string will work
    -   `.licenseUrl("")` - at link to the text for your license agreement
    -   `.version("")` - any string is fine but is meant to convey a version number to the client

That is all we need to set up to generate Swagger documentation. Swagger uses our class names, method names, parameters, and annotations to generate default documentation. If we have named everything using a reasonable naming convention, then we get reasonable Swagger documentation!

Annotations exist to customize your Swagger documentation but this is beyond the scope of this class :-(

One you are done, the Swagger Documentation generated for our sample application can be found at

<http://localhost:2019/swagger-ui.html>l

with `/swagger-ui` being the default endpoint. If you fully expand all options on this page, you can generate the following PDF of the documentation:

[Click Here Swagger Documentation PDF](https://drive.google.com/open?id=1EijscrIhpv6lbnSbLXcaH7NeLFCEpI2l)

You can also generate a full JSON representation of the documentation. You surf to the following URL. Expand to see the resulting JSON.

http://localhost:2019/v2/api-docs

    {
        "swagger": "2.0",
        "info": {
            "description": "A Project Used to Introduce Swagger Documentation",
            "version": "1.0.0",
            "title": "Sample Employees Project",
            "contact": {
                "name": "John Mitchell",
                "url": "http://www.lambdaschool.com",
                "email": "[email protected]"
            },
            "license": {
                "name": "MIT",
                "url": "https://github.com/LambdaSchool/java-sampleemps/blob/master/LICENSE"
            }
        },
        "host": "localhost:2019",
        "basePath": "/",
        "tags": [
            {
                "name": "employee-controller",
                "description": "Employee Controller"
            },
            {
                "name": "job-title-controller",
                "description": "Job Title Controller"
            }
        ],
        "paths": {
            "/employees/employee": {
                "post": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "addNewEmployee",
                    "operationId": "addNewEmployeeUsingPOST",
                    "consumes": [
                        "application/json"
                    ],
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "in": "body",
                            "name": "newEmployee",
                            "description": "newEmployee",
                            "required": true,
                            "schema": {
                                "$ref": "#/definitions/Employee"
                            }
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "201": {
                            "description": "Created"
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        },
                        "404": {
                            "description": "Not Found"
                        }
                    },
                    "deprecated": false
                }
            },
            "/employees/employee/{employeeid}": {
                "put": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "updateFullEmployee",
                    "operationId": "updateFullEmployeeUsingPUT",
                    "consumes": [
                        "application/json"
                    ],
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "name": "employeeid",
                            "in": "path",
                            "description": "employeeid",
                            "required": true,
                            "type": "integer",
                            "format": "int64"
                        },
                        {
                            "in": "body",
                            "name": "updateEmployee",
                            "description": "updateEmployee",
                            "required": true,
                            "schema": {
                                "$ref": "#/definitions/Employee"
                            }
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "201": {
                            "description": "Created"
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        },
                        "404": {
                            "description": "Not Found"
                        }
                    },
                    "deprecated": false
                },
                "delete": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "deleteEmployeeById",
                    "operationId": "deleteEmployeeByIdUsingDELETE",
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "name": "employeeid",
                            "in": "path",
                            "description": "employeeid",
                            "required": true,
                            "type": "integer",
                            "format": "int64"
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "204": {
                            "description": "No Content"
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        }
                    },
                    "deprecated": false
                },
                "patch": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "updateEmployee",
                    "operationId": "updateEmployeeUsingPATCH",
                    "consumes": [
                        "application/json"
                    ],
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "name": "employeeid",
                            "in": "path",
                            "description": "employeeid",
                            "required": true,
                            "type": "integer",
                            "format": "int64"
                        },
                        {
                            "in": "body",
                            "name": "updateEmployee",
                            "description": "updateEmployee",
                            "required": true,
                            "schema": {
                                "$ref": "#/definitions/Employee"
                            }
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "204": {
                            "description": "No Content"
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        }
                    },
                    "deprecated": false
                }
            },
            "/employees/employeeemail/{subemail}": {
                "get": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "listEmployeesWithEmail",
                    "operationId": "listEmployeesWithEmailUsingGET",
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "name": "subemail",
                            "in": "path",
                            "description": "subemail",
                            "required": true,
                            "type": "string"
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        },
                        "404": {
                            "description": "Not Found"
                        }
                    },
                    "deprecated": false
                }
            },
            "/employees/employeename/{subname}": {
                "get": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "listEmployeesWithName",
                    "operationId": "listEmployeesWithNameUsingGET",
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "name": "subname",
                            "in": "path",
                            "description": "subname",
                            "required": true,
                            "type": "string"
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        },
                        "404": {
                            "description": "Not Found"
                        }
                    },
                    "deprecated": false
                }
            },
            "/employees/employees": {
                "get": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "listAllEmployees",
                    "operationId": "listAllEmployeesUsingGET",
                    "produces": [
                        "*/*"
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        },
                        "404": {
                            "description": "Not Found"
                        }
                    },
                    "deprecated": false
                }
            },
            "/employees/job/counts": {
                "get": {
                    "tags": [
                        "employee-controller"
                    ],
                    "summary": "getEmpJobCounts",
                    "operationId": "getEmpJobCountsUsingGET",
                    "produces": [
                        "*/*"
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        },
                        "404": {
                            "description": "Not Found"
                        }
                    },
                    "deprecated": false
                }
            },
            "/jobtitles/jobtitle/{jobtitleid}": {
                "put": {
                    "tags": [
                        "job-title-controller"
                    ],
                    "summary": "putUpdateJobTitle",
                    "operationId": "putUpdateJobTitleUsingPUT",
                    "consumes": [
                        "application/json"
                    ],
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "name": "jobtitleid",
                            "in": "path",
                            "description": "jobtitleid",
                            "required": true,
                            "type": "integer",
                            "format": "int64"
                        },
                        {
                            "in": "body",
                            "name": "newJT",
                            "description": "newJT",
                            "required": true,
                            "schema": {
                                "$ref": "#/definitions/JobTitle"
                            }
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "201": {
                            "description": "Created"
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        },
                        "404": {
                            "description": "Not Found"
                        }
                    },
                    "deprecated": false
                }
            },
            "/jobtitles/jobtitle/{jobtitlesid}": {
                "patch": {
                    "tags": [
                        "job-title-controller"
                    ],
                    "summary": "patchUpdateJobTitle",
                    "operationId": "patchUpdateJobTitleUsingPATCH",
                    "consumes": [
                        "application/json"
                    ],
                    "produces": [
                        "*/*"
                    ],
                    "parameters": [
                        {
                            "name": "jobtitlesid",
                            "in": "path",
                            "description": "jobtitlesid",
                            "required": true,
                            "type": "integer",
                            "format": "int64"
                        },
                        {
                            "in": "body",
                            "name": "newJT",
                            "description": "newJT",
                            "required": true,
                            "schema": {
                                "$ref": "#/definitions/JobTitle"
                            }
                        }
                    ],
                    "responses": {
                        "200": {
                            "description": "OK",
                            "schema": {
                                "type": "object"
                            }
                        },
                        "204": {
                            "description": "No Content"
                        },
                        "401": {
                            "description": "Unauthorized"
                        },
                        "403": {
                            "description": "Forbidden"
                        }
                    },
                    "deprecated": false
                }
            }
        },
        "definitions": {
            "Email": {
                "type": "object",
                "properties": {
                    "createdBy": {
                        "type": "string"
                    },
                    "createdDate": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "email": {
                        "type": "string"
                    },
                    "emailid": {
                        "type": "integer",
                        "format": "int64"
                    },
                    "employee": {
                        "$ref": "#/definitions/Employee"
                    },
                    "lastModifiedBy": {
                        "type": "string"
                    },
                    "lastModifiedDate": {
                        "type": "string",
                        "format": "date-time"
                    }
                },
                "title": "Email"
            },
            "Employee": {
                "type": "object",
                "properties": {
                    "createdBy": {
                        "type": "string"
                    },
                    "createdDate": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "emails": {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/Email"
                        }
                    },
                    "employeeid": {
                        "type": "integer",
                        "format": "int64"
                    },
                    "hasvalueforsalary": {
                        "type": "boolean"
                    },
                    "jobnames": {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/EmployeeTitles"
                        }
                    },
                    "lastModifiedBy": {
                        "type": "string"
                    },
                    "lastModifiedDate": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "name": {
                        "type": "string"
                    },
                    "salary": {
                        "type": "number",
                        "format": "double"
                    }
                },
                "title": "Employee"
            },
            "EmployeeTitles": {
                "type": "object",
                "properties": {
                    "createdBy": {
                        "type": "string"
                    },
                    "createdDate": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "emp": {
                        "$ref": "#/definitions/Employee"
                    },
                    "jobname": {
                        "$ref": "#/definitions/JobTitle"
                    },
                    "lastModifiedBy": {
                        "type": "string"
                    },
                    "lastModifiedDate": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "manager": {
                        "type": "string"
                    }
                },
                "title": "EmployeeTitles"
            },
            "JobTitle": {
                "type": "object",
                "properties": {
                    "createdBy": {
                        "type": "string"
                    },
                    "createdDate": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "empnames": {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/EmployeeTitles"
                        }
                    },
                    "jobtitleid": {
                        "type": "integer",
                        "format": "int64"
                    },
                    "lastModifiedBy": {
                        "type": "string"
                    },
                    "lastModifiedDate": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "title": {
                        "type": "string"
                    }
                },
                "title": "JobTitle"
            }
        }
    }

##### Dig Deeper

-   [Spring Boot RESTful API Documentation with Swagger 2](https://springframework.guru/spring-boot-restful-api-documentation-with-swagger-2/)  
    Spring Boot RESTful API Documentation with Swagger 2
-   [Documenting Spring Boot REST API with Swagger and SpringFox](https://www.vojtechruzicka.com/documenting-spring-boot-rest-api-swagger-springfox/)  
    Documenting Spring Boot REST API with Swagger and SpringFox
-   [A different approach](https://www.baeldung.com/spring-rest-openapi-documentation)  
    A different approach - Documenting a Spring REST API Using OpenAPI 3.0

------------------------------------------------------------------------

#### Learn to print the default Swagger documentation

<span id="Printing_Swagger"></span>

##### Overview

-   See the Github Repository [https://github.com/LambdaSchool/java-sampleemps.git/sampleemps\_data\_modeling](https://github.com/LambdaSchool/java-sampleemps.git) for the code used in the objective.

### Software Needed

-   Java Development Kit (JDK) - at least version 11
-   JetBrains IntelliJ IDEA IDE
-   Postman

Once we have Swagger documentation enabled, clients can access it online. However making a printed form of the documentation available is often required. Here are ways to generate a couple of popular formats for the documentation.

##### Follow Along

### Getting Started

-   Surf to the site <https://editor.swagger.io/>
-   On the site, goto the pull down menu `File` -> `Clear Editor`
-   With your application running, surf to the Swagger JSON endpoint. In our example it is  
    <http://localhost:2019/v2/api-docs>.  
    This will generate the JSON for the Swagger documentation for your application
-   Select all of the generate JSON and copy it.
-   Back on the editor.swagger.io site, paste the JSON into the editor by clicking in the editor and doing a paste.
    -   You will be prompted with “Would you like convert your JSON into YAML?”. Click OK.
    -   If after pasting, error messages show at the top of your generated documentation, you can usually just collapse the section where the errors appear and ignore them.
-   What we want to do next is Generate Clients that have the format we desire.

### Generating markdown files

-   To generate markdown (\*.md) files
    -   Goto `Generate Client` -> `bash`
    -   This will download a file called `bash-client-generated.zip` Unzip, expand, this file
-   You now have a new folder called `bash-client`
    -   A sub folder of `bash-client` is `docs` and contains all of the markdown files for each section of your application
        -   One file for each model, entity
        -   One file for each controller

### Generating a PDF

-   To generate a single PDF file of all your documentation
    -   Goto `Generate Client` -> `html`
    -   This will download a file `html-client-generated.zip` Unzip, expand, this file
    -   You now have a new folder called `html-client`
-   Under that folder, you have a file called `index.html`
    -   Open that file in a browser. I am using Chrome and the rest of the instructions work on Chrome. You will have research how your favorite works.
    -   You now all of your documentation in a single browser window. We can print this document to a PDF and be done
        -   Right click in the browser window
        -   From the context menu, select `Print`
        -   For you Destination, select `Save as PDF`.
        -   The rest of the options are up to you!
        -   Click save and give your new PDF documentation a name.
        -   Now distribute that PDF to your clients!

Alternatively, you can expand all sections from the website  
<http://localhost:2019/swagger-ui.html>  
And then print that browser window to a PDF. This gives the following pdf documentation  
[Click Here Swagger Documentation PDF](https://drive.google.com/open?id=1EijscrIhpv6lbnSbLXcaH7NeLFCEpI2l)  
This method does require more work than the previous example and is up to you as to what you wish to give your clients!

##### Dig Deeper

-   [Swagger Editor](https://editor.swagger.io/)  
    https://editor.swagger.io/

------------------------------------------------------------------------

## <a href="#guided-project" id="guided-project" class="anchor"><span class="octicon octicon-link"></span></a>Guided Project

### java-usermodel

We are continuing our study of Relational Database Design and custom queries. We need the usermodel - initial application from this repo. The guided project starts with this application and works toward the usermodel - final application.

[GitHub Repo](https://github.com/LambdaSchool/java-usermodel.git)

------------------------------------------------------------------------

## <a href="#project" id="project" class="anchor"><span class="octicon octicon-link"></span></a>Project

-   ##### [java-zoos](https://github.com/LambdaSchool/java-zoos.git)

## <a href="#review" id="review" class="anchor"><span class="octicon octicon-link"></span></a>Review

### Class Recordings

You can use class recordings to help you master the material.

-   **[Java Auditing Fields for WEB33 with John Mitchell](https://youtu.be/oxOPY68e_Cs)**
-   [All previous recordings](/archive/WEB4Java/module/rec2oQCFWOVShtxIx)

### Demonstrate Mastery

To demonstrate mastery of this module, you need to complete and pass a code review on each of the following:

-   Objective challenge:

    Let’s try adding some code on our own. You will need to find the appropriate code from the provided repository and add it to your own application.

    A combination of custom Read queries and custom Modify queries are used to update the Many To Many relationship between Employee and JobTitle. You can see this code in action in the sampleemps\_data\_modeling application. The flow of this process is this. Since Employee is our driving table, I am putting this work with the methods for Employees

    -   services.EmployeeService gets the methods to delete or add an employee job title combination
        -   deleteEmpJobTitle, addEmpJobTitle
        -   Both takes two parameters, the employee id and role id of the combination to delete or add
    -   services.EmployeeServiceImpl
        -   Implements the deleteEmpJobTitle and addEmpJobTitle methods with this process
            -   Verify that the employee id is valid
            -   Verify that the job title id is valid
            -   Using a custom query, verify that the employee job title combinations
                -   exists when doing a delete. We must have something to delete!
                -   does not exist when doing an add. We don’t want duplicate combinations!
            -   Once all has been verified, use a custom query to actually perform the delete or add
    -   controller.EmployeeController
        -   We need a way for clients to delete or add the employee job title combination.
        -   We get the ids through path variables
        -   see methods deleteEmployeeJobTitlesByid and addEmployeeJobTitlesByid
    -   For the above we made use of three custom queries, all of which are located in repositories.EmployeeRepository
        -   checkEmpJobTitleCombo
            -   Counts the number of the given employee job titles combinations in the database
            -   Uses the interface views.JustTheCount
        -   deleteEmployeeJobTitleCombo
            -   deletes the combination of the given employee id and job title id
        -   insertEmployeeJobTitleCombo
            -   inserts the given combination of the given employee id and job title id
            -   initializes the audit fields with the username sent to the query and the current system date

-   Guided Project: java-usermodel

-   Project: java-zoos
