<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Intended as a home for Lambda School curriculum.">
<meta name="author" content="">
<meta name="generator" content="Jekyll v3.8.0">
<title>Java - Exception Handling · Lambda School</title>

<link rel='stylesheet' integrity crossorigin='anonymous' href='https://d33wubrfki0l68.cloudfront.net/css/0f99ed215b3d52fa1bee44dc614ea3fa1d1bebc0/dist/css/bootstrap.min.css' />

<link href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" rel="stylesheet">
<link rel='stylesheet' href='https://d33wubrfki0l68.cloudfront.net/css/1bf8317b3d6d0c9d813c92505f052bf79ffdcdfe/assets/css/docs.min.css' />

<link rel='stylesheet' href='https://d33wubrfki0l68.cloudfront.net/css/f3626ab7ab84821f8b60ea92b4a5c6acf59991af/assets/css/main.css' />

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-122016605-1', 'learn.lambdaschool.com');
  ga('send', 'pageview');
</script>



<link rel="apple-touch-icon" href="/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/assets/img/favicons/manifest.json">
<link rel="mask-icon" href="/assets/img/favicons/safari-pinned-tab.svg" color="#a0001e">
<link rel="icon" href="/favicon.ico">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#a0001e">
</head>
<body>
<noscript>Please enable JavaScript to view this page.</noscript>
<div id="redirect-message" style="display: none;">
You must be logged in to view this page.
</div>
<div id="unauthorized-message" style="display: none;">
You must be a Lambda School student to view this page.
</div>
<div id="content-wrapper" style="visibility: hidden;">
<a id="skippy" class="sr-only sr-only-focusable" href="#content">
<div class="container">
<span class="skiplink-text">Skip to main content</span>
</div>
</a>
<div class="mobile-menu">
<div class="m-drop">
<div class="mobile-row">
<div class="header-row" style="padding: 3px 7px">
<a class="navbar-brand" href="/" aria-label="Lambda School"><svg xmlns="http://www.w3.org/2000/svg" width="33" height="35" viewBox="0 0 33 35" fill="none">
<path fill-rule="evenodd" clip-rule="evenodd" d="M0 0V16.0609C0 27.7335 9.08929 31.7843 15.7321 34.7513H15.75L16.2857 35C16.4107 34.9289 16.5357 34.8756 16.6786 34.8223C16.75 34.7868 16.8393 34.7513 16.9107 34.7157C23.5714 31.7665 32.6964 27.698 32.6964 16.0609V0H0ZM20.7071 23.4536L20.3571 22.5102L15.6071 10.0736C15.3214 10.802 14.6607 12.5609 13.9464 14.4442L11.2143 21.7817C11.0893 22.1371 11.1607 22.3147 11.25 22.4391C11.4464 22.6701 11.8768 22.6701 12.5554 22.6701H12.6786L12.6768 23.4518H7.56964V22.6701H7.9625C8.65893 22.6701 9.23036 22.368 9.65893 21.5152L10.1768 20.3426L14.9089 8.29696L14.0696 6.07614H18.4804L24.5696 22.0127L25.125 23.4536H20.7071Z" fill="#EC3944" />
</svg></a>
<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mobile-course-menu" aria-controls="mobile-course-menu" aria-expanded="false" aria-label="Toggle navigation">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"></path></svg>
</button>
</div>
</div>
<div class="nav-row">
<div class="results-container">
<ul id="results-container" class="dropdown list-group"></ul>
</div>
<div id="mobile-course-menu" class="collapse nav-row">
<div class="docs-mobile-sidebar" id="bd-docs-nav-mobile">
<nav class="bd-links">
<div class="bd-toc-item">
<h4 class="bd-toc-link">Web API: Java</h4>
</div>

<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recnLDyTtONLTMiFJ">
1.&nbsp;&nbsp;Java Precourse Information
</a>
<ul class="nav bd-sidenav">

<li>
<a href="/web4java/module/recfnUAvFbeyIAHib/">
Welcome to Java Spring
</a>
</li>
<li>
<a href="/web4java/module/recjH0lMflsFIVzDM/">
Java Spring Course Table of Contents
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recoJ4ZqNQWX3cy6E">
2.&nbsp;&nbsp;Java Fundamentals
</a>
<ul class="nav bd-sidenav">

<li>
<a href="/web4java/module/recAGVTYNZyJbEFpu/">
Java - JDK and Java Classes
</a>
</li>
<li>
<a href="/web4java/module/rec6Hrk77HupYeoN5/">
Java Interfaces, Abstract Classes, Lambda Expression
</a>
</li>
<li>
<a href="/web4java/module/recyJ663TrxVgpqY9/">
Java - RDBMS and SQL Basics
</a>
</li>
<li>
<a href="/web4java/module/recqtftA9E98qpbak/">
Java - Intro to Maven, Spring, and Tomcat Using REST API
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recRVUSWQEtosl0Cz">
3.&nbsp;&nbsp;RDBMS and Intro to APIs
</a>
<ul class="nav bd-sidenav">

<li>
<a href="/web4java/module/recb0OVmRrJzqhH4D/">
Java - Spring Database Creation Including Seed Data
</a>
</li>
<li>
<a href="/web4java/module/rec3THcdjv8BumGCt/">
Java - Read Data using CRUD Operations
</a>
</li>
<li>
<a href="/web4java/module/recJihkiNn2KH2nEW/">
Java - Inserting Deleting and Updating Data using CRUD Operations
</a>
</li>
<li>
<a href="/web4java/module/rec2oQCFWOVShtxIx/">
Java - Data Modeling and Auditing Fields with custom querying
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recSqm5AAEkJcIl3p">
4.&nbsp;&nbsp;Java Frameworks
</a>
<ul class="nav bd-sidenav">

<li class="active bd-sidenav-active">
<a href="/web4java/module/rec3E1WYDyoiEF1e3/">
Java - Exception Handling
</a>
</li>
<li>
<a href="/web4java/module/rececDV2OMIUcY2eH/">
Java - User Authentication
</a>
</li>
<li>
<a href="/web4java/module/recDboXln5wm4aKJt/">
Java - Automated Testing
</a>
</li>
<li>
<a href="/web4java/module/rec7pCiBPzI4DkAJT/">
Java - Java Deployment and Best Practices
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recC5dhR9menaROwx">
5.&nbsp;&nbsp;WEB Unit 4 Java Build
</a>
<ul class="nav bd-sidenav">

</ul>
</div>
<hr>
</nav>
</div>
</div>
</div>
</div>
</div>
<div class="main-container">
<div class="sidebar-container bd-sidebar">
<div class="docs-sidebar">
<a class="navbar-brand" href="/" aria-label="Lambda School"><svg width="135" height="35" viewBox="0 0 756 197" fill="#ec3944"><g><path d="M292.9,126.6h-6.7c-9,0-12.6-1.9-12.6-9.5V48.5c0-7.7,1.6-8.6,11.4-9.7v-4.5h-41.3v4.5 c9.8,1.1,11.4,1.9,11.4,9.7v69.3c0,7.7-1.6,8.6-11.4,9.7v4.5h73.7l4.9-29.4h-4.4C308.5,119.6,303.9,126.6,292.9,126.6z"></path><path d="M385.5,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1l0.1-0.1l0,0V132h26v-4.4C387.7,127.1,385.5,126.2,385.5,121.1z M368,117.8 c-4.4,3.3-7.6,5.3-12,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4V117.8L368,117.8z"></path><path d="M514.4,121V79.5c0-14.8-6-22.4-18.7-22.4c-11.5,0-19.4,6.6-25.5,13.9c-1.8-9.6-7.7-13.9-17.8-13.9 c-11.4,0-18.7,6.2-24.8,13.6V57h-2.3l-23.8,7.4v2.4l8.6,5v49.4c0,5-2.1,6.1-8.9,6.4v4.4h35.1v-4.4c-6.7-0.3-8.7-1.3-8.7-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7v40.8c0,5-1.9,6.1-8.7,6.4v4.4l34.8,0v-4.4c-6.7-0.3-8.6-1.3-8.6-6.4v-47 c4.7-3.6,9.5-6.5,15.5-6.5c7.6,0,10.5,4.2,10.5,12.7l-0.1,40.5c0,5-1.8,6.4-8.6,6.7l0,4.4h35.1v-4.4 C516.7,127.4,514.4,126.1,514.4,121z"></path><path d="M573.2,57.3c-11,0-18.5,5.7-23.4,12.8V22.9h-2.7l-23.4,6.8v2.5l8.6,4.5V132h2.9l8-3.5c5.8,3.3,12.3,5,20.2,5 c20.8,0,37.4-15.8,37.4-42.6C600.9,69.9,590.4,57.3,573.2,57.3z M563.4,128.7c-5.4,0-10.3-2.4-13.7-7.9V73.6 c3.4-3.4,8.5-5.7,13.5-5.7c13.9,0,20,12.8,20,29.5C583.3,114.7,575.8,128.5,563.4,128.7z"></path><path d="M677,121.2V22.8h-2.6L651,29.6V32l8.6,4.5v25.7c-3.4-3.2-8.8-5.1-15.5-5.1c-19.9,0-35.2,15.3-35.2,41.3 c0,20.7,11.2,34.6,28.1,34.6c9.8,0,17-5.3,22.6-13.1v0.9V132h26.3l0-4.4C679.1,127.3,677,126.3,677,121.2z M659.6,117.1 L659.6,117.1c-3.4,3.4-8,5.1-13.2,5.1c-13.2,0-20.4-12.8-20.4-29.8c0-17.8,7.3-29.2,19.5-29.2c8.7,0,14.1,6.9,14.1,18.3 L659.6,117.1z"></path><path d="M747.1,121.1V79.3c0-15.8-9.4-22.4-26.6-22.4c-15,0-26.8,6.6-26.8,19.3c0,2.4,0.2,3.3,0.8,5h16.6 c-0.5-2-0.7-5-0.7-7.5c0-9.6,3.6-12.4,9.4-12.4c6.4,0,9.7,2,9.7,14.4v11.2l-20.8,7.7c-10.6,4.1-19.3,8.8-19.3,20.7 c0,10.9,7.5,17.8,18.6,17.8c9.9,0,17.4-6.2,21.9-12.1v-0.1h0.1l0,11.1l26,0.1v-4.5C749.3,127.1,747.1,126.2,747.1,121.1z M729.6,117.8c-4.4,3.3-7.6,5.3-12.1,5.4c-7.7,0-11.2-5.2-11.2-12.6c0-7.7,3.6-11.2,9.8-13.5l13.4-5.4L729.6,117.8L729.6,117.8z"></path></g><path d="M0,0v90.4c0,65.7,50.9,88.5,88.1,105.2h0.1l3,1.4c0.7-0.4,1.4-0.7,2.2-1c0.4-0.2,0.9-0.4,1.3-0.6 c37.3-16.6,88.4-39.5,88.4-105V0H0z M116,132l-2-5.3l-26.6-70c-1.6,4.1-5.3,14-9.3,24.6l-15.3,41.3c-0.7,2-0.3,3,0.2,3.7 c1.1,1.3,3.5,1.3,7.3,1.3H71l0,4.4H42.4l0-4.4h2.2c3.9,0,7.1-1.7,9.5-6.5l2.9-6.6l26.5-67.8l-4.7-12.5h24.7l34.1,89.7l3.1,8.1H116z"></path></svg></a>
<ul id="results-container" class="dropdown list-group"></ul>
<nav class="bd-links collapse" id="bd-docs-nav">
<div class="bd-toc-item">
<h4 class="bd-toc-link">Web API: Java</h4>
</div>

<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recnLDyTtONLTMiFJ">
1.&nbsp;&nbsp;Java Precourse Information
</a>
<ul class="nav bd-sidenav">

<li>
<a href="/web4java/module/recfnUAvFbeyIAHib/">
Welcome to Java Spring
</a>
</li>
<li>
<a href="/web4java/module/recjH0lMflsFIVzDM/">
Java Spring Course Table of Contents
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recoJ4ZqNQWX3cy6E">
2.&nbsp;&nbsp;Java Fundamentals
</a>
<ul class="nav bd-sidenav">

<li>
<a href="/web4java/module/recAGVTYNZyJbEFpu/">
Java - JDK and Java Classes
</a>
</li>
<li>
<a href="/web4java/module/rec6Hrk77HupYeoN5/">
Java Interfaces, Abstract Classes, Lambda Expression
</a>
</li>
<li>
<a href="/web4java/module/recyJ663TrxVgpqY9/">
Java - RDBMS and SQL Basics
</a>
</li>
<li>
<a href="/web4java/module/recqtftA9E98qpbak/">
Java - Intro to Maven, Spring, and Tomcat Using REST API
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recRVUSWQEtosl0Cz">
3.&nbsp;&nbsp;RDBMS and Intro to APIs
</a>
<ul class="nav bd-sidenav">

<li>
<a href="/web4java/module/recb0OVmRrJzqhH4D/">
Java - Spring Database Creation Including Seed Data
</a>
</li>
<li>
<a href="/web4java/module/rec3THcdjv8BumGCt/">
Java - Read Data using CRUD Operations
</a>
</li>
<li>
<a href="/web4java/module/recJihkiNn2KH2nEW/">
Java - Inserting Deleting and Updating Data using CRUD Operations
</a>
</li>
<li>
<a href="/web4java/module/rec2oQCFWOVShtxIx/">
Java - Data Modeling and Auditing Fields with custom querying
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recSqm5AAEkJcIl3p">
4.&nbsp;&nbsp;Java Frameworks
</a>
<ul class="nav bd-sidenav">

<li class="active bd-sidenav-active">
<a href="/web4java/module/rec3E1WYDyoiEF1e3/">
Java - Exception Handling
</a>
</li>
<li>
<a href="/web4java/module/rececDV2OMIUcY2eH/">
Java - User Authentication
</a>
</li>
<li>
<a href="/web4java/module/recDboXln5wm4aKJt/">
Java - Automated Testing
</a>
</li>
<li>
<a href="/web4java/module/rec7pCiBPzI4DkAJT/">
Java - Java Deployment and Best Practices
</a>
</li>
</ul>
</div>
<div class="bd-toc-item ">
<a class="bd-toc-link" href="/web4java/sprint/recC5dhR9menaROwx">
5.&nbsp;&nbsp;WEB Unit 4 Java Build
</a>
<ul class="nav bd-sidenav">

</ul>
</div>
<hr>
</nav>
</div>
</div>
<main class="content-container flex-wrapper" role="main">
<div class="sticky-nav">
<div class="sprint-nav">
<ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#prepare">Prepare</a></li>
<li class="toc-entry toc-h2"><a href="#learn">Learn</a></li>
<li class="toc-entry toc-h2"><a href="#guided-project">Guided Project</a></li>
<li class="toc-entry toc-h2"><a href="#project">Project</a></li>
<li class="toc-entry toc-h2"><a href="#review">Review</a></li>
</ul>
</div>

</div>
<div class="wrapper limit-width">
<div class="flex-wrapper">
<div class="limit-width">
<div class="jumbotron">
<h1 class="bd-title" id="content">Java - Exception Handling</h1>
<span class="lead">
<p class="bd-lead"></p>
<style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
<p><a id="Exception_Handling_Overview"></a></p>
</span>
<strong>At the end of this module, you should be able to:</strong>
<ul>
<li>implement industry-standard exception handling including user-friendly exception messages</li>
<li>implement exception handling using a variety of Java constructs</li>
<li>use data validation annotations to verify data prior to processing the data</li>
<li>gather and use data from other APIs</li>
<li>implement custom Swagger Documentation (*** OPTIONAL ***)</li>
</ul>
</div>
<div class="alert alert-warning" role="alert">
<h4>Pro Tip</h4>
<p>A quick temper will make a fool of you soon enough.</p>
<footer class="blockquote-footer"><p>Bruce Lee</p>
</footer>
</div>
<h2 class="display-4">
<a id="prepare" class="anchor" href="#prepare" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prepare</h2>
<p class="lead">Review each preclass resource before class.</p>
<div class="preclass">
<ul class="list-group list-group-flush">
</ul>
</div>
<h2 class="display-4">
<a id="learn" class="anchor" href="#learn" aria-hidden="true"><span class="octicon octicon-link"></span></a>Learn</h2>
<h4 class="mark mb-3 p-2">Learn to implement industry-standard exception handling including user-friendly exception messages</h4>
<p><a id="Exception_Handling"></a></p>
<h5>Overview</h5>
<ul>
<li>See the Github Repository <a href="https://github.com/LambdaSchool/java-exceptionalsampleemps.git">https://github.com/LambdaSchool/java-exceptionalsampleemps.git</a>t for the code used in the objective.</li>
</ul>
<h3 id="software-needed">Software Needed</h3>
<ul>
<li>Java Development Kit (JDK) - at least version 11</li>
<li>JetBrains IntelliJ IDEA IDE</li>
<li>Postman</li>
</ul>
<p><strong>Exceptions</strong> are disruptions to the ordinary flow of the application. Thus when something happens that is an exception to the normal operation of your application, we have an exception! Exceptions can take on many forms</p>
<ul>
<li>Application Error
<ul>
<li>The file, environment variable we seek is not found</li>
<li>The API tries doing an invalid math expression</li>
<li>The API loses accesses to the webserver</li>
</ul>
</li>
<li>User Error
<ul>
<li>Looking for resources that are not available</li>
<li>Using an endpoint that does not exist</li>
<li>Sending the API the wrong data type</li>
</ul>
</li>
<li>Aliens
<ul>
<li>Ok, maybe not aliens. However, there always seems to be some one off situation that causes a weird exception!</li>
</ul>
</li>
</ul>
<p>Spring Boot has a default way of handling exceptions. It does this fairly well. Up until now we have just used the Spring Boot defaults to handle our exceptions. What if we wanted to provide some custom error messages when our program encounters an error? What if we have custom ways we want to handle exceptions that differ from the Spring Boot Default? We will be coding some custom exception handlers below.</p>
<p>Our application experiences two types of exceptions</p>
<ul>
<li>System generated. Something happened we were not excepting. The client sent us a String value when we were expecting an integer. These are handled in this objective.</li>
<li>Thrown exceptions. Something happened we knew might happen so we reported manually by “throwing” an exception. The client looked for a resource that was not available. These are handled in the objective on Java Exception Constructs.</li>
</ul>
<p>When we are writing our custom exception handles we need to handle both types.</p>
<p>We also need a way to report information back to the client in a standard way. In this way, our client need only address one type of error message. We need to let the client know</p>
<ul>
<li>What is the exception</li>
<li>What caused the exception</li>
<li>What time the exception happened</li>
<li>Any data types that are incorrect or missing</li>
<li>Among other information that might vary by exception type.</li>
</ul>
<p>Terminology</p>
<ul>
<li>When an exception happens, it is considered thrown. We throw a ResourceNotFound exception. The system throws a FileNotFound exception.</li>
<li>When we handle an exception, it is considered caught. We will catch any thrown exceptions!</li>
</ul>
<p>So let’s “catch” all possible exceptions and report to the client what happened. Spring Boot will handle continuing the application causing it to wait for the next request!</p>
<p>Note that another reason we look at Exception Handling is here we really take advantage of annotations to control the flow of our programs and the object oriented ness of Java to make our code reusable. So pay particular attention to the flow the application throughout this objective!</p>
<h5>Follow Along</h5>
<p>Open up the application <code class="highlighter-rouge">exceptionalsampleemp-initial</code> from the GitHub Repository <a href="https://github.com/LambdaSchool/java-exceptionalsampleemps.git">https://github.com/LambdaSchool/java-exceptionalsampleemps.git</a>. This application is the same as the application from <a href="https://github.com/LambdaSchool/java-sampleemps.git">https://github.com/LambdaSchool/java-sampleemps.git/sampleemps_data_modeling</a> with the addition of find employee by id endpoints and associated code.</p>
<p>Run the application and surf to these endpoints to see what default exception handling looks like. You can expand each endpoint to see its output</p>
<p>Wrong Data Type: http://localhost:2019/employees/employee/lambda</p>
<pre><code class="language-JSON">{
    "timestamp": "2020-05-20 17:32:14",
    "status": 400,
    "error": "Bad Request",
    "message": "Failed to convert value of type 'java.lang.String' to required type 'long'; nested exception is java.lang.NumberFormatException: For input string: \"lambda\"",
    "trace": "org.springframework.web.method.annotation.MethodArgumentTypeMismatchException: Failed to convert value of type 'java.lang.String' to required type 'long'; nested exception is java.lang.NumberFormatException: For input string: \"lambda\"\n\tat org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:133)\n\tat org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:121)\n\tat org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:167)\n\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:134)\n\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)\n\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)\n\tat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:634)\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:741)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)\n\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)\n\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\n\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)\n\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n\tat java.base/java.lang.Thread.run(Thread.java:834)\nCaused by: java.lang.NumberFormatException: For input string: \"lambda\"\n\tat java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n\tat java.base/java.lang.Long.parseLong(Long.java:692)\n\tat java.base/java.lang.Long.valueOf(Long.java:1144)\n\tat org.springframework.util.NumberUtils.parseNumber(NumberUtils.java:214)\n\tat org.springframework.beans.propertyeditors.CustomNumberEditor.setAsText(CustomNumberEditor.java:115)\n\tat org.springframework.beans.TypeConverterDelegate.doConvertTextValue(TypeConverterDelegate.java:429)\n\tat org.springframework.beans.TypeConverterDelegate.doConvertValue(TypeConverterDelegate.java:402)\n\tat org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:155)\n\tat org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:73)\n\tat org.springframework.beans.TypeConverterSupport.convertIfNecessary(TypeConverterSupport.java:53)\n\tat org.springframework.validation.DataBinder.convertIfNecessary(DataBinder.java:693)\n\tat org.springframework.web.method.annotation.AbstractNamedValueMethodArgumentResolver.resolveArgument(AbstractNamedValueMethodArgumentResolver.java:125)\n\t... 47 more\n",
    "path": "/employees/employee/lambda"
}
</code></pre>
<p>Employee Not Found: http://localhost:2019/employees/employee/9999</p>
<pre><code class="language-JSON">{
    "timestamp": "2020-05-20 17:35:09",
    "status": 500,
    "error": "Internal Server Error",
    "message": "Employee id 9999 not found",
    "trace": "javax.persistence.EntityNotFoundException: Employee id 9999 not found\n\tat com.lambdaschool.sampleemps.services.EmployeeServiceImpl.lambda$findEmployeeById$0(EmployeeServiceImpl.java:35)\n\tat java.base/java.util.Optional.orElseThrow(Optional.java:408)\n\tat com.lambdaschool.sampleemps.services.EmployeeServiceImpl.findEmployeeById(EmployeeServiceImpl.java:35)\n\tat com.lambdaschool.sampleemps.services.EmployeeServiceImpl$$FastClassBySpringCGLIB$$4105708a.invoke(&lt;generated&gt;)\n\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)\n\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:769)\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)\n\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)\n\tat org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:366)\n\tat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:99)\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:747)\n\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:689)\n\tat com.lambdaschool.sampleemps.services.EmployeeServiceImpl$$EnhancerBySpringCGLIB$$b166ea5a.findEmployeeById(&lt;generated&gt;)\n\tat com.lambdaschool.sampleemps.controllers.EmployeeController.getEmployeeById(EmployeeController.java:37)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\n\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)\n\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)\n\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888)\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793)\n\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)\n\tat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:634)\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:741)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526)\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)\n\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:367)\n\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\n\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:860)\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1591)\n\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\n\tat java.base/java.lang.Thread.run(Thread.java:834)\n",
    "path": "/employees/employee/9999"
}
</code></pre>
<p>Invalid endpoint: http://localhost:2019/employees/turtle</p>
<pre><code class="language-JSON">{
    "timestamp": "2020-05-20 17:35:38",
    "status": 404,
    "error": "Not Found",
    "message": "No message available",
    "path": "/employees/turtle"
}
</code></pre>
<p>There is nothing wrong with this output but we can do better, provide more meaningful output to our clients.</p>
<h5 id="set-up-our-models">Set up our Models</h5>
<p>Let’s add the models needed to report exception, error messages back to the client. You can modify these as you wish for your applications. However, for now, let’s use this code. Add a model called <code class="highlighter-rouge">ErrorDetail</code> using the following code. Do note that this is NOT annotated as an Entity. The data for this model will never appear in the database. This is just a POJO we are using internally in our application. Remember in adding all of this code, you will need to make sure the proper imports are done!</p>
<pre><code class="language-JAVA">import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class ErrorDetail
{
    private String title;

    private int status;
    private String detail;
    private Date timestamp;
    private String developerMessage;
    private List&lt;ValidationError&gt; errors = new ArrayList&lt;&gt;();

    public ErrorDetail()
    {
    }

    public String getTitle()
    {
        return title;
    }

    public void setTitle(String title)
    {
        this.title = title;
    }

    public int getStatus()
    {
        return status;
    }

    public void setStatus(int status)
    {
        this.status = status;
    }

    public String getDetail()
    {
        return detail;
    }

    public void setDetail(String detail)
    {
        this.detail = detail;
    }

    public Date getTimestamp()
    {
        return timestamp;
    }

    public void setTimestamp(Date timestamp)
    {
        this.timestamp = timestamp;
    }

    public String getDeveloperMessage()
    {
        return developerMessage;
    }

    public void setDeveloperMessage(String developerMessage)
    {
        this.developerMessage = developerMessage;
    }

    public List&lt;ValidationError&gt; getErrors()
    {
        return errors;
    }

    public void setErrors(List&lt;ValidationError&gt; errors)
    {
        this.errors = errors;
    }
}
</code></pre>
<p>Notice that ErrorDetail references ValidationError. This is a class we create to hold any data validation errors that might arise. This is NOT the ValidationErrors from the Spring Framework so don’t mistakenly import that class!</p>
<p>Let’s now add the ValidationError models using the following code. Again, do note that this is NOT annotated as an Entity. The data for this model will never appear in the database. This is just a POJO we are using internally in our application.</p>
<pre><code class="language-JAVA">public class ValidationError
{
    private String Code;
    private String message;

    public String getCode()
    {
        return Code;
    }

    public void setCode(String code)
    {
        Code = code;
    }

    public String getMessage()
    {
        return message;
    }

    public void setMessage(String message)
    {
        this.message = message;
    }

    @Override
    public String toString()
    {
        return "ValidationError{" + "Code='" + Code + '\'' + ", message='" + message + '\'' + '}';
    }
}
</code></pre>
<h5 id="turn-off-default-exception-handling">Turn off Default Exception Handling</h5>
<p>Now we need to turn off the default exception handling of the Spring Framework. We will do this through an application property. However, after turning it off we need to handle manually all exceptions and reporting the information to the client that we want to report.</p>
<h6 id="application-properities">Application Properities</h6>
<p>Let’s add the appropriate code to application.properities. These turn off default exception handling including handling incorrect endpoints. Specifically this will alway us to custom that default exception handling. The default exception handling is still present but uses our own customizations. That is what we mean by “turn off” default exception handling. We also need to turn static resource handling to capture unknown endpoints. So add the following lines to the application.properties file</p>
<pre><code class="language-XML">### Turns off Spring Boot automatic exception handling
server.error.whitelabel.enabled=false
spring.mvc.throw-exception-if-no-handler-found=true
spring.resources.add-mappings=false
</code></pre>
<h6 id="mapping-for-swagger">Mapping for Swagger</h6>
<p>Since we have turned off static resource handling, we need to manually add the static paths for Swagger, the only valid static paths in our application. Add a class under <code class="highlighter-rouge">config</code> called <code class="highlighter-rouge">SwaggerWebMVC</code>. Then add the following code to the class. Feel free not to add the comments! This is boilerplate code that needs to be added to any application that uses custom exception handling and Swagger.</p>
<pre><code class="language-JAVA">import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

/**
 * The application turns off any automatic web page generate done by Spring. This is done to improve exception handling.
 * However, we do need some web page generate done for Swagger, so we do that here.
 */
@Configuration
public class SwaggerWebMVC implements WebMvcConfigurer
{
    /**
     * Adds the Swagger web pages to Spring.
     * This still gives the following warning
     * &lt;p&gt;
     * No mapping for GET /
     * No mapping for GET /csrf
     * &lt;p&gt;
     * All works though
     *
     * @param registry the place that holds the web pages for Spring
     */
    @Override
    public void addResourceHandlers(ResourceHandlerRegistry registry)
    {
        registry.addResourceHandler("swagger-ui.html")
            .addResourceLocations("classpath:/META-INF/resources/");

        registry.addResourceHandler("/webjars/**")
            .addResourceLocations("classpath:/META-INF/resources/webjars/");
    }
}
</code></pre>
<h6 id="manual-error-endpoint-handling">Manual /error endpoint handling</h6>
<p>We have turned off default error handling. Now let’s handle the exceptions. Some errors get routed to the endpoint <code class="highlighter-rouge">/error</code>. We need to change what /error reports to the client to our format.</p>
<p>Create a new subpackage under <code class="highlighter-rouge">sampleemps</code> called <code class="highlighter-rouge">exceptions</code>. Under that subpackge create a class called <code class="highlighter-rouge">CustomErrorDetails</code>. Then add the following code to that class. If future applications, you would modify what gets reported here to match what is in the <code class="highlighter-rouge">ErrorDetail</code> class. That way all our exceptions will report the same format of messages! Be careful that you import the right class for <code class="highlighter-rouge">DefaultErrorAttributes</code>!!!</p>
<pre><code class="language-JAVA">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.web.servlet.error.DefaultErrorAttributes;
import org.springframework.stereotype.Component;
import org.springframework.web.context.request.WebRequest;

import java.util.LinkedHashMap;
import java.util.Map;

@Component
public class CustomErrorDetails
        extends DefaultErrorAttributes
{
    @Autowired
    private HelperFunctions helper;

    @Override
    public Map&lt;String, Object&gt; getErrorAttributes(
            WebRequest webRequest,
            boolean includeStackTrace)
    {

        //Get all the normal error information
        Map&lt;String, Object&gt; errorAttributes =
                super.getErrorAttributes(webRequest, includeStackTrace);
        // Linked HashMaps maintain the order the items are inserted. I am using it here so that the error JSON
        // produced from this class lists the attributes in the same order as other classes.
        Map&lt;String, Object&gt; errorDetails = new LinkedHashMap&lt;&gt;();
        errorDetails.put("title", errorAttributes.get("error"));
        errorDetails.put("status", errorAttributes.get("status"));
        errorDetails.put("detail", errorAttributes.get("message"));
        errorDetails.put("timestamp", errorAttributes.get("timestamp"));
        errorDetails.put("developerMessage", "path: " + errorAttributes.get("path"));

        errorDetails.put("errors", helper.getConstraintViolation(this.getError(webRequest)));
        return errorDetails;
    }
}
</code></pre>
<p>This class uses a HelperFunction class. This class contains helpful methods that are used throughout the application. We will create a method that populates the validation constraint errors. We will use such a function in a few places throughout the application. Create a new subpackage under <code class="highlighter-rouge">sampleemps</code> called <code class="highlighter-rouge">handlers</code>. Create a class in that subpackage called <code class="highlighter-rouge">HelperFunctions</code>. Add the following code to that class.</p>
<pre><code class="language-Java">import com.lambdaschool.sampleemps.models.ValidationError;
import org.springframework.stereotype.Component;

import javax.validation.ConstraintViolation;
import javax.validation.ConstraintViolationException;
import java.util.ArrayList;
import java.util.List;

@Component
public class HelperFunctions
{
    public List&lt;ValidationError&gt; getConstraintViolation(Throwable cause)
    {
        // Find any data violations that might be associated with the error and report them
        // data validations get wrapped in other exceptions as we work through the Spring
        // exception chain. Hence we have to search the entire Spring Exception Stack
        // to see if we have any violation constraints.
        while ((cause != null) &amp;&amp; !(cause instanceof ConstraintViolationException))
        {
            cause = cause.getCause();
        }

        List&lt;ValidationError&gt; listVE = new ArrayList&lt;&gt;();

        // we know that cause either null or an instance of ConstraintViolationException
        if (cause != null)
        {
            ConstraintViolationException ex = (ConstraintViolationException) cause;
            for (ConstraintViolation cv : ex.getConstraintViolations())
            {
                ValidationError newVe = new ValidationError();
                newVe.setCode(cv.getInvalidValue()
                    .toString());
                newVe.setMessage(cv.getMessage());
                listVE.add(newVe);
            }
        }
        return listVE;
    }
}
</code></pre>
<p>Run the application and surf to these endpoints to see what exception handling now looks like. You can expand each endpoint to see its output</p>
<p>Wrong Data Type: http://localhost:2019/employees/employee/lambda</p>
<pre><code class="language-JSON">{
    "title": "Bad Request",
    "status": 400,
    "detail": "Failed to convert value of type 'java.lang.String' to required type 'long'; nested exception is java.lang.NumberFormatException: For input string: \"lambda\"",
    "timestamp": "2020-05-20 17:41:56",
    "developerMessage": "path: /employees/employee/lambda",
    "errors": []
}
</code></pre>
<p>Employee Not Found: http://localhost:2019/employees/employee/9999</p>
<pre><code class="language-JSON">{
    "title": "Internal Server Error",
    "status": 500,
    "detail": "Employee id 9999 not found",
    "timestamp": "2020-05-20 17:43:15",
    "developerMessage": "path: /employees/employee/9999",
    "errors": []
}
</code></pre>
<p>Invalid endpoint: http://localhost:2019/employees/turtle</p>
<pre><code class="language-JSON">{
    "title": "Not Found",
    "status": 404,
    "detail": "No message available",
    "timestamp": "2020-05-20 17:44:15",
    "developerMessage": "path: /employees/turtle",
    "errors": []
}
</code></pre>
<p>There is nothing wrong with this output but we can still do better. We get more specific about each type of error.</p>
<h6 id="unpredicted-exceptions">Unpredicted Exceptions</h6>
<p>Let’s change the message that get returned when we encounter an exception we have not handled, a catch all for all exceptions! Under the <code class="highlighter-rouge">handlers</code> subpackage, add a class called <code class="highlighter-rouge">RestExceptionHandler</code>. Here we will put code to address specific types of errors. Add the following code to the class to better handle invalid endpoint exceptions. This class extends the abstract class <code class="highlighter-rouge">ResponseEntityExceptionHandler</code>. We will override some methods from this abstract while leaving others at their default implementation.</p>
<p>Note the <code class="highlighter-rouge">RestControllerAdvice</code> annotation. When an exception is encountered during a Rest Controller operation, that Rest Controller seeks advice from an advice class on how to handle that exception. If no advice is found, it uses the default exception handling built into Spring including the modifications we have made to that default exception handling.</p>
<p>We do use the helper function to fill in data validation constraint exceptions so need to autowire that in!</p>
<pre><code class="language-JAVA">import com.lambdaschool.sampleemps.models.ErrorDetail;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.Ordered;
import org.springframework.core.annotation.Order;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.RestControllerAdvice;
import org.springframework.web.context.request.WebRequest;
import org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler;

import java.util.Date;

/**
 * This is the driving class when an exception occurs. All exceptions are handled here.
 * This class is shared across all controllers due to the annotation RestControllerAdvice;
 * this class gives advice to all controllers on how to handle exceptions.
 * Due to the annotation Order(Ordered.HIGHEST_PRECEDENCE), this class takes precedence over all other controller advisors.
 */
@Order(Ordered.HIGHEST_PRECEDENCE)
@RestControllerAdvice
public class RestExceptionHandler
        extends ResponseEntityExceptionHandler
{
    @Autowired
    private HelperFunctions helper;

    /**
     * The constructor for the RestExceptionHandler. Currently we do not do anything special. We just call the parent constructor.
     */
    public RestExceptionHandler()
    {
        super();
    }

    @Override
    protected ResponseEntity&lt;Object&gt; handleExceptionInternal(
            Exception ex,
            Object body,
            HttpHeaders headers,
            HttpStatus status,
            WebRequest request)
    {
        ErrorDetail errorDetail = new ErrorDetail();
        errorDetail.setTimestamp(new Date());
        errorDetail.setStatus(status.value());
        errorDetail.setTitle("Rest Internal Exception");
        errorDetail.setDetail(ex.getMessage());
        errorDetail.setDeveloperMessage(ex.getClass()
                .getName());
        errorDetail.setErrors(helper.getConstraintViolation(ex));

        return new ResponseEntity&lt;&gt;(errorDetail,
                null,
                status);
    }
}
</code></pre>
<p>Run the application and surf to these endpoints to see what exception handling now looks like. You can expand each endpoint to see its output</p>
<p>Wrong data type: http://localhost:2019/employees/employee/lambda</p>
<pre><code class="language-JSON">{
    "title": "Rest Internal Exception",
    "status": 400,
    "detail": "Failed to convert value of type 'java.lang.String' to required type 'long'; nested exception is java.lang.NumberFormatException: For input string: \"lambda\"",
    "timestamp": "2020-05-20 18:03:05",
    "developerMessage": "org.springframework.web.method.annotation.MethodArgumentTypeMismatchException",
    "errors": []
}
</code></pre>
<p>Employee Not Found: http://localhost:2019/employees/employee/9999</p>
<pre><code class="language-JSON">{
    "title": "Internal Server Error",
    "status": 500,
    "detail": "Employee id 9999 not found",
    "timestamp": "2020-05-20 18:02:44",
    "developerMessage": "path: /employees/employee/9999",
    "errors": []
}
</code></pre>
<p>Invalid endpoint: http://localhost:2019/employees/turtle</p>
<pre><code class="language-JSON">{
    "title": "Not Found",
    "status": 404,
    "detail": "No message available",
    "timestamp": "2020-05-20 18:02:16",
    "developerMessage": "path: /employees/turtle",
    "errors": []
}
</code></pre>
<h5>Dig Deeper</h5>
<ul>
<li>
<a href="https://www.protechtraining.com/content/java_fundamentals_tutorial-exceptions" target="blank_">Java Fundamentals Tutorial: Exceptions</a><br> Java Fundamentals Tutorial: Exceptions</li>
</ul>
<hr>
<h4 class="mark mb-3 p-2">Learn to implement exception handling using a variety of Java constructs</h4>
<p><a id="Java_Exception_Constructs"></a></p>
<h5>Overview</h5>
<ul>
<li>See the Github Repository <a href="https://github.com/LambdaSchool/java-exceptionalsampleemps.git">https://github.com/LambdaSchool/java-exceptionalsampleemps.git</a> for the code used in the objective.</li>
</ul>
<h3 id="software-needed">Software Needed</h3>
<ul>
<li>Java Development Kit (JDK) - at least version 11</li>
<li>JetBrains IntelliJ IDEA IDE</li>
<li>Postman</li>
</ul>
<p>What if we want to programmatically cause an exception? What if we want to stop the ordinary flow of our application and report that to our clients? To do this, we can throw an exception or use a try..catch statement. We have already thrown built-in exceptions. For example, look at the code for delete in the class EmployeeServiceImpl.</p>
<pre><code class="language-JAVA">    public void delete(long employeeid)
    {
        if (employeerepos.findById(employeeid)
            .isPresent())
        {
            employeerepos.deleteById(employeeid);
        } else
        {
            throw new EntityNotFoundException("Employee " + employeeid + " Not Found");
        }
    }
</code></pre>
<p>Here we use <code class="highlighter-rouge">throw new EntityNotFoundException("Employee " + employeeid + " Not Found");</code> which throws the built-in exception <code class="highlighter-rouge">EntityNotFoundException</code>.</p>
<p>In the method <code class="highlighter-rouge">findEmployeeById</code> we call a method called <code class="highlighter-rouge">.orElseThrow</code> which throws the <code class="highlighter-rouge">EntityNotFoundException</code> as well.</p>
<pre><code class="language-JAVA">    public Employee findEmployeeById(long id) throws
            EntityNotFoundException
    {
        return employeerepos.findById(id)
                .orElseThrow(() -&gt; new EntityNotFoundException("Employee id " + id + " not found"));
    }
</code></pre>
<p>Java also includes the Try..Catch statement. This statement tries to run the code in the body. If all works, great! If not an exception is thrown, either by us, Java, or the Spring Framework, and the catch part gets executed. You can even have a finally part that will get executed no matter what.</p>
<pre><code class="language-JAVA">try
{
    // the statements to try
} catch (Exception e)
{
    // do this is something went wrong
} finally
{
    // no matter what, do these statements
}
</code></pre>
<p>Notice that with catch we say which exception we wish to catch. Above we use Exception e to represent all exceptions. However, if we want to handle different exceptions differently, we can do that! In the following exception, we address an IOException, a SQLException and then all other exceptions differently.</p>
<pre><code class="language-JAVA">try
{
    // the statements to try
} catch (SQLException e)
{
    System.out.println("Error processing database");
} catch (IOException e)
{
    System.out.println("We could not find your file");
} catch (Exception e)
{
    System.out.println("Ouch. That did not work!" + e);
} finally
{
    // no matter what, do these statements
}
</code></pre>
<h5>Follow Along</h5>
<h3 id="create-our-own-exception">Create our own exception</h3>
<p>Let’s create our own exception that we can throw and look at how try..catch statements work in Java. Let’s add each example to our <code class="highlighter-rouge">exceptionalsampleemps</code> application we started in the previous objective.</p>
<p>If you haven’t already, open the application <code class="highlighter-rouge">exceptionalsampleemps</code> you worked on in the previous objective on Exception Handling. Let’s create our own exception we can throw. Under the subpackage <code class="highlighter-rouge">exceptions</code>, create a class called <code class="highlighter-rouge">ResourceNotFoundException</code>. This is the name of the exception we are going to create. Add the following code to that class. Remember in adding all of this code, you will need to make sure the proper imports are done!</p>
<pre><code class="language-JAVA">public class ResourceNotFoundException
    extends RuntimeException
{
    public ResourceNotFoundException(String message)
    {
        super("Error from a Lambda School Application " + message);
    }
}
</code></pre>
<p>The difference between this exception and the built-in exception <code class="highlighter-rouge">EntityNotFoundException</code> is the name and that the error message will contain the phrase “Error from a Lambda School Application”. Really, I am just showing this is possible!</p>
<p>Now let’s handle this custom exception. Add the following code to the bottom of the RestExceptionHandler class under the subpackage handlers.</p>
<pre><code class="language-JAVA">    // annotation to say the following method is meant to handle any time the ResourceNotFoundException is thrown
    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity&lt;?&gt; handleResourceNotFoundException(ResourceNotFoundException rnfe)
    {
        ErrorDetail errorDetail = new ErrorDetail();
        errorDetail.setTimestamp(new Date());
        errorDetail.setStatus(HttpStatus.NOT_FOUND.value());
        errorDetail.setTitle("Resource Not Found");
        errorDetail.setDetail(rnfe.getMessage());
        errorDetail.setDeveloperMessage(rnfe.getClass()
            .getName());
        errorDetail.setErrors(helper.getConstraintViolation(rnfe));

        return new ResponseEntity&lt;&gt;(errorDetail,
            null,
            HttpStatus.NOT_FOUND);
    }
</code></pre>
<p>Thus we have an annotation saying which method will handle ResourceNotFoundExceptions. We put the messages we want to return to the client in our ErrorDetail model and then we return that object to the client. Now we have to throw the <code class="highlighter-rouge">ResourceNotFoundException</code> in our code instead of the <code class="highlighter-rouge">EntityNotFoundException</code>. So open the <code class="highlighter-rouge">EmployeeServiceImpl</code> and the class and do a replace, replacing <code class="highlighter-rouge">EntityNotFoundException</code> with <code class="highlighter-rouge">ResourceNotFoundException</code>. Do the same thing with <code class="highlighter-rouge">JobTitleServiceImpl</code>!</p>
<p>Hint to replace code, with the correct file selected,</p>
<ul>
<li>go to <code class="highlighter-rouge">Edit</code> -&gt; <code class="highlighter-rouge">Find</code> -&gt; <code class="highlighter-rouge">Replace</code>.</li>
<li>In the find box, the first one, enter <code class="highlighter-rouge">EntityNotFoundException</code>
</li>
<li>In the replace box, the second one, enter <code class="highlighter-rouge">ResourceNotFoundException</code>
</li>
<li>Click on Replace all</li>
</ul>
<p>Let’s see what happens now when we try to find an employee that is not there. Run the application <code class="highlighter-rouge">exceptionalsampleemps</code>. Surf to the following endpoint. Expand the endpoint to see its output.</p>
<p>Resource Not Found: http://localhost:2019/employees/employee/9999</p>
<pre><code class="language-JSON">{
    "title": "Resource Not Found",
    "status": 404,
    "detail": "Error from a Lambda School Application Employee id 9999 not found",
    "timestamp": "2020-05-20 19:58:39",
    "developerMessage": "com.lambdaschool.sampleemps.exceptions.ResourceNotFoundException",
    "errors": []
}
</code></pre>
<h3 id="trycatch-statements">Try..Catch statements</h3>
<p>To see how a try..catch works in action, let’s try to read from an environment variable on our local system. we use a system method <code class="highlighter-rouge">System.getenv()</code>.</p>
<p>Change the main class, <code class="highlighter-rouge">SampleempsApplication</code>, to try and read in an environment variable called <code class="highlighter-rouge">LAMBDA</code>. So the main class will look like this in the end.</p>
<pre><code class="language-JAVA">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;

@EnableJpaAuditing
@SpringBootApplication
public class SampleempsApplication
{
    public static void main(String[] args)
    {
        try
        {
            System.out.println(System.getenv("PATH").toUpperCase());
        } catch (Exception e)
        {
            System.out.println("No Such Environment Variable");
        } finally
        {
            SpringApplication.run(SampleempsApplication.class,
                    args);
        }
    }
}
</code></pre>
<p>Run the application. In your IntelliJ console, you will see the value of the environment variable in upper case if it is set on your system. If it is not set, you will see the message no such environment variable. Either way the program will continue. Try working with the environment variable PATH and see what happens! Do note you get the output twice, once from the regular run of the application and once from the DevTools run of the application.</p>
<h5>Challenge</h5>
<p>Following the same process you used to create a <code class="highlighter-rouge">ResourceNotFoundException</code>, create a <code class="highlighter-rouge">ResourceFoundException</code> to be used in place of the built-in exception <code class="highlighter-rouge">EntityExistsException</code>.</p>
<hr>
<h4 class="mark mb-3 p-2">Learn to use data validation annotations to verify data prior to processing the data</h4>
<p><a id="Validation"></a></p>
<h5>Overview</h5>
<ul>
<li>See the Github Repository <a href="https://github.com/LambdaSchool/java-exceptionalsampleemps.git">https://github.com/LambdaSchool/java-exceptionalsampleemps.git</a> for the code used in the objective.</li>
</ul>
<h3 id="software-needed">Software Needed</h3>
<ul>
<li>Java Development Kit (JDK) - at least version 11</li>
<li>JetBrains IntelliJ IDEA IDE</li>
<li>Postman</li>
</ul>
<p>We as backend developers are responsible for the integrity of the data in our systems. Clients will send up garbage at times. That might be due to a system problem or some initial act to sabotage our database. We cannot rely on the data we receive to be valid. We must first validate the data before it gets saved and used in our system.</p>
<ul>
<li>Did the client send up a String when we needed an integer?</li>
<li>Did the client send us duplicates of a field that must be unique?</li>
<li>Did the client send us a poorly formatted email address?</li>
<li>And the list goes on.</li>
</ul>
<p>Do NOT rely on clients to send you reasonable data. Data validation is our responsibility. I think I have said that enough but know I have many horror stories of “interesting” data from clients. Validate your own data! We have been doing this all along. We just did not label it as data validation. For example</p>
<ul>
<li>Java is strongly typed. If we expect an integer and get a String, Java itself will cause an exception, and we know how to handle exceptions!</li>
<li>We use the <code class="highlighter-rouge">@Column</code> annotation to say if a column is required or must be unique across records.</li>
<li>We use setters to convert or validate our data before it goes to the database.</li>
</ul>
<p>So, much data validation we get for “free” with Java Spring. Data validation is baked into the language and framework. However, certain annotations are available for use to further validate data. These are found in the import <code class="highlighter-rouge">javax.validation.constraints</code> and are put right before the fields in the models whose values we want to restrict. We can even add our own exception message using the <code class="highlighter-rouge">message</code> attribute. Some of these include:</p>
<ul>
<li>
<code class="highlighter-rouge">@Email(message = "must be a valid email")</code> forces the field to be in a valid email format (<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="463335233428272b230622292b272f28683229362a2330232a">[email&#160;protected]</a>). If not, a message for “must be a valid email” is returned.</li>
<li>
<code class="highlighter-rouge">@Size(min = ??, max = ??)</code> restricts the size of a String field.</li>
<li>
<code class="highlighter-rouge">@Min(value = ??)</code> minimum value of an integer. Often used in conjunction with @Max</li>
<li>
<code class="highlighter-rouge">@Max(value = ??)</code> maximum value of an integer. Often used in conjunction with @Min</li>
<li>
<code class="highlighter-rouge">@DecimalMin(value = "??.??")</code> minimum value for doubles</li>
<li>
<code class="highlighter-rouge">@DecimalMax(value = "??.??")</code> maximum value for doubles</li>
<li>
<code class="highlighter-rouge">@Postive</code> must be a positive number</li>
<li>
<code class="highlighter-rouge">@Negative</code> must be a negative number</li>
<li>
<code class="highlighter-rouge">@NotNull</code> another way to validate whether a field can be null or not</li>
<li>
<code class="highlighter-rouge">@Future</code> date must be in the future</li>
<li>
<code class="highlighter-rouge">@Pattern(value = "regex")</code> allows you specific a regex pattern to use to validate the data! Discussing regex patterns are beyond the scope of this module. See additional resources for more information.</li>
</ul>
<h5>Follow Along</h5>
<p>If you haven’t already, open the application <code class="highlighter-rouge">exceptionalsampleemps</code> you worked on in the previous objectives on Exception Handling. In the Employee Model, right before the salary field, add the appropriate annotations for a minimum salary of 100,000 and a maximum salary of 120,000. So your code will look something like this. Remember in adding all of this code, you will need to make sure the proper imports are done!</p>
<pre><code class="language-JAVA">// ...

    @Transient
    public boolean hasvalueforsalary = false;

    @DecimalMax(value = "120000.0")
    @DecimalMin(value = "100000.0")
    private double salary;

// ...
</code></pre>
<p>Now run your application. In your console window you will see an error message similar to the following.</p>
<pre><code class="language-TEXT">Caused by: javax.persistence.RollbackException: Error while committing the transaction
    at org.hibernate.internal.ExceptionConverterImpl.convertCommitException(ExceptionConverterImpl.java:81) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:104) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:534) ~[spring-orm-5.2.2.RELEASE.jar:5.2.2.RELEASE]
    ... 20 common frames omitted
Caused by: javax.validation.ConstraintViolationException: Validation failed for classes [com.lambdaschool.sampleemps.models.Employee] during persist time for groups [javax.validation.groups.Default, ]
List of constraint violations:[
    ConstraintViolationImpl{interpolatedMessage='must be greater than or equal to 100000.0', propertyPath=salary, rootBeanClass=class com.lambdaschool.sampleemps.models.Employee, messageTemplate='{javax.validation.constraints.DecimalMin.message}'}
]
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.validate(BeanValidationEventListener.java:140) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.cfg.beanvalidation.BeanValidationEventListener.onPreInsert(BeanValidationEventListener.java:80) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.action.internal.EntityInsertAction.preInsert(EntityInsertAction.java:211) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:84) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:604) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:478) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:684) ~[na:na]
    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:475) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:348) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:108) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1344) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:435) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:3221) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2389) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:447) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:183) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.access$300(JdbcResourceLocalTransactionCoordinatorImpl.java:40) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:281) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-5.4.9.Final.jar:5.4.9.Final]
    ... 21 common frames omitted
</code></pre>
<p>These annotations are a great way to further validate your data!</p>
<h5>Challenge</h5>
<p>Add an annotation to validate the email field in the Email model. Note that since the word email is already in use in the method, IntelliJ adds the full address of the annotation to give you something like <code class="highlighter-rouge">@javax.validation.constraints.Email</code>. It happens when these common words are used. We have to know which one to use at what time!</p>
<h5>Dig Deeper</h5>
<ul>
<li>
<a href="https://www.baeldung.com/javax-validation" target="blank_">Baeldung</a><br> Baeldung Java Been Validation Basics</li>
<li>
<a href="https://reflectoring.io/bean-validation-with-spring-boot/" target="blank_">Bean Validation</a><br> All You Need To Know About Bean Validation With Spring Boot</li>
<li>
<a href="https://www.vogella.com/tutorials/JavaRegularExpressions/article.html" target="blank_">Regular Expressions</a><br> Regular expressions in Java - Tutorial</li>
<li>
<a href="https://docs.oracle.com/javase/tutorial/essential/regex/index.html" target="blank_">Regular Expressions</a><br> Oracle's Tutorial on Regular Expressions</li>
</ul>
<hr>
<h4 class="mark mb-3 p-2">Learn to gather and use data from other APIs</h4>
<p><a id="Data_from_Other_APIs"></a></p>
<h5>Overview</h5>
<ul>
<li>See the Github Repository <a href="https://github.com/LambdaSchool/java-sampleotherapis.git">https://github.com/LambdaSchool/java-sampleotherapis.git</a> for the code used in the objective.</li>
</ul>
<h3 id="software-needed">Software Needed</h3>
<ul>
<li>Java Development Kit (JDK) - at least version 11</li>
<li>JetBrains IntelliJ IDEA IDE</li>
<li>Postman</li>
</ul>
<p>Often we need to get data from other backend APIs systems. These are either provided by other companies, data scientist people within our own company, or some other group. We become the client. We are reliant on the other system on how to retrieve the data and how the retrieved data is organized. Let’s take a look at a few examples.</p>
<p>We are going to retrieve data from three different APIs that return the data is three common, but very different ways.</p>
<h3 id="straight-json">Straight JSON</h3>
<p>The easiest to work with will be Straight JSON as from the API <a href="http://numbersapi.com/random/year?json">http://numbersapi.com/random/year?json</a>. This API returns a random math fact based on a random year. Surfing to that site returns</p>
<pre><code class="language-JSON">{
    "text": "287 is the year that Emperor Diocletian and Maximian become Roman Consuls.",
    "number": 287,
    "found": true,
    "type": "year"
}
</code></pre>
<h3 id="extra-fields-wrapped-in-a-class">Extra Fields wrapped in a class</h3>
<p>Sometimes our data comes back wrapped in a class name and contains fields we do not need. For example, the API <a href="http://api.open-notify.org/iss-now.json">http://api.open-notify.org/iss-now.json</a> does this. This API returns the current location of the International Space Station.</p>
<pre><code class="language-JSON">{
    "message": "success",
    "iss_position": {
        "latitude": "-46.3184",
        "longitude": "-65.6439"
    },
    "timestamp": 1590079067
}
</code></pre>
<h3 id="wrapped-in-a-class-requiring-a-parameter">Wrapped in a class requiring a parameter</h3>
<p>Sometimes to get the data we want we have to send a parameter along with our endpoint. This API will return the Klingon translation of the given English phrase. <a href="https://api.funtranslations.com/translate/klingon.json?text=%22The%20enemy%20of%20my%20enemy%20is%20the%20enemy%20I%20kill%20last%22">https://api.funtranslations.com/translate/klingon.json?text=”The enemy of my enemy is the enemy I kill last”</a></p>
<pre><code class="language-JSON">{
    "success": {
        "total": 1
    },
    "contents": {
        "translated": "\"The jagh of my jagh is the jagh jih hoh hochdich\"",
        "text": "\"The enemy of my enemy is the enemy I kill last\"",
        "translation": "klingon"
    }
}
</code></pre>
<p>For all the data we retrieve we need to create a model that can store the data. This data may or not need to be saved to our database. This is usually accomplished through a separate model class for the data along with a collection to store a list of the data. Let’s see how this works in practice! As we are creating POJOs to hold our JSON objects, do note how the names of the fields must match exactly between the two entities.</p>
<h5>Follow Along</h5>
<p>Let’s learn about these by following along, coding the following examples. Open the sample-otherapis-initial application from <a href="https://github.com/LambdaSchool/java-sampleotherapis.git">https://github.com/LambdaSchool/java-sampleotherapis.git</a>t. This application is the same as the sampleemps_data_modeling application from the GitHub Repository <a href="https://github.com/LambdaSchool/java-sampleemps.git">https://github.com/LambdaSchool/java-sampleemps.git</a>t</p>
<h3 id="straight-json">Straight JSON</h3>
<p>We want to report a random fact about a year to the console on application start up. Let’s create a model to hold the data we will get back from the API. Under the <code class="highlighter-rouge">models</code> subpackage, create a class called <code class="highlighter-rouge">YearFact</code>. This will NOT be saved in our database so we will NOT use the <code class="highlighter-rouge">@Entity</code> annotation. We need a field to hold each one of the pieces of data we want to save. We also need an annotation to say to ignore all other pieces of data. We will be using <code class="highlighter-rouge">@JsonIgnoreProperties(ignoreUnknown = true)</code></p>
<ul>
<li>The API endpoint we are accessing is <a href="http://numbersapi.com/random/year?json">http://numbersapi.com/random/year?json</a>n</li>
<li>Looking at the JSON that is returned by this endpoint we only want the data <code class="highlighter-rouge">text</code> and <code class="highlighter-rouge">number</code>. See JSON object from above.</li>
</ul>
<p>So enter the following code for the class <code class="highlighter-rouge">YearFact</code>. Remember in adding all of this code, you will need to make sure the proper imports are done! Do note how closely this matches the layout of the JSON object!</p>
<pre><code class="language-JAVA">import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

// needed to ignore any fields coming across that we do not want in our final class.
@JsonIgnoreProperties(ignoreUnknown = true)
public class YearFact
{
    private String text;
    private int number;

    public String getText()
    {
        return text;
    }

    public void setText(String text)
    {
        this.text = text;
    }

    public int getNumber()
    {
        return number;
    }

    public void setNumber(int number)
    {
        this.number = number;
    }

    @Override
    public String toString()
    {
        return "YearFact{" +
                "text='" + text + '\'' +
                ", number=" + number +
                '}';
    }
}
</code></pre>
<p>We now need to go get the data and then display it in the console. Add the following code to the <code class="highlighter-rouge">main</code> method in the <code class="highlighter-rouge">SampleempsApplication</code> class. In this code we introduce</p>
<ul>
<li>The <code class="highlighter-rouge">RestTemplate</code> - creates the object that is needed to do a client side Rest API call.</li>
<li>
<code class="highlighter-rouge">MappingJackson2HttpMessageConverter</code> - a way to configure our rest request.</li>
<li>Doing a request now instead of responding to one.</li>
</ul>
<pre><code class="language-JAVA">        /*
         * Creates the object that is needed to do a client side Rest API call.
         * We are the client getting data from a remote API.
         */
        RestTemplate restTemplate = new RestTemplate();

        // we need to tell our RestTemplate what format to expect
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        // a couple of common formats
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.TEXT_HTML));
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.APPLICATION_JSON));
        // or we can accept all formats! Easiest but least secure
        converter.setSupportedMediaTypes(Collections.singletonList(MediaType.ALL));
        restTemplate.getMessageConverters().add(converter);

        // create the url to access the API
        String requestURL = "http://numbersapi.com/random/year?json";
        // create the responseType expected. Notice the YearFact is the data type we are expecting back from the API!
        ParameterizedTypeReference&lt;YearFact&gt; responseType = new ParameterizedTypeReference&lt;&gt;()
        {
        };
        // create the response entity. do the get and get back information
        ResponseEntity&lt;YearFact&gt; responseEntity = restTemplate.exchange(requestURL,
                HttpMethod.GET,
                null,
                responseType);
        // now that we have our data, let's print it to the console!
        YearFact ourYearFact = responseEntity.getBody();
        System.out.println(ourYearFact);
</code></pre>
<p>So we end up with the following <code class="highlighter-rouge">SampleempsApplication</code> class.</p>
<pre><code class="language-JAVA">import com.lambdaschool.sampleemps.models.YearFact;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.core.ParameterizedTypeReference;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;
import org.springframework.http.HttpMethod;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.web.client.RestTemplate;

import java.util.Collections;

@EnableJpaAuditing
@SpringBootApplication
public class SampleempsApplication
{

    public static void main(String[] args)
    {
        /*
         * Creates the object that is needed to do a client side Rest API call.
         * We are the client getting data from a remote API.
         */
        RestTemplate restTemplate = new RestTemplate();

        // we need to tell our RestTemplate what format to expect
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        // a couple of common formats
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.TEXT_HTML));
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.APPLICATION_JSON));
        // or we can accept all formats! Easiest but least secure
        converter.setSupportedMediaTypes(Collections.singletonList(MediaType.ALL));
        restTemplate.getMessageConverters().add(converter);

        // create the url to access the API
        String requestURL = "http://numbersapi.com/random/year?json";
        // create the responseType expected. Notice the YearFact is the data type we are expecting back from the API!
        ParameterizedTypeReference&lt;YearFact&gt; responseType = new ParameterizedTypeReference&lt;&gt;()
        {
        };
        // create the response entity. do the get and get back information
        ResponseEntity&lt;YearFact&gt; responseEntity = restTemplate.exchange(requestURL,
                HttpMethod.GET,
                null,
                responseType);
        // now that we have our data, let's print it to the console!
        YearFact ourYearFact = responseEntity.getBody();
        System.out.println(ourYearFact);

        SpringApplication.run(SampleempsApplication.class,
            args);
    }
}
</code></pre>
<p>Run the application and notice something similar in the console!</p>
<pre><code class="language-TEXT">14:38:16.213 [main] DEBUG org.springframework.web.client.RestTemplate - HTTP GET http://numbersapi.com/random/year?json
14:38:16.242 [main] DEBUG org.springframework.web.client.RestTemplate - Accept=[application/json, application/*+json, */*]
14:38:23.788 [main] DEBUG org.springframework.web.client.RestTemplate - Response 200 OK
14:38:23.791 [main] DEBUG org.springframework.web.client.RestTemplate - Reading to [com.lambdaschool.sampleemps.models.YearFact]
YearFact{text='1889 is the year that International Workers Congresses of Paris.', number=1889}
14:38:23.899 [restartedMain] DEBUG org.springframework.web.client.RestTemplate - HTTP GET http://numbersapi.com/random/year?json
14:38:23.901 [restartedMain] DEBUG org.springframework.web.client.RestTemplate - Accept=[application/json, application/*+json, */*]
14:38:23.981 [restartedMain] DEBUG org.springframework.web.client.RestTemplate - Response 200 OK
14:38:23.982 [restartedMain] DEBUG org.springframework.web.client.RestTemplate - Reading to [com.lambdaschool.sampleemps.models.YearFact]
YearFact{text='1366 is the year that Muhammed V builds the Granada Hospital in Granada (in present-day Spain).', number=1366}
</code></pre>
<h3 id="extra-fields-wrapped-in-a-class">Extra Fields wrapped in a class</h3>
<p>We want an endpoint that will return the current position of the international space station.</p>
<p>Create a model to hold the ISS Position data. We only want the fields latitude and longitude which are part of the iss_position class embedded in the JSON Object. Let’s create a model to hold the data that is retrieved from the API. This model will include a field that is of some class type. Create a model called <code class="highlighter-rouge">IssPositionReturnData</code> in the subpackage <code class="highlighter-rouge">models</code>. Add the following code.</p>
<ul>
<li>Do note how closely this matches the layout of the JSON object!</li>
<li>Do note that we do not need the <code class="highlighter-rouge">@JsonIgnoreProperties(ignoreUnknown = true)</code> as we are handling all incoming pieces of data. We not returning all that data to the client but we have a place in our application to store all data retrieved from the API.</li>
<li>Note that the field of the embedded class type has to match the field name from the JSON Object, just like all the other fields. Nothing special about it being a class!</li>
</ul>
<pre><code class="language-JAVA">public class IssPositionReturnData
{
    private String message;
    private IssPosition iss_position;
    private long timestamp;

    public String getMessage()
    {
        return message;
    }

    public void setMessage(String message)
    {
        this.message = message;
    }

    public IssPosition getIss_position()
    {
        return iss_position;
    }

    public void setIss_position(IssPosition iss_position)
    {
        this.iss_position = iss_position;
    }

    public long getTimestamp()
    {
        return timestamp;
    }

    public void setTimestamp(long timestamp)
    {
        this.timestamp = timestamp;
    }
}
</code></pre>
<p>We now need to create that embedded class type. Create a model called <code class="highlighter-rouge">IssPosition</code> in the subpackage <code class="highlighter-rouge">models</code>. Add the following code.</p>
<pre><code class="language-JAVA">public class IssPosition
{
    private String latitude;
    private String longitude;

    public String getLatitude()
    {
        return latitude;
    }

    public void setLatitude(String latitude)
    {
        this.latitude = latitude;
    }

    public String getLongitude()
    {
        return longitude;
    }

    public void setLongitude(String longitude)
    {
        this.longitude = longitude;
    }
}
</code></pre>
<p>Now let’s go retrieve the data. Create a new class under the subpackage <code class="highlighter-rouge">controllers</code> called <code class="highlighter-rouge">OtherApis</code>. Add the following code.</p>
<pre><code class="language-JAVA">import com.lambdaschool.sampleemps.models.IssPosition;
import com.lambdaschool.sampleemps.models.IssPositionReturnData;
import org.springframework.core.ParameterizedTypeReference;
import org.springframework.http.HttpMethod;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;

import java.util.Collections;

@RestController
@RequestMapping("/otherapis") // optional
public class OtherApis
{
    /*
     * Creates the object that is needed to do a client side Rest API call.
     * We are the client getting data from a remote API.
     * We can share this template among endpoints
     */
    private RestTemplate restTemplate = new RestTemplate();

    @GetMapping(value = "/isspositions")
    public ResponseEntity&lt;?&gt; listIssPositions()
    {
        // we need to tell our RestTemplate what format to expect
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        // a couple of common formats
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.TEXT_HTML));
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.APPLICATION_JSON));
        // or we can accept all formats! Easiest but least secure
        converter.setSupportedMediaTypes(Collections.singletonList(MediaType.ALL));
        restTemplate.getMessageConverters().add(converter);

        // create the url to access the API
        String requestURL = "http://api.open-notify.org/iss-now.json";
        // create the responseType expected. Notice the IssPositionReturnData is the data type we are expecting back from the API!
        ParameterizedTypeReference&lt;IssPositionReturnData&gt; responseType = new ParameterizedTypeReference&lt;&gt;()
        {
        };

        // create the response entity. do the get and get back information
        ResponseEntity&lt;IssPositionReturnData&gt; responseEntity = restTemplate.exchange(requestURL,
                HttpMethod.GET,
                null,
                responseType);
        // we want to return the Iss_position data. From the data that gets returned in the body,
        // get the Iss_position data only and return it.
        // putting the data into its own object first, prevents the data from being reported to client inside of
        // an embedded. So the response will look more like our clients are use to!
        IssPosition ourIssPosition = responseEntity.getBody().getIss_position();
        return new ResponseEntity&lt;&gt;(ourIssPosition,
                HttpStatus.OK);
    }
}
</code></pre>
<p>Run the application and surf to the endpoint <a href="http://localhost:2019/otherapis/isspositions">http://localhost:2019/otherapis/isspositions</a>s. You get back data similar to the following</p>
<pre><code class="language-JSON">{
    "latitude": "38.1104",
    "longitude": "-49.8389"
}
</code></pre>
<h3 id="wrapped-in-a-class-requiring-a-parameter">Wrapped in a class requiring a parameter</h3>
<p>We want an endpoint that will return the Klingon translation of a phrase coming in through a path variable. We need to create a class that contains a field that is of type <code class="highlighter-rouge">contents</code> class. So, we also need to create the <code class="highlighter-rouge">contents</code> class. In the <code class="highlighter-rouge">models</code> subpackage, create a class called Translation. Add to that the class the following code. Note that the field of the embedded class type has to match the field name from the JSON Object, just like all the other fields. Nothing special about it being a class!</p>
<pre><code class="language-JAVA">import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

@JsonIgnoreProperties(ignoreUnknown = true)
public class Translation
{
    private TranslationContents contents;

    public TranslationContents getContents()
    {
        return contents;
    }

    public void setContents(TranslationContents contents)
    {
        this.contents = contents;
    }
}
</code></pre>
<p>Now we need to create the embedded class type contents. In the <code class="highlighter-rouge">models</code> subpackage, create a class called <code class="highlighter-rouge">TranslationContents</code> and add the following code.</p>
<pre><code class="language-JAVA">import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

@JsonIgnoreProperties(ignoreUnknown = true)
public class TranslationContents
{
    private String translated;

    public String getTranslated()
    {
        return translated;
    }

    public void setTranslated(String translated)
    {
        this.translated = translated;
    }
}
</code></pre>
<p>We will now create the endpoint to access this information. Handling of the path variable is just like we handle all other path variables. Add the following code to the bottom of the controller class <code class="highlighter-rouge">OtherApis</code>.</p>
<pre><code class="language-JAVA">    @GetMapping(value = "/klingon/{englishText}")
    public ResponseEntity&lt;?&gt; getTranslation(
            @PathVariable
                    String englishText)
    {
        // we need to tell our RestTemplate what format to expect
        MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();
        // a couple of common formats
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.TEXT_HTML));
        // converter.setSupportedMediaTypes(Collections.singletonList(MediaType.APPLICATION_JSON));
        // or we can accept all formats! Easiest but least secure
        converter.setSupportedMediaTypes(Collections.singletonList(MediaType.ALL));
        restTemplate.getMessageConverters()
                .add(converter);

        // create the url to access the API including adding the path variable
        String requestURL = "https://api.funtranslations.com/translate/klingon.json?text=" + englishText;
        // create the responseType expected. Notice the Translation is the data type we are expecting back from the API!
        ParameterizedTypeReference&lt;Translation&gt; responseType = new ParameterizedTypeReference&lt;&gt;()
        {
        };

        // create the response entity. do the get and get back information
        ResponseEntity&lt;Translation&gt; responseEntity = restTemplate.exchange(requestURL,
                HttpMethod.GET,
                null,
                responseType);
        // we want to return the contents of the translation data. From the data that gets returned in the body,
        // get the contents data only and return it.
        // putting the data into its own object first, prevents the data from being reported to client inside of
        // an embedded. So the response will look more like our clients are use to!
        TranslationContents ourTranslation = responseEntity.getBody()
                .getContents();
        return new ResponseEntity&lt;&gt;(ourTranslation,
                HttpStatus.OK);
    }
</code></pre>
<p>Surf to the endpoint <a href="http://localhost:2019/otherapis/klingon/%22Success%22">http://localhost:2019/otherapis/klingon/”Success”</a>” and we get something similar to the following</p>
<pre><code class="language-JSON">{
    "translated": "\"qapla'\""
}
</code></pre>
<p>Now surf to this endpoint <a href="http://localhost:2019/otherapis/klingon/%22I%20want%20to%20be%20a%20backend%20developer%22">http://localhost:2019/otherapis/klingon/”I want to be a backend developer”</a> and we get something similar to the following</p>
<pre><code class="language-JSON">{
    "translated": "\"jih neh to qu' a backend developer\""
}
</code></pre>
<p>So go forth and gather data from other APIs!</p>
<h5>Dig Deeper</h5>
<ul>
<li>
<a href="http://www.jsonschema2pojo.org/" target="blank_">JSON to POJO</a><br> Convert from JSON to POJO</li>
</ul>
<hr>
<h4 class="mark mb-3 p-2">Learn to implement custom Swagger Documentation (*** OPTIONAL ***)</h4>
<p><a id="Customized_Swagger_Documentation"></a></p>
<h5>Overview</h5>
<ul>
<li>See the Github Repository [https://github.com/LambdaSchool/java-sampleswagger.git/](https://github.com/LambdaSchool/java-sampleswagger.git for the code used in the objective.</li>
</ul>
<h3 id="software-needed">Software Needed</h3>
<ul>
<li>Java Development Kit (JDK) - at least version 11</li>
<li>JetBrains IntelliJ IDEA IDE</li>
<li>Postman</li>
</ul>
<p>We have covered how to add and print default Swagger documentation to our applications. That was good stuff! But what if we don’t like the default documentation and want to add our own? We can do that! One nice side effect of the way this works is the default documentation shows up and then if we want to customize it, we can. The parts we don’t customize will get the default documentation!</p>
<p>We can specifically put custom Swagger documentation on the following items:</p>
<ul>
<li>Models
<ul>
<li>At the table level including
<ul>
<li>Name</li>
<li>Description</li>
</ul>
</li>
<li>At the column, field, or property level including
<ul>
<li>Name</li>
<li>Description (called value)</li>
<li>Required or not</li>
<li>Giving an example</li>
</ul>
</li>
</ul>
</li>
<li>Controller
<ul>
<li>Operation’s Level
<ul>
<li>Description (called value)</li>
<li>Response type (Class type)</li>
<li>Response container type (optional, usually a List)</li>
</ul>
</li>
<li>ApiResponse
<ul>
<li>List of status codes
<ul>
<li>value
<ul>
<li>Status Code</li>
<li>Custom Message</li>
<li>Response (class)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Parameters
<ul>
<li>Description (called value)</li>
<li>Required or not</li>
<li>Example (if a base data type or String)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Swagger can do much, much more but let’s stick with the basics for now. Remember the end result is to provide documentation to your clients on how to use your API!</p>
<h5>Follow Along</h5>
<p>Let’s add some custom Swagger documentation to an existing application.</p>
<p>Open the application java-sampleswagger-initial from the GitHub repository <a href="https://github.com/LambdaSchool/java-sampleswagger.git">https://github.com/LambdaSchool/java-sampleswagger.git</a>. This application is similar to the application from <a href="https://github.com/LambdaSchool/java-sampleemps.git">https://github.com/LambdaSchool/java-sampleemps.git/sampleemps_data_modeling</a> with the addition of find employee by id endpoints and associated code. I also added the ErrorDetail and ValidationError classes to show how you can customize Swagger when you have full exception handling in place.</p>
<h3 id="start-with-the-defaults">Start with the defaults</h3>
<p>First, we need to add the dependencies and configuration for the default Swagger documentation.</p>
<p>Add the following Swagger Dependencies to the <code class="highlighter-rouge">pom.xml</code> file</p>
<pre><code class="language-XML">        &lt;!-- Swagger Dependencies Start --&gt;
        &lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-bean-validators&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- Swagger Dependencies End --&gt;
</code></pre>
<p>Yes, I did throw in an additional dependency. The <code class="highlighter-rouge">springfox-bean-validator</code> allows Swagger to recognize some of the validation annotations and document their messages as well!</p>
<p>Now we need to add the configuration file for Swagger. This is similar to the configuration file we added before. However, notice the addition of the annotation <code class="highlighter-rouge">@Import(BeanValidatorPluginsConfiguration.class)</code>. Again, this always Swagger to work with the validation annotations. Feel free to put in your own contact information! Remember in adding all of this code, you will need to make sure the proper imports are done!</p>
<pre><code class="language-JAVA">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;
import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;
import springfox.documentation.builders.ApiInfoBuilder;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.Contact;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

@Configuration
@EnableSwagger2
@Import(BeanValidatorPluginsConfiguration.class)
public class Swagger2Config
{
    @Bean
    public Docket api()
    {
        return new Docket(DocumentationType.SWAGGER_2)
            .select()
            .apis(RequestHandlerSelectors
                .basePackage("com.lambdaschool.sampleemps"))
            .paths(PathSelectors.regex("/.*"))
            .build()
            .apiInfo(apiEndPointsInfo());
    }

    private ApiInfo apiEndPointsInfo()
    {
        return new ApiInfoBuilder().title("Custom Swagger Documentation Example")
            .description("Custom Swagger Documentation Example")
            .contact(new Contact("John Mitchell",
                "http://www.lambdaschool.com",
                "<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="1b717473755b777a76797f7a68787374747735787476">[email&#160;protected]</a>"))
            .license("MIT")
            .licenseUrl("https://github.com/LambdaSchool/java-sampleswagger/blob/master/LICENSE")
            .version("1.0.0")
            .build();
    }
</code></pre>
<h3 id="document-the-models">Document the Models</h3>
<p>Now let’s add custom Swagger documentation to the Employee Model Let’s describe the model itself. Right before the class header, add the following annotation. Note that value is the name of the model or table and description tells us what is actually being modeled.</p>
<pre><code class="language-JAVA">@ApiModel(value = "Employee",
    description = "Yes an actual employee record")
// class header and following code
</code></pre>
<p>For any property in any entity that needs custom documentation, you use the <code class="highlighter-rouge">@ApiModelProperty</code> annotation. So, for each field in the Employee model, add the following annotation adjusting the information to fit the property. This annotation goes right before the field declaration. For example, this is the annotation for the primary key. Note that here description is called value and example always takes a String value.</p>
<pre><code class="language-JAVA">    @ApiModelProperty(name = "employee id",
        value = "primary key for employee",
        required = true,
        example = "1")
// field declaration
</code></pre>
<p>For another example, this is the annotation for the employee name:</p>
<pre><code class="language-JAVA">    @ApiModelProperty(name = "employee name",
        value = "full name of employee",
        required = true,
        example = "Best Employee")
// field declaration
</code></pre>
<p>A Documented Employee Model</p>
<pre><code class="language-JAVA">import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import io.swagger.annotations.ApiModel;
import io.swagger.annotations.ApiModelProperty;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToMany;
import javax.persistence.Table;
import javax.persistence.Transient;
import java.util.ArrayList;
import java.util.List;

@ApiModel(value = "Employee",
        description = "Yes an actual employee record")
@Entity
@Table(name = "employees")
@JsonIgnoreProperties(value = {"hasvalueforsalary"})
public class Employee extends Auditable
{
    @ApiModelProperty(name = "employee id",
            value = "primary key for employee",
            required = true,
            example = "1")
    @Id // The primary key
    @GeneratedValue(strategy = GenerationType.AUTO) // We will let the database decide how to generate it
    private long employeeid; // long so we can have many rows

    @ApiModelProperty(name = "employee name",
            value = "full name of employee",
            required = true,
            example = "Best Employee")
    @Column(nullable = false,
            unique = true)
    private String name;

    @Transient
    public boolean hasvalueforsalary = false;

    @ApiModelProperty(name = "employee name",
            value = "salary of employee",
            required = false,
            example = "100000")
    private double salary;

    /*
     * emp is the field from EmployeeTitles
     * CascadeType.ALL says that when we add, update, delete an Employee record, have that affect emp in EmployeeTitle.
     * Notice that in EmployeeTitle there is no cascade option. This way manipulating an Employee record only affects
     * the EmployeeTitle join table but does not affect the JobTitle table.
     */
    @OneToMany(mappedBy = "emp",
        cascade = CascadeType.ALL)
    /*
     * When displaying EmployeeTitles from the Employee class, do not display the employee again.
     * However do allow for data to be added to the emp field in EmployeeTitles
     */
    @JsonIgnoreProperties(value = "emp",
        allowSetters = true)
    /*
     * We know all of this works with EmployeeTitles because that is the class of the field name that making the One To Many relationship!
     * This array contains the list of EmployeeTitles assigned to this Employee
     */
    private List&lt;EmployeeTitles&gt; jobnames = new ArrayList&lt;&gt;();

    /*
     * This starts the One To Many relation of employee to emails
     */
    @OneToMany(mappedBy = "employee",
        cascade = CascadeType.ALL,
        // when adding, reading, updating, and delete, the operations should affect the emails table as well)
        orphanRemoval = true)
    // if we find a email that has a reference to an employee that does not exist, delete that email record
    @JsonIgnoreProperties(value = "employee",
        allowSetters = true)
    private List&lt;Email&gt; emails = new ArrayList&lt;&gt;();

    public Employee()
    {
        // the default constructor is required by the JPA
    }

    public Employee(
        String name,
        double salary,
        List&lt;EmployeeTitles&gt; jobnames)
    {
        this.name = name;
        this.salary = salary;

        /*
         * Force the list of roles to be associated with this new employee object!
         */
        for (EmployeeTitles et : jobnames)
        {
            et.setEmp(this);
        }
        this.jobnames = jobnames;
    }

    public long getEmployeeid()
    {
        return employeeid;
    }

    public void setEmployeeid(long employeeid)
    {
        this.employeeid = employeeid;
    }

    public String getName()
    {
        return name;
    }

    public void setName(String name)
    {
        this.name = name;
    }

    public double getSalary()
    {
        return salary;
    }

    public void setSalary(double salary)
    {
        hasvalueforsalary = true;
        this.salary = salary;
    }

    public List&lt;Email&gt; getEmails()
    {
        return emails;
    }

    public void setEmails(List&lt;Email&gt; emails)
    {
        this.emails = emails;
    }

    /*
     * We need a getter for the new One To Many relations
     */
    public List&lt;EmployeeTitles&gt; getJobnames()
    {
        return jobnames;
    }

    /*
     * We need a setter for the new One To Many relations
     */
    public void setJobnames(List&lt;EmployeeTitles&gt; jobnames)
    {
        this.jobnames = jobnames;
    }

    /*
     * Due to the new One To Many relation, we need a new way to add a Job Title to the employee
     */
    public void addJobTitle(
        JobTitle jobTitle,
        String manager)
    {
        jobnames.add(new EmployeeTitles(this,
            jobTitle,
            manager));
    }
}
</code></pre>
<h3 id="document-the-controllers">Document the controllers</h3>
<p>Now let’s add custom Swagger documentation to the EmployeeControl, first adding annotations to the list all employees endpoint. All we need for the list all employees endpoint is the <code class="highlighter-rouge">@ApiOperation</code> with a value, description, a response class, and a response container class. So add the following annotation before the listAllEmployees() method</p>
<pre><code class="language-JAVA">    @ApiOperation(value = "returns all Employees",
        response = Employee.class,
        responseContainer = "List")
    // method header
</code></pre>
<p>Now let’s look at one slightly more involved - return a single employee based off an employee id. Here we are adding</p>
<ul>
<li>
<code class="highlighter-rouge">ApiOperation</code> to explain what is happening and any response types.</li>
<li>
<code class="highlighter-rouge">@ApiResponses</code> to document how you are responding to exceptions. This only makes sense if you have full exception handling in place in your application. Otherwise I would leave this annotation out and just use the Swagger defaults for ApiResponses.</li>
<li>
<code class="highlighter-rouge">@ApiParam</code> is needed before each parameter in the method header! Here we just have one Parameter, the employee id we are seeking. Even if the parameter is coming in through the request body, we still annotation the parameter.</li>
</ul>
<p>Add the following annotations to your employee controller for the method getEmployeeById.</p>
<pre><code class="language-JAVA">    @ApiOperation(value = "Retrieve an employee based off of employee id",
        response = Employee.class)
    @ApiResponses(value = {@ApiResponse(code = 200,
        message = "Employee Found",
        response = Employee.class), @ApiResponse(code = 404,
        message = "Employee Not Found",
        response = ErrorDetail.class)})
    // method header
    //...
        @ApiParam(value = "Employee id",
            required = true,
            example = "4")
    // @PathVariable and following
</code></pre>
<p>And let’s do one more. Let’s document the PUT employee endpoint. What is different about this endpoint is that nothing is returned in the response body, so we say the response is <code class="highlighter-rouge">Void.class</code> Add the following annotation to your code to document the PUT endpoint.</p>
<pre><code class="language-JAVA">    @ApiOperation(value = "updates an employee given in the request body",
        response = Void.class)
    @ApiResponses(value = {@ApiResponse(code = 200,
        message = "Employee Found",
        response = Void.class), @ApiResponse(code = 404,
        message = "Employeer Not Found",
        response = ErrorDetail.class)})
    // method headers
            @ApiParam(value = "a full employee object",
            required = true)
    //...
        @ApiParam(value = "employeeid",
            required = true,
            example = "4")
    //...
</code></pre>
<p>The Employee Controller with Annotations in Place</p>
<pre><code class="language-JAVA">import com.lambdaschool.sampleemps.models.Employee;
import com.lambdaschool.sampleemps.models.ErrorDetail;
import com.lambdaschool.sampleemps.services.EmployeeService;
import com.lambdaschool.sampleemps.views.EmpNameCountJobs;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;
import io.swagger.annotations.ApiResponse;
import io.swagger.annotations.ApiResponses;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.support.ServletUriComponentsBuilder;

import javax.validation.Valid;
import java.net.URI;
import java.util.List;

@RestController
@RequestMapping("/employees") // optional
public class EmployeeController
{
    @Autowired
    private EmployeeService employeeService;

    @ApiOperation(value = "returns all Employees",
            response = Employee.class,
            responseContainer = "List")
    @GetMapping(value = "/employees")
    public ResponseEntity&lt;?&gt; listAllEmployees()
    {
        List&lt;Employee&gt; myEmployees = employeeService.findAllEmployees();
        return new ResponseEntity&lt;&gt;(myEmployees,
            HttpStatus.OK);
    }

    @ApiOperation(value = "Retrieve an employee based off of employee id",
            response = Employee.class)
    @ApiResponses(value = {@ApiResponse(code = 200,
            message = "Employee Found",
            response = Employee.class), @ApiResponse(code = 404,
            message = "Employee Not Found",
            response = ErrorDetail.class)})
    @GetMapping(value = "/employee/{employeeid}")
    public ResponseEntity&lt;?&gt; getEmployeeById(
            @ApiParam(value = "Employee id",
                    required = true,
                    example = "4")
            @PathVariable
                    long employeeid)
    {
        Employee e = employeeService.findEmployeeById(employeeid);
        return new ResponseEntity&lt;&gt;(e, HttpStatus.OK);
    }

    @GetMapping(value = "/employeename/{subname}")
    public ResponseEntity&lt;?&gt; listEmployeesWithName(
        @PathVariable
            String subname)
    {
        List&lt;Employee&gt; myEmployees = employeeService.findEmployeeNameContaining(subname);
        return new ResponseEntity&lt;&gt;(myEmployees,
            HttpStatus.OK);
    }

    @GetMapping(value = "/employeeemail/{subemail}")
    public ResponseEntity&lt;?&gt; listEmployeesWithEmail(
        @PathVariable
            String subemail)
    {
        List&lt;Employee&gt; myEmployees = employeeService.findEmployeeEmailContaining(subemail);
        return new ResponseEntity&lt;&gt;(myEmployees,
            HttpStatus.OK);
    }

    @PostMapping(value = "/employee",
        consumes = {"application/json"})
    public ResponseEntity&lt;?&gt; addNewEmployee(
        @Valid
        @RequestBody
            Employee newEmployee)
    {
        // ids are not recognized by the Post method
        newEmployee.setEmployeeid(0);
        newEmployee = employeeService.save(newEmployee);

        // set the location header for the newly created resource
        HttpHeaders responseHeaders = new HttpHeaders();
        URI newEmployeeURI = ServletUriComponentsBuilder.fromCurrentRequest()
            .path("/{employeeid}")
            .buildAndExpand(newEmployee.getEmployeeid())
            .toUri();
        responseHeaders.setLocation(newEmployeeURI);

        return new ResponseEntity&lt;&gt;(null,
            responseHeaders,
            HttpStatus.CREATED);
    }

    @ApiOperation(value = "updates an employee given in the request body",
            response = Void.class)
    @ApiResponses(value = {@ApiResponse(code = 200,
            message = "Employee Found",
            response = Void.class), @ApiResponse(code = 404,
            message = "Employeer Not Found",
            response = ErrorDetail.class)})
    @PutMapping(value = "/employee/{employeeid}",
        consumes = {"application/json"})
    public ResponseEntity&lt;?&gt; updateFullEmployee(
        @ApiParam(value = "a full employee object",
                required = true)
        @Valid
        @RequestBody
            Employee updateEmployee,
        @ApiParam(value = "employeeid",
                required = true,
                example = "4")
        @PathVariable
            long employeeid)
    {
        updateEmployee.setEmployeeid(employeeid);
        employeeService.save(updateEmployee);

        return new ResponseEntity&lt;&gt;(HttpStatus.OK);
    }

    @PatchMapping(value = "/employee/{employeeid}",
        consumes = {"application/json"})
    public ResponseEntity&lt;?&gt; updateEmployee(
        @RequestBody
            Employee updateEmployee,
        @PathVariable
            long employeeid)
    {
        employeeService.update(updateEmployee,
            employeeid);
        return new ResponseEntity&lt;&gt;(HttpStatus.OK);
    }

    @DeleteMapping(value = "/employee/{employeeid}")
    public ResponseEntity&lt;?&gt; deleteEmployeeById(
        @PathVariable
            long employeeid)
    {
        employeeService.delete(employeeid);
        return new ResponseEntity&lt;&gt;(HttpStatus.OK);
    }

    @GetMapping(value = "/job/counts")
    public ResponseEntity&lt;?&gt; getEmpJobCounts()
    {
        List&lt;EmpNameCountJobs&gt; myEmployees = employeeService.getEmpNameCountJobs();
        return new ResponseEntity&lt;&gt;(myEmployees,
            HttpStatus.OK);
    }

    @DeleteMapping(value = "/employee/{employeeid}/jobtitle/{jobtitleid}")
    public ResponseEntity&lt;?&gt; deleteEmployeeJobTitlesByid(
        @PathVariable
            long employeeid,
        @PathVariable
            long jobtitleid)
    {
        employeeService.deleteEmpJobTitle(employeeid,
        jobtitleid);

        return new ResponseEntity&lt;&gt;(HttpStatus.OK);
    }

    @PostMapping(value = "/employee/{employeeid}/jobtitle/{jobtitleid}/manager/{manager}")
    public ResponseEntity&lt;?&gt; addEmployeeJobTitlesByid(
        @PathVariable
            long employeeid,
        @PathVariable
            long jobtitleid,
        @PathVariable
            String manager)
    {
        employeeService.addEmpJobTitle(employeeid,
            jobtitleid, manager);

        return new ResponseEntity&lt;&gt;(HttpStatus.OK);
    }
}
</code></pre>
<h3 id="examine-our-work">Examine our work</h3>
<p>Run the application and surf to the site <a href="http://localhost:2019/swagger-ui.html">http://localhost:2019/swagger-ui.html</a>.</p>
<ul>
<li>Expand the information for the Employee Controller and notice your custom documentation is now being used!</li>
<li>Expand the information for the Employee Model and notice that custom documentation is now being used!</li>
</ul>
<h5>Challenge</h5>
<p>Your task is to add custom Swagger documentation to the <code class="highlighter-rouge">JobTitle</code> Model and to the rest of the end points in the <code class="highlighter-rouge">EmployeeController</code></p>
<h5>Dig Deeper</h5>
<ul>
<li>
<a href="https://swagger.io/" target="blank_">Swagger Homepage</a><br> Swagger Homepage</li>
<li>
<a href="https://springframework.guru/spring-boot-restful-api-documentation-with-swagger-2/" target="blank_">Swagger Complete Example</a><br> Swagger and Spring Boot Complete Example</li>
</ul>
<hr>
<h2>
<a id="guided-project" class="anchor" href="#guided-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Guided Project</h2>
<h3>java-exceptionalusermodel</h3>
<p>We are adding client friendly exception handling.</p>
<a target="_blank" href="https://github.com/LambdaSchool/java-exceptionalusermodel.git">GitHub Repo</a>
<hr>
<h2 class="display-4">
<a id="project" class="anchor" href="#project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Project</h2>
<ul class="list-group">
<li class="list-group-item">
<h5><a target="_blank" href="https://github.com/lambdaSchool/java-school.git">Java-School</a></h5>
</li>
</ul>
<h2 class="display-4">
<a id="review" class="anchor" href="#review" aria-hidden="true"><span class="octicon octicon-link"></span></a>Review</h2>
<h3 class="display-5">Class Recordings</h3>
<p class="lead">You can use class recordings to help you master the material.</p>
<div>
<ul class="list-group list-group-flush">
<li class="list-group-item">
 <strong><a target="_blank" href="https://youtu.be/aWL-u5TMM-Y">Java Exception Handling for WEB33 with John Mitchell</a></strong>
</li>
<li class="list-group-item">
<a href="/archive/WEB4Java/module/rec3E1WYDyoiEF1e3">All previous recordings</a>
</li>
</ul>
</div>
<h3 class="display-5">Demonstrate Mastery</h3>
<p>To demonstrate mastery of this module, you need to complete and pass a code review on each of the following:</p>
<ul>
<li>Objective challenge: <p>Following the same process you used to create a <code class="highlighter-rouge">ResourceNotFoundException</code>, create a <code class="highlighter-rouge">ResourceFoundException</code> to be used in place of the built-in exception <code class="highlighter-rouge">EntityExistsException</code>.</p>
</li>
<li>Objective challenge: <p>Add an annotation to validate the email field in the Email model. Note that since the word email is already in use in the method, IntelliJ adds the full address of the annotation to give you something like <code class="highlighter-rouge">@javax.validation.constraints.Email</code>. It happens when these common words are used. We have to know which one to use at what time!</p>
</li>
<li>Objective challenge: <p>Your task is to add custom Swagger documentation to the <code class="highlighter-rouge">JobTitle</code> Model and to the rest of the end points in the <code class="highlighter-rouge">EmployeeController</code></p>
</li>
<li>Guided Project: java-exceptionalusermodel</li>
<li>Project: Java-School</li>
</ul>
</div>
</div>
</div>
</main>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-80850900-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-80850900-4');
</script>
<script type="text/javascript">
  function getDomain() {
    const domainName = window.location.hostname.split('.')[1];
    return `${domainName}.com`;
  }
</script>
<script src="" integrity="" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
<script src="/assets/js/vendor/popper.min.js" integrity="" crossorigin="anonymous"></script><script src="/dist/js/bootstrap.min.js" integrity="" crossorigin="anonymous"></script><script src="/assets/js/activate.js"></script>
<script src="/assets/js/jekyll-search.js" type="text/javascript"></script>
<script type="text/javascript">
  SimpleJekyllSearch.init({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    dataSource: '/search.json',
    searchResultTemplate: '<li class="list-group-item"><a href="{url}" title="Java - Exception Handling">{title}</a></li>',
    noResultsText: '',
    limit: 10,
    fuzzy: true,
  })
</script>
<script src="/assets/js/mermaid.min.js"></script><script type="text/javascript">
  if (window.attachEvent) {
    window.attachEvent('onload', verifySignedIn);
  } else {
    if (window.onload) {
      var currentOnLoadFn = window.onload;
      var newOnLoadFn = function (evt) {
        currentOnLoadFn(evt);
        verifySignedIn();
      };
      window.onload = newOnLoadFn;
    } else {
      window.onload = verifySignedIn;
    }
  }

  function verifySignedIn() {
    if (isPagePublic()) {
      return showPageContents();
    }

    window.__user = null;
    isSignedIn().then((user) => {
      window.__user = user;

      if (!user.signedIn) {
        redirectToSignIn();
      } else if (!user.student && !window.__openToAdmissions) {
        showUnauthorizedMessage();
      } else {
        showPageContents();
      }
    });
  }

  function isPagePublic() {
    const openCourses = [
      'and-pre',
      'ds-pre',
      'fsw-pre',
      'help',
      'ios-pre',
    ];

    const openPages = [
      'cs-and',
      'cs-fsw',
      'cs-ios',
      'cr',
      'ds',
      'jx',
      'p4s',
      'ux',
    ];

    const pathParts = window.location.pathname.split('/');
    const courseName = pathParts[1];
    const pageName = pathParts[pathParts.length - 1];

    return openCourses.includes(courseName) || openPages.includes(pageName);
  }

  function isSignedIn() {
    const isDeployPreview = window.location.hostname.startsWith('deploy-preview') && window.location.hostname.endsWith('netlify.com');

    if (isDeployPreview) return Promise.resolve({ signedIn: true, student: true });

    return fetch(`${getAuthBaseUrl()}/whoami`, { credentials: 'include' })
      .then((response) => response.text())
      .then((userAsText) => userAsText ? JSON.parse(userAsText) : null)
      .then((userData) => ({ signedIn: Boolean(userData), student: Boolean(userData && userData.airtableId), id: userData ? userData.id : null, email: userData ? userData.email : null }))
      .catch((error) => {});
  }

  function redirectToSignIn() {
    const signInUrl = `${getAuthBaseUrl()}/sign-in?redirect=${encodeURIComponent(window.location.href)}&reason=auth_required`
    const redirectMessage = document.querySelector('#redirect-message');
    redirectMessage.style.display = "block";
    redirectMessage.innerHTML = `<div>You are being redirected to the sign in page. If you aren't redirected automatically, you can use <a href=${signInUrl}>this link</a>.</div>`
    window.location = signInUrl;
  }

  function showPageContents() {
    document.querySelector('#content-wrapper').style.visibility = 'visible';
  }

  function showUnauthorizedMessage() {
    document.querySelector('#unauthorized-message').style.display = 'block';
  }

  function getAuthBaseUrl() {
    const domain = getDomain();
    const authBaseUrl = `https://auth.${domain}`;
    return authBaseUrl;
  }
</script><script src="/assets/js/docs.min.js"></script><script>
  var MathJax = {
    tex: {
      inlineMath: [['$$', '$$'], ['\[', '\])']]
    },
    "HTML-CSS": {
      styles: {
        ".MathJax span": {
          color: "#000000"
        }
      }
    }
  }
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script>
  handleExternalLinks();

  function handleExternalLinks() {
    const domain = getDomain();
    const links = document.querySelectorAll('a');
    return links.forEach((link) => {
      if (!link.host.includes(domain)) link.target = '_blank';
    })
  };
</script>
</div>
</body>
</html>
